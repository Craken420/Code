;**** Modificacion :28-Sept-09 Se modifico: Se agregaron validaciones a las devoluciones de venta por UEN. ALQG
;**** Modificacion :25-Sept-09 Se modifico: Se agrego la validacion para las facturas de VIU para que no se emitan movimientos con articulos que no corresponden. ALQG
;**** Modificacion Anterior:18-Sept-08
;**** Modifico: Leticia Quezada
;**** Se modifico:Se habilito los comentarios para que Ventas ponga informacion en el Analisis de Credito
;**** Modificacion Reciente:02-Ene-09
;**** Modifico: Edgar Montelongo
;**** Se modifico:Se habilito validación para bloquear Detalle en Analisis Credito, Factura, Credilana, Seguro Auto, Seguro Vida, Analisis Mayoreo, Pedido Mayoreo y Factura Mayoreo
; ***** Modifico: Judith Ramirez 04-Dic-09. *****
; ***** Modificacion: Cambio en accion CteExpress para cte express. Cambio por Arturo Guizer. ****
; ***** Modificacion: Belem Vazquez 17022010 Agrego campo FacDesgloseIva para la Facturacion Electronica****

;**** Modificacion Mexico ******
[Venta.frm/(Carpeta Abrir)]
FiltroAutoCampo=Venta.Moneda
FiltroAutoValidar=Venta.Moneda
; ***** Se quitaron de la lista en captura los campos: CteEnviarA.Nombre, CteEnviarA.Direccion ****
; ***** Se agreagaron los campos: CteEnviarA.Cadena, Afectar ComisionMAVI ****
[Venta.frm/Ficha]
FichaEspacioEntreLineas=6
FichaEspacioNombres=100
FichaEspacioNombresAuto=S
FichaNombres=Izquierda
FichaAlineacion=Izquierda
FichaAlineacionDerecha=S
ListaEnCaptura=Venta.Mov<BR>Venta.MovID<BR>Venta.Proyecto<BR>Venta.UEN<BR>Venta.Moneda<BR>Venta.TipoCambio<BR>Venta.AfectaComisionMavi<BR>Venta.ServicioContratoTipo<BR>Venta.FechaEmision<BR>Venta.FechaRequerida<BR>Venta.HoraRequerida<BR>Venta.FechaOriginal<BR>Venta.Retencion<BR>Venta.Cliente<BR>Cte.Nombre<BR>Cte.RFC<BR>Venta.ListaPreciosEsp<BR>Venta.EnviarA<BR>CteEnviarA.Clave<BR>CteEnviarA.Cadena<BR>Venta.FormaEnvio<BR>Venta.Agente<BR>Venta.Almacen<BR>Venta.AlmacenDestino<BR>Venta.ReferenciaOrdenCompra<BR>Venta.Concepto<BR>Venta.Condicion<BR>Venta.Vencimiento<BR>Venta.FormaPagoTipo<BR>Venta.Descuento<BR>Venta.DescuentoGlobal<BR>Venta.Referencia<BR>Venta.OrdenCompra<BR>Venta.Directo<BR>Venta.FormaCobro<BR>Venta.NoCtaPago<BR>Venta.RedimePtos

[Venta.frm/Ficha.Venta.FormaCobro]
Carpeta=Ficha
Clave=Venta.FormaCobro
Editar=S
LineaNueva=S
ValidaNombre=S
3D=S
Tamano=17
ColorFondo=Blanco
ColorFuente=Negro

[Venta.frm/Ficha.Venta.NoCtaPago]
Carpeta=Ficha
Clave=Venta.NoCtaPago
Editar=S
ValidaNombre=S
3D=S
Tamano=25
ColorFondo=Blanco
ColorFuente=Negro

[Venta.frm/Ficha.Venta.Condicion]
Tamano=35



;****Nuevo campo agregadó ****
[Venta.frm/Ficha.CteEnviarA.Cadena]
Carpeta=Ficha
Clave=CteEnviarA.Cadena
LineaNueva=N
ValidaNombre=N
3D=S
Tamano=35
ColorFondo=Plata
ColorFuente=Negro
Editar=S
Pegado=S
;**** Se modificó el parametro:Pegado ****
[Venta.frm/Ficha.CteEnviarA.Clave]
Pegado=N
Tamano=16

; **** Nuevo campo para Monedero Electronico. JR 11-Oct-2012. ****
[Venta.frm/Ficha.Venta.RedimePtos]
Carpeta=Ficha
Clave=Venta.RedimePtos
Editar=S
ValidaNombre=S
3D=S
ColorFondo=Blanco
ColorFuente=Negro

[Venta.frm/Ficha.Venta.ReferenciaOrdenCompra]
Carpeta=Ficha
Clave=Venta.ReferenciaOrdenCompra
Editar=S
LineaNueva=S
ValidaNombre=S
3D=S
Tamano=25
ColorFondo=Blanco
ColorFuente=Negro




;**** Ficha Comentarios ****
;**** Se modifico el parametro "FichaNombres" para que los nombres de los campos aparecieran arriba del campo ****
[venta.frm/Comentarios]
FichaNombres=Arriba
ListaEnCaptura=Venta.Comentarios<BR>Venta.Atencion
;**** Se modifico el campo para que no desplegara el nombre, asi como su dimension ****
;*** Se modifico para que Ventas ponga informacion en comentarios en el Analisis de Credito ***
[Venta.frm/Comentarios.Venta.Comentarios]
ValidaNombre=N
Tamano=110
EditarConBloqueo=S

;**** Se modifico el campo para que apareciera en la ficha comentarios ****
;**** Se modifico el campo para que no fuera editable GRB 18-Feb-2010
[Venta.frm/Comentarios.Venta.Atencion]
Carpeta=Comentarios
Clave=Venta.Atencion
Editar=N
LineaNueva=S
ValidaNombre=S
3D=S
Tamano=50
ColorFondo=Blanco
ColorFuente=Negro
;EditarConBloqueo=S
;**** Ficha "NOTAS"
;**** Se modificaron los campos en captura ****
[Venta.frm/Notas]
ListaEnCaptura=Venta.Observaciones<BR>Venta.ZonaImpuesto<BR>Venta.Prioridad<BR>Venta.AgenteServicio<BR>Venta.Causa<BR>Venta.ServicioTipo<BR>Venta.FechaOriginal<BR>Venta.SucursalVenta<BR>Venta.AF<BR>Venta.AFArticulo<BR>Venta.AFSerie<BR>Venta.OrigenSucursal<BR>Venta.FacDesgloseIVA
;**** Se modifico el campo para que saltara de linea ****
[Venta.frm/Notas.Venta.AgenteServicio]
LineaNueva=S

[Venta.frm/Notas.Venta.AF]
LineaNueva=S


[Venta.frm/Comentarios.Venta.Atencion]
Carpeta=Comentarios
Clave=Venta.Atencion
Editar=S
LineaNueva=S
ValidaNombre=S
3D=S
Tamano=50
ColorFondo=Blanco
ColorFuente=Negro
EditarConBloqueo=S

[Venta.frm/Notas.Venta.OrigenSucursal]
Carpeta=Notas
Clave=Venta.OrigenSucursal
Editar=N
ValidaNombre=S
3D=S
ColorFondo=Blanco
ColorFuente=Negro

;**** MOISES PODER MODIFICAR AUNQUE EL ESTATUS NO LO PERMITA MOISES MAVI 15/JUNIO/2009
[Venta.frm/Notas.Venta.SucursalVenta]
EditarConBloqueo=S

;*** Se agrego campo para Facturacion Electronica BVF 17022010
[Venta.frm/Notas.Venta.FacDesgloseIVA]
Carpeta=Notas
Clave=Venta.FacDesgloseIVA
Editar=S
LineaNueva=S
ValidaNombre=S
3D=S
Tamano=50
ColorFondo=Blanco
ColorFuente=Negro


;**** Ficha: Detalle ******
;**** Se agrego un nuevo campo en la listaCamposAValidar: PropreListaDFinal.Lista**** 26-Ago-08
;****Nuevo campo agregado: VentaD.Financiamiento, VentaD.MovDevMAVI ******
;****Nueva accion agregada en el detalle: UsuarioDescuento *****
;**** Se agregaron los Movimientos de Factura VIU y Prestamo Personal en la condicion de edicion  ALQG 23/Marzo/2010****
;***** Integracion de accion Actualizar Precio mod por Jesus Del Toro Andrade 04-Oct-2011 para desarrollo DM0148 Actualizar Precios para Ventas Instituciones dentro del paquete DM0148_04102011. JR 04-Oct-2011 *****
[Venta.frm/Detalle]
ListaEnCaptura=VentaD.Aplica<BR>VentaD.AplicaID<BR>AplicaNombre<BR>VentaD.Codigo<BR>VentaD.Articulo<BR>VentaD.SubCuenta<BR>ClaveIdioma<BR>VentaD.SustitutoArticulo<BR>VentaD.SustitutoSubCuenta<BR>VentaD.Cantidad<BR>CantidadNeta<BR>VentaD.Unidad<BR>VentaD.CantidadInventario<BR>CantidadInvNeta<BR>Art.Horas<BR>VentaD.Espacio<BR>VentaD.Precio<BR>VentaD.Financiamiento<BR>VentaD.DescuentoImporte<BR>VentaD.PrecioMoneda<BR>VentaD.PrecioTipoCambio<BR>VentaD.FechaRequerida<BR>VentaD.HoraRequerida<BR>VentaD.Instruccion<BR>VentaD.ExcluirPlaneacion<BR>Importe<BR>VentaD.PresupuestoEsp<BR>VentaD.ExcluirISAN<BR>SubImpuesto2<BR>SubImpuesto1<BR>SubImpuesto3<BR>VentaD.EnviarA<BR>VentaD.Almacen<BR>VentaD.Posicion<BR>VentaD.ContUso<BR>VentaD.Agente<BR>VentaD.AgentesAsignados<BR>VentaD.ProveedorRef<BR><CONTINUA>
ListaEnCaptura002=<CONTINUA>VentaD.AFArticulo<BR>VentaD.AFSerie<BR>VentaD.Costo<BR>CostoTotal<BR>VentaD.Paquete<BR>VentaD.AutoLocalidad<BR>VentaD.UEN<BR>VentaD.DescripcionExtra<BR>VentaD.CantidadReservada<BR>VentaD.CantidadOrdenada<BR>VentaD.CantidadPendiente<BR>VentaD.ServicioNumero<BR>VentaD.Estado<BR>VentaD.CantidadA<BR>VentaD.TransferirA<BR>MovDevMAVI
ListaCamposAValidar=DescripcionIdioma<BR>OpcionDesc<BR>Art.Unidad<BR>Art.Tipo<BR>Art.PrecioLista<BR>Art.PrecioMinimo<BR>PropreListaDFinal.Lista
;ListaAcciones=CopiarPendiente<BR>Observaciones<BR>VerPoliticaDetalle<BR>DesglosarCantidadOrdenada<BR>VerOpciones<BR>AutoBoleto<BR>ExcluirISAN<BR>UsuarioDescuento<BR>UsuarioIncremento
;ListaAcciones=CopiarPendiente<BR>Observaciones<BR>VerPoliticaDetalle<BR>DesglosarCantidadOrdenada<BR>VerOpciones<BR>AutoBoleto<BR>ExcluirISAN<BR>UsuarioDescuento<BR>UsuarioIncremento<BR>Actualizar Precio
ListaAcciones=CopiarPendiente<BR>Observaciones<BR>VerPoliticaDetalle<BR>DesglosarCantidadOrdenada<BR>VerOpciones<BR>AutoBoleto<BR>ExcluirISAN<BR>UsuarioDescuento<BR>UsuarioIncremento<BR>Actualizar Precio<BR>ActualizaPrecio empleado<BR>escaneo


;CondicionEdicion=  ((ConDatos(Venta:Venta.Mov) y ConDatos(Venta:Venta.FechaRequerida) y ConDatos(Venta:Venta.Cliente) y ConDatos(Venta:Venta.EnviarA) y ConDatos(Venta:Venta.FormaPagoTipo) y ConDatos(Venta:Venta.Agente) y ConDatos(Venta:Venta.Almacen) y ConDatos(Venta:Venta.Condicion) y (Venta:Venta.Estatus=<T>SINAFECTAR<T>)))

;**** Se agrega condicion de edicion  02-Ene-09
;**** Se agregan las solicitudes devolucion para no editar el precio en detalle 16032011 BVF
;CondicionEdicion=(Venta:Venta.Mov Noen (<T>Sol Dev Mayoreo<T>,<T>Analisis Credito<T>,<T>Factura<T>,<T>Credilana<T>,<T>Seguro Vida<T>,<T>Seguro Auto<T>,<T>Factura VIU<T>,<T>Prestamo Personal<T>,<T>Analisis Mayoreo<T>,<T>Pedido Mayoreo<T>,<T>Factura Mayoreo<T>)) y (Venta:Venta.Estatus en (EstatusSinAfectar)) y (SQL(<T>SELECT dbo.fnEsPedidoMAVI(:tMov, :tOrigen, :tOrigenID)<T>, Venta:Venta.Mov, Venta:Venta.Origen, Venta:Venta.OrigenID)=1) y ((ConDatos(Venta:Venta.Mov) y ConDatos(Venta:Venta.FechaRequerida) y ConDatos(Venta:Venta.Cliente) y ConDatos(Venta:Venta.EnviarA) y ConDatos(Venta:Venta.FormaPagoTipo) y ConDatos(Venta:Venta.Agente) y ConDatos(Venta:Venta.Almacen) y ConDatos(Venta:Venta.Condicion) y (Venta:Venta.Estatus=<T>SINAFECTAR<T>)))

;Se condiciona para no ser editable almenos que sean de contabilidad , odcampos, 19-04-2012,Paquete RM0182_19042012 Integra BVF 
;CondicionEdicion=SI<BR>   SQL(<T>SELECT COUNT(Nombre) FROM VerMovTiempo V<BR>          INNER JOIN TablaStD T ON T.Nombre=V.Situacion<BR>        WHERE TablaSt=<T>+Comillas(<T>ACCESO ELIMINACION PARA ADJ.<T>)+<T><BR>            AND T.Nombre=<T>+Comillas(<T>Envia Adj a contabilidad<T>)+<T><BR>            AND v.Modulo=:tMod<BR>            AND v.ID=:nID<T>,Venta:Venta.SubModulo,Venta:Venta.ID)>0<BR>   y (Venta:Venta.Mov = <T>Sol Dev Unicaja<T>)<BR>ENTONCES<BR>     SQL(<T>SELECT DISTINCT GrupoTrabajo FROM dbo.Usuario WHERE Usuario =:tUsu<T>,Usuario) = <T>CONTABILIDAD<T>)<BR>SINO<BR>    1=1<BR>FIN
; ***** Cambio de CondicionEdicion para desarrollo DM0182 DESHABILITAR BOTON DE ELIMINAR EN ESTATUS SIN AFECTAR dentro del paquete DM0182_06062012, J Del TA 06-06-2012. JR 06-Jun-2012. ****
;CondicionEdicion=SI SQL(<T>SELECT COUNT(Nombre) FROM VerMovTiempo V<BR>        INNER JOIN TablaStD T ON T.Nombre=V.Situacion<BR>        WHERE TablaSt=<T>+Comillas(<T>ACCESO ELIMINACION PARA ADJ.<T>)+<T><BR>              AND T.Nombre=<T>+Comillas(<T>Envia Adj a contabilidad<T>)+<T><BR>              AND v.Modulo=:tMod<BR>              AND v.ID=:nID<T>,Venta:Venta.SubModulo,Venta:Venta.ID)>0<BR>    y (Venta:Venta.Mov = <T>Sol Dev Unicaja<T>)<BR>ENTONCES<BR>    SQL(<T>SELECT DISTINCT GrupoTrabajo FROM dbo.Usuario WHERE Usuario =:tUsu<T>,Usuario) = <T>CONTABILIDAD<T>)<BR>SINO<BR>    (Venta:Venta.Mov Noen (<T>Sol Dev Mayoreo<T>,<T>Analisis Credito<T>,<T>Factura<T>,<T>Credilana<T>,<T>Seguro Vida<T>,<T>Seguro Auto<T>,<T>Factura VIU<T>,<T>Prestamo Personal<T>,<T>Analisis Mayoreo<T>,<T>Pedido Mayoreo<T>,<T>Factura M<CONTINUA>
;CondicionEdicion002=<CONTINUA>ayoreo<T>)) y (Venta:Venta.Estatus en (EstatusSinAfectar)) y (SQL(<T>SELECT dbo.fnEsPedidoMAVI(:tMov, :tOrigen, :tOrigenID)<T>, Venta:Venta.Mov, Venta:Venta.Origen, Venta:Venta.OrigenID)=1) y ((ConDatos(Venta:Venta.Mov) y ConDatos(Venta:Venta.FechaRequerida) y ConDatos(Venta:Venta.Cliente) y ConDatos(Venta:Venta.EnviarA) y ConDatos(Venta:Venta.FormaPagoTipo) y ConDatos(Venta:Venta.Agente) y ConDatos(Venta:Venta.Almacen) y ConDatos(Venta:Venta.Condicion) y (Venta:Venta.Estatus=<T>SINAFECTAR<T>)))<BR>FIN
;Se agrega a validacion el movimiento Solicitud Devolucion, Jesus Del Toro, 01-08-2014
CondicionEdicion=SI SQL(<T>SELECT COUNT(Nombre) FROM VerMovTiempo V<BR>        INNER JOIN TablaStD T ON T.Nombre=V.Situacion<BR>        WHERE TablaSt=<T>+Comillas(<T>ACCESO ELIMINACION PARA ADJ.<T>)+<T><BR>              AND T.Nombre=<T>+Comillas(<T>Envia Adj a contabilidad<T>)+<T><BR>              AND v.Modulo=:tMod<BR>              AND v.ID=:nID<T>,Venta:Venta.SubModulo,Venta:Venta.ID)>0<BR>    y (Venta:Venta.Mov = <T>Sol Dev Unicaja<T>)<BR>ENTONCES<BR>    SQL(<T>SELECT DISTINCT GrupoTrabajo FROM dbo.Usuario WHERE Usuario =:tUsu<T>,Usuario) = <T>CONTABILIDAD<T>)<BR>SINO<BR>    (Venta:Venta.Mov Noen (<T>Sol Dev Mayoreo<T>,<T>Solicitud Devolucion<T>,<T>Analisis Credito<T>,<T>Analisis Mayoreo<T>))<BR>    y (MovTipo(<T>VTAS<T>,Venta:Venta.Mov) NoEn (<T>VTAS.D<T>,<T>VTAS.F<T>))<BR>    y (V<CONTINUA>
CondicionEdicion002=<CONTINUA>enta:Venta.Estatus en (EstatusSinAfectar))<BR>    y (SQL(<T>SELECT dbo.fnEsPedidoMAVI(:tMov, :tOrigen, :tOrigenID)<T>, Venta:Venta.Mov, Venta:Venta.Origen, Venta:Venta.OrigenID)=1)<BR>    y ((ConDatos(Venta:Venta.Mov) y ConDatos(Venta:Venta.FechaRequerida) y ConDatos(Venta:Venta.Cliente) y ConDatos(Venta:Venta.EnviarA)<BR>    y ConDatos(Venta:Venta.FormaPagoTipo) y ConDatos(Venta:Venta.Agente) y ConDatos(Venta:Venta.Almacen) y ConDatos(Venta:Venta.Condicion)<BR>    y (Venta:Venta.Estatus=<T>SINAFECTAR<T>)))<BR>FIN


;**** Se agrego la columna PropreListaID 26-Ago-08(Arly)*****
[Venta.frm/Detalle.Columnas]
PropreListaID=64

;***** Nuevo campo agregado ****
[Venta.frm/Detalle.VentaD.Financiamiento]
Carpeta=Detalle
Clave=VentaD.Financiamiento
LineaNueva=S
ValidaNombre=S
3D=S
ColorFondo=Blanco
ColorFuente=Negro

;**** Se agrego el campo calculado de VentaD MovDevMAVI 13-Nov-08(Arly)*****
[Venta.frm/Detalle.MovDevMAVI]
Carpeta=Detalle
Clave=MovDevMAVI
LineaNueva=S
ValidaNombre=S
3D=S
Tamano=41
ColorFondo=Blanco
ColorFuente=Negro


;***** Se modifico para que no fuera editable (17-Sep-08)*****
[Venta.frm/Detalle.VentaD.Precio]
EditarConBloqueo=S


[Venta.frm/Ficha.Venta.AfectaComisionMavi]
Carpeta=Ficha
Clave=Venta.AfectaComisionMavi
Editar=S
ValidaNombre=S
3D=S
ColorFondo=Blanco
ColorFuente=Negro
Tamano=6


;************************************ACCIONES********************************************
;****************************************************************************************
;****************************************************************************************

;***** CQ 10/03/2012 Carmen Quintana Modificación de la condición antes del Cerrar la Forma. Integro BVF23032012
;**** Se agregaron nuevas acciones: MontoAbono_MAVI, ValesMAVI, ValesMAVILista, IngresosGenerados ****
;**** Se modificaron las expresiones al Cerrar paquete Servicasa / Servicred BVF 11/03/2011
;***** 09/05/2012 Carmen Quintana Se agregó la ejecución de un SP antes de cerrar la forma, integro BVF10052012 DM0112_10052012
;**** Modificacion a expresionesalcerrar y expresionesalmostrar para dentro del paquete DM0116_18072012.JR 18-Jul-2012.****
;**** nueva accion LiberarMonedero para Monedero Electronico. JR 11-Oct-2012. ****
[Venta.frm/Forma]
PosicionInicialAltura=579
PosicionInicialAncho=1000
Icono=67
PosicionInicialIzquierda=220
PosicionInicialArriba=67
PosicionSec1=268
;***** Se agrega accion al mostrar (se inicializa variable Info.Conteo)
;ExpresionesAlMostrar=Asigna(Info.Copiar, Falso)    <BR>Asigna(Info.Positivos, Verdadero)<BR>Asigna(Info.Paquete, Nulo)<BR>Asigna(Info.RefrescandoPrecio, Falso)<BR>Asigna(Info.Cliente, Nulo)<BR>Asigna(Info.Mensaje,nulo)<BR>Asigna(Filtro.Cliente, Nulo)<BR>Asigna(Info.Conteo, 0)<BR>Asigna(Mavi.ServicasaCapDetallVentas,0)
;ExpresionesAlCerrar=Asigna(Filtro.Cliente, Nulo)<BR>Asigna(Filtro.Proyecto, Nulo)<BR>Asigna(Filtro.Aseguradora, Nulo)<BR>Asigna(Filtro.Mov, Nulo)<BR>Asigna(Filtro.Proyecto, Nulo)<BR>Asigna(Filtro.Actividad, Nulo)<BR>sql(<T>Exec sp_MaviDM0112BUSC :tUsuario <T>,Usuario)
;ExpresionesAlCerrar=Asigna(Filtro.Cliente, Nulo)<BR>Asigna(Filtro.Proyecto, Nulo)<BR>Asigna(Filtro.Aseguradora, Nulo)<BR>Asigna(Filtro.Mov, Nulo)<BR>Asigna(Filtro.Proyecto, Nulo)<BR>Asigna(Filtro.Actividad, Nulo)<BR>sql(<T>Exec sp_MaviDM0112BUSC :tUsuario <T>,Usuario)<BR>SI(((Venta:Venta.Estatus <> <T>CONCLUIDO<T>)y (Venta:Venta.Mov en (<T>Factura<T>,<T>Credilana<T>,<T>Factura VIU<T>)) y (Vacio(Venta:Venta.MovID,Nulo) <> Nulo)), (EjecutarSQL('SPCancelaFolioVTASMAVI :n',Venta:Venta.ID )))
ExpresionesAlMostrar=Asigna(Info.Copiar, Falso)<BR>Asigna(Mavi.RM1161Bandera,<T>VERDADERO<T>)<BR>Asigna(Info.Positivos, Verdadero)<BR>Asigna(Info.Paquete, Nulo)<BR>Asigna(Info.RefrescandoPrecio, Falso)<BR>Asigna(Info.Cliente, Nulo)<BR>Asigna(Info.Mensaje,nulo)<BR>Asigna(Filtro.Cliente, Nulo)<BR>Asigna(Info.Conteo, 0)<BR>Asigna(Mavi.ServicasaCapDetallVentas,0)<BR>Asigna(MAVI.DM0116FaseC,0)<BR>Asigna(Mavi.DM0138ValidaCond, <T>Falso<T>)<BR>Asigna(Mavi.DM0296Nombre, Nulo)<BR>Asigna(Mavi.DM0257Usuario, Nulo)<BR>Asigna(Mavi.DM0296Nivel, Nulo)

ExpresionesAlCerrar=Asigna(Filtro.Cliente, Nulo)<BR>Asigna(Filtro.Proyecto, Nulo)<BR>Asigna(Filtro.Aseguradora, Nulo)<BR>Asigna(Filtro.Mov, Nulo)<BR>Asigna(Filtro.Proyecto, Nulo)<BR>Asigna(Filtro.Actividad, Nulo)<BR>sql(<T>Exec sp_MaviDM0112BUSC :tUsuario <T>,Usuario)<BR>Asigna(MAVI.DM0116FaseC,0)<BR>Asigna(Mavi.DM0271Bandera,<T>FALSO<T>)


VentanaEstadoInicial=Normal
;*** Termina modificacion mexico desarollo Cte Express
;ListaAcciones=Nuevo<BR>MovCopiar<BR>CopiarLote<BR>Abrir<BR>CopiarMeses<BR>Localizar<BR>Guardar<BR>Actualizar<BR>ActualizarPrecios<BR>MovPersonal<BR>Evaluaciones<BR>Propiedades<BR>Imprimir<BR>RepPantalla<BR>PlantillasOffice<BR>FormasAnexas<BR>Excel<BR>Verificar<BR>Situacion<BR>Sucursal<BR>Afectar<BR>Autorizar<BR>FEA<BR>Desafectar<BR>Consecutivo<BR>ModificarAlmacen<BR>Eliminar<BR>Importar<BR>ImportarPDT<BR>Cancelar<BR>Refacturar<BR>ReasignarUsuario<BR>ActualizarPoliticasPrecios<BR>ActualizarPrecioMoneda<BR>Cambiar Vista Hoja<BR>CopiarPendientes<BR>CopiarOtros<BR>CopiarComentario<BR>Embarcar<BR>SubMovimiento<BR>AnexarMov<BR>Campos<BR>CamposExtras<BR>DatosEntrega<BR>Cobro<BR>Totalizar<BR>DescuentoGlobal<BR>Accesorios<BR>ServicioMatriz<BR>Asistente Articulos<BR>Asistente Codigo Barras<BR>Asistente Codigo Bar<CONTINUA>
;ListaAcciones002=<CONTINUA>ras (Lote)<BR>Actividades<BR>MovActividad<BR>SeriesLotes<BR>Sustitutos<BR>Precio<BR>PrecioConImpuestos<BR>ProrrateoFecha<BR>ServicioTipoPlantilla<BR>AnticiposFacturados<BR>Anexos<BR>AnexosDetalle<BR>AgregarEvento<BR>Anticipos<BR>MontoAbono_MAVI<BR>TraspasarArticulos<BR>Tareas<BR>Embarque<BR>Incentivo<BR>Participacion<BR>CteExpress<BR>EditarCliente<BR>CteEnviarA<BR>ArtExpress<BR>ValesMAVI<BR>LiberarMonedero<BR>VINExpress<BR>EditarVIN<BR>VentaOtros<BR>PresupuestoEsp<BR>Huella<BR>Huella2<BR>Anterior<BR>Siguiente<BR>Catalogos<BR>ArtListaDisponible<BR>Disponible<BR>ArtInfo<BR>EspacioInfo<BR>CteInfo<BR>ProyInfo<BR>ValesMAVILista<BR>ServicioHist<BR>VINComponentes<BR>VentaDReservados<BR>ArtAccesorioBuscar<BR>ArtRefaccionBuscar<BR>VerPoliticaPrecios<BR>TiempoEntregaSugerido<BR>Asistente Precios<BR>MovImpuesto<BR>Boletos<BR>BoletosVendidos<BR>Resumen<BR>FordOasis<BR>AsesoresDisponible<BR<CONTINUA>
;ListaAcciones003=<CONTINUA>>Tiempo<BR>VerComentarios<BR>Politica<BR>PoliticaConcepto<BR>Mapa<BR>MovBitacora<BR>IngresosGenerados<BR>PedidoPos<BR>TablaAmortizacion<BR>RentabilidadContrato<BR>MovPos<BR>Navegador<BR>Recalcular<BR>Cerrar<BR>Otros1<BR>Otros2<BR>Otros3<BR>Otros4<BR>Otros5<BR>Otros6<BR>Otros7<BR>Otros8<BR>Otros9<BR>SucVen<BR>GuardadoAutomatico

;Se agrega Accion SHM
;ListaAcciones=Nuevo<BR>MovCopiar<BR>CopiarLote<BR>Abrir<BR>CopiarMeses<BR>Localizar<BR>Guardar<BR>Actualizar<BR>ActualizarPrecios<BR>MovPersonal<BR>Evaluaciones<BR>Propiedades<BR>Imprimir<BR>RepPantalla<BR>PlantillasOffice<BR>FormasAnexas<BR>Excel<BR>Verificar<BR>Situacion<BR>Sucursal<BR>Afectar<BR>Autorizar<BR>FEA<BR>Desafectar<BR>Consecutivo<BR>ModificarAlmacen<BR>Eliminar<BR>Importar<BR>ImportarPDT<BR>Cancelar<BR>Refacturar<BR>ReasignarUsuario<BR>ActualizarPoliticasPrecios<BR>ActualizarPrecioMoneda<BR>Cambiar Vista Hoja<BR>CopiarPendientes<BR>CopiarOtros<BR>CopiarComentario<BR>Embarcar<BR>SubMovimiento<BR>AnexarMov<BR>Campos<BR>CamposExtras<BR>DatosEntrega<BR>Cobro<BR>Totalizar<BR>DescuentoGlobal<BR>Accesorios<BR>ServicioMatriz<BR>Asistente Articulos<BR>Asistente Codigo Barras<BR>Asistente Codigo Bar<CONTINUA>
;ListaAcciones002=<CONTINUA>ras (Lote)<BR>Actividades<BR>MovActividad<BR>SeriesLotes<BR>Sustitutos<BR>Precio<BR>PrecioConImpuestos<BR>ProrrateoFecha<BR>ServicioTipoPlantilla<BR>AnticiposFacturados<BR>Anexos<BR>AnexosDetalle<BR>AgregarEvento<BR>Anticipos<BR>MontoAbono_MAVI<BR>TraspasarArticulos<BR>Tareas<BR>SHM<BR>SHMADJUNTAR<BR>HOJAVERDE<BR>Embarque<BR>Incentivo<BR>Participacion<BR>CteExpress<BR>EditarCliente<BR>CteEnviarA<BR>ArtExpress<BR>ValesMAVI<BR>LiberarMonedero<BR>VINExpress<BR>EditarVIN<BR>VentaOtros<BR>PresupuestoEsp<BR>Huella<BR>Huella2<BR>Anterior<BR>Siguiente<BR>Catalogos<BR>ArtListaDisponible<BR>Disponible<BR>ArtInfo<BR>EspacioInfo<BR>CteInfo<BR>ProyInfo<BR>ValesMAVILista<BR>ServicioHist<BR>VINComponentes<BR>VentaDReservados<BR>ArtAccesorioBuscar<BR>ArtRefaccionBuscar<BR>VerPoliticaPrecios<BR>TiempoEntregaSugerido<BR>Asistente Precios<BR>MovImpuesto<BR>Boletos<BR>BoletosVendidos<BR>Resumen<BR>FordOasis<BR>AsesoresDisponible<BR<CONTINUA>
;ListaAcciones003=<CONTINUA>>Tiempo<BR>VerComentarios<BR>Politica<BR>PoliticaConcepto<BR>Mapa<BR>MovBitacora<BR>IngresosGenerados<BR>PedidoPos<BR>TablaAmortizacion<BR>RentabilidadContrato<BR>MovPos<BR>DM0138CapturaCorreo<BR>Navegador<BR>Recalcular<BR>Cerrar<BR>Otros1<BR>Otros2<BR>Otros3<BR>Otros4<BR>Otros5<BR>Otros6<BR>Otros7<BR>Otros8<BR>Otros9<BR>SucVen<BR>GuardadoAutomatico<BR>ValidaSituac
;AutoGuardar=S

;se Agrega Accion CteExpressNew efmartinez 2015-05-26
ListaAcciones=Nuevo<BR>MovCopiar<BR>CopiarLote<BR>Abrir<BR>CopiarMeses<BR>Localizar<BR>Guardar<BR>Actualizar<BR>ActualizarPrecios<BR>MovPersonal<BR>Evaluaciones<BR>Propiedades<BR>Imprimir<BR>RepPantalla<BR>PlantillasOffice<BR>FormasAnexas<BR>Excel<BR>Verificar<BR>Situacion<BR>Sucursal<BR>Afectar<BR>Autorizar<BR>FEA<BR>Desafectar<BR>Consecutivo<BR>ModificarAlmacen<BR>Eliminar<BR>Importar<BR>ImportarPDT<BR>Cancelar<BR>Refacturar<BR>ReasignarUsuario<BR>ActualizarPoliticasPrecios<BR>ActualizarPrecioMoneda<BR>Cambiar Vista Hoja<BR>CopiarPendientes<BR>CopiarOtros<BR>CopiarComentario<BR>Embarcar<BR>SubMovimiento<BR>AnexarMov<BR>Campos<BR>CamposExtras<BR>DatosEntrega<BR>Cobro<BR>Totalizar<BR>DescuentoGlobal<BR>Accesorios<BR>ServicioMatriz<BR>Asistente Articulos<BR>Asistente Codigo Barras<BR>Asistente Codigo Bar<CONTINUA>
ListaAcciones002=<CONTINUA>ras (Lote)<BR>Actividades<BR>MovActividad<BR>SeriesLotes<BR>Sustitutos<BR>Precio<BR>PrecioConImpuestos<BR>ProrrateoFecha<BR>ServicioTipoPlantilla<BR>AnticiposFacturados<BR>Anexos<BR>AnexosDetalle<BR>AgregarEvento<BR>Anticipos<BR>MontoAbono_MAVI<BR>TraspasarArticulos<BR>Tareas<BR>SHM<BR>SHMADJUNTAR<BR>HOJAVERDE<BR>Embarque<BR>Incentivo<BR>Participacion<BR>CteExpressNew<BR>EditarCliente<BR>CteEnviarA<BR>ArtExpress<BR>ValesMAVI<BR>LiberarMonedero<BR>VINExpress<BR>EditarVIN<BR>VentaOtros<BR>PresupuestoEsp<BR>Huella<BR>Huella2<BR>Anterior<BR>Siguiente<BR>Catalogos<BR>ArtListaDisponible<BR>Disponible<BR>ArtInfo<BR>EspacioInfo<BR>CteInfo<BR>ProyInfo<BR>ValesMAVILista<BR>ServicioHist<BR>VINComponentes<BR>VentaDReservados<BR>ArtAccesorioBuscar<BR>ArtRefaccionBuscar<BR>VerPoliticaPrecios<BR>TiempoEntregaSugerido<BR>Asistente Precios<BR>MovImpuesto<BR>Boletos<BR>BoletosVendidos<BR>Resumen<BR>FordOasis<BR>AsesoresDisponible<BR<CONTINUA>
ListaAcciones003=<CONTINUA>>Tiempo<BR>VerComentarios<BR>Politica<BR>PoliticaConcepto<BR>Mapa<BR>MovBitacora<BR>IngresosGenerados<BR>PedidoPos<BR>TablaAmortizacion<BR>RentabilidadContrato<BR>MovPos<BR>DM0138CapturaCorreo<BR>Navegador<BR>Recalcular<BR>Cerrar<BR>Otros1<BR>Otros2<BR>Otros3<BR>Otros4<BR>Otros5<BR>Otros6<BR>Otros7<BR>Otros8<BR>Otros9<BR>SucVen<BR>GuardadoAutomatico<BR>ValidaSituac<BR>MatrizAutorizacion
AutoGuardar=S

; **** 28-Sept-09 Se modifico: Se agregaron validaciones a las devoluciones de venta por UEN. ALQG
; **** 25-Sep-09: Se agrego la validacion para las facturas de VIU para que no se emitan movimientos con articulos que no corresponden. ALQG
; **** 21-Ago-08: Se agregaron nuevas validaciones para los movimientos: CAncela Credilana, Cancela Prestamo, Cancela Seg Auto, Cancela Seg Vida y Devolucion Venta
; **** Modificación para asignar la uen a la variable info.uen, para validar la UEN en los movimientos y que no se puedan generar: "Analisis Credito","Factura","Credilana","Seguro Vida","Seguro Auto","Factura VIU","Prestamo Personal","Analisis Mayoreo","Pedido Mayoreo","Factura Mayoreo","Devolucion Venta","Devolucion VIU","Devolucion Mayoreo" a partir de cero, y que no se puedan generar "Pedidos" a partir de cero a menos que la condicion de pago sea de contado****
; **** Se modifico el parametro "Expresion" para validar que el usuario no integre en los movimientos "VTAS.P" articulos combinados de familias: "SEGUROS", "SEGUROS VIDA", "FINANCIEROS" ****
; **** 09-Oct-08 Arly Rubio Camacho: Se agrego la validacion para que en los movimientos de devolucion o solicitud de devolucion valide que no se esten regresando articulos que correspondan a movimientos con diferentes condicioses (menor a 12 o mayor a 12 meses) ****
; **** Integracion de validacion para Monedero Electronico en AntesExpresiones012. JR 11-Oct-2012.****

[Venta.frm/Acciones.Afectar]
;Expresion=Asigna(Info.CantidadInventario,SQL(<T>Select dbo.fnDM0305validaTelCte(:tCte,:tUsr)<T>,Venta:Venta.Cliente,Usuario))<BR>Si<BR>  (Info.CantidadInventario <> 0 ) y (Venta:Venta.Mov <> <T>Analisis Credito<T>)<BR>Entonces<BR>   Ejecutar(<T>PlugIns\DM0305ValidaTelefono.exe <T>+Venta:Venta.Cliente+<T> <T>+ Usuario+<T> <T>+Info.CantidadInventario)<BR>   AbortarOperacion<BR> Fin<BR><BR>SI  (SQL(<T>Select dbo.fnDM0138validaCte(:tCte,:tUsr)<T>,Venta:Venta.Cliente, Usuario) =<T>SI<T>) y (vacio(Venta:Venta.Origen) o vacio(Venta:Venta.OrigenID)) y (Venta:Venta.Mov noen (<T>Devolucion Venta<T>,<T>Devolucion Mayoreo<T>,<T>Devolucion VIU<T>,<T>Sol Dev Mayoreo<T>,<T>Solicitud Devolucion<T>))<BR> Entonces<BR>      Forma(<T>DM0138CapturaCorreo<T>)<BR><BR> Sino<BR>Si<BR>    (Venta:Venta.Mov en (<T>Cancela Cred<CONTINUA>
;Expresion002=<CONTINUA>ilana<T>,<T>Cancela Prestamo<T>,<T>Cancela Seg Auto<T>,<T>Cancela Seg Vida<T>,<T>Cancelacion Factura<T>,<T>Devolucion Mayoreo<T>,<T>Devolucion Venta<T>,<T>Devolucion VIU<T>,<T>Credilana<T>,<T>Factura<T>,<T>Factura Mayoreo<T>,<T>Factura VIU<T>,<T>Prestamo Personal<T>,<T>Seguro Auto<T>,<T>Seguro Vida<T>)) y ((vacio(Venta:Venta.Origen)) o (vacio(Venta:Venta.OrigenID)))<BR>Entonces<BR>  INFORMACION(<T>Movimiento no se puede Afectar<T>)<BR>  AbortarOperacion<BR>Sino<BR>    SI(((Venta:Venta.Estatus <> <T>CONCLUIDO<T>)y (Venta:Venta.Mov en (<T>Factura<T>,<T>Credilana<T>,<T>Factura VIU<T>)) y (Vacio(Venta:Venta.MovID))), (EjecutarSQL( <T>EXEC spConsecutivoGral :nID, :tMod, :bApl<T> ,Venta:Venta.ID, <T>VTAS<T>, 0)))<BR>    Asigna(Info.Modulo, <T>VTAS<T>)<BR>    Asigna(Info.ID, Venta:Venta.ID)<BR>  <CONTINUA>
;Expresion003=<CONTINUA>  Asigna(Info.Mov, Venta:Venta.Mov)<BR>    Asigna(Info.MovID, Venta:Venta.MovID)<BR>    Si<BR>      (MovTipoEn(<T>VTAS<T>, Venta:Venta.Mov, (VTAS.P))) y (SQL(<T>Select count(*) from VentaD where ID=:nID<T>,Venta:Venta.ID)>0)<BR>    Entonces<BR>      SI(SQL(<T>spValidarFamilia_MAVI :nIDM<T>, Venta:Venta.ID) = 0,Si(Precaucion(<T>Se Agregaron Codigos Incompatibles<T>, BotonCancelar)=BotonCancelar, AbortarOperacion))<BR>    Fin<BR><BR>    Si<BR>      (MovTipoEn(<T>VTAS<T>, Venta:Venta.Mov, (VTAS.SD, VTAS.B, VTAS.D))) y (SQL(<T>Select count(*) from VentaD where ID=:nID<T>,Venta:Venta.ID)>0)<BR>    Entonces<BR>      SI(SQL(<T>spTipoCondicionMAVI :nID<T>, Venta:Venta.ID) = 0,Si(Precaucion(<T>Se agregaron artículos que provienen de movimientos con condiciones mayores y menores a 12 meses<T>, Boton<CONTINUA>
;Expresion004=<CONTINUA>Aceptar)=BotonAceptar, AbortarOperacion, AbortarOperacion))<BR>    Fin<BR><BR>    Si<BR>      (Info.Mov en(<T>Credilana<T>,<T>Factura<T>,<T>Factura VIU<T>,<T>Seguro Auto<T>,<T>Seguro Vida<T>,<T>Prestamo Personal<T>,<T>Cancela Credilana<T>,<T>Cancela Prestamo<T>,<T>Cancela Seg Auto<T>,<T>Cancela Seg Vida<T>,<T>Devolucion Venta<T>,<T>Devolucion VIU<T>)) y (SQL(<T>Select count(*) from VentaD where ID=:nID<T>,Venta:Venta.ID)>0)<BR>    Entonces<BR>      SI(SQL(<T>spValidarFamiliaAlFacturar_MAVI :nIDM, :tMov<T>, Venta:Venta.ID,Info.Mov) = 0,Si(Precaucion(<T>Hay Codigos Incompatibles Con El Movimiento<T>, BotonCancelar)=BotonCancelar, AbortarOperacion))<BR>    Fin<BR><BR>    Si<BR>      Config.VentaActualizarPrecioMoneda y (Venta:Venta.Estatus en (EstatusSinAfectar, EstatusPorConfirmar)) y SQL(<T<CONTINUA>
;Expresion005=<CONTINUA>>spVentaActualizarPreciosChecar :nID<T>, Venta:Venta.ID)<BR>    Entonces<BR>      Caso Confirmacion(<T>¿ Desea Actualizar los Precios Otras Monedas ?<T>, BotonSi, BotonNo, BotonCancelar)<BR>        Es BotonSi Entonces EjecutarSQL(<T>spVentaActualizarPrecios :nID<T>, Venta:Venta.ID) AbortarOperacion<BR>        Es BotonCancelar Entonces AbortarOperacion<BR>      Fin<BR>    Fin<BR><BR>    Si(General.OFER, EjecutarSQL(<T>spOfertaAplicar :nID<T>, Venta:Venta.ID))<BR>    Si<BR>      (Venta:Venta.Mov=Info.MovProcesar) y (Venta:Venta.Estatus=EstatusSinAfectar)<BR>    Entonces<BR>      EjecutarSQL(<T>xpVentaAutoProcesar :nID<T>, Venta:Venta.ID)<BR>    Sino<BR>      Asigna(Afectar.Modulo, <T>VTAS<T>)<BR>      Asigna(Afectar.ID, Venta:Venta.ID)<BR>      Asigna(Afectar.Mov, Venta:Venta.Mov)<BR>      A<CONTINUA>
;Expresion006=<CONTINUA>signa(Afectar.MovID, Venta:Venta.MovID)<BR>      Asigna(Afectar.FormaCaptura, <T>Venta<T>)<BR>      Asigna(Afectar.EnviarCFD, Falso)<BR>      Asigna(Info.TituloDialogo, Afectar.Mov+<T> <T>+Afectar.MovID)                              <BR>      Asigna(Info.MovTipo, MovTipo(<T>VTAS<T>, Venta:Venta.Mov))<BR>      Asigna(Info.Cliente, Venta:Venta.Cliente)<BR>      Asigna(Info.Moneda, Venta:Venta.Moneda)<BR>      Asigna(Info.TipoCambio, Venta:Venta.TipoCambio)<BR>      Asigna(Info.Importe, Redondea(Suma(VentaD:Importe)+Suma(VentaD:Impuesto)-Suma(VentaD:DescGlobal)+Suma(VentaD:ImporteSobrePrecio)-(Venta:Venta.AnticiposFacturados+Venta:Venta.Retencion), Config.VentaCobroRedondeoDecimales))<BR>      Si<BR>        (Info.Importe<>0) y<BR>        (Venta:Venta.Estatus en (EstatusSinAfectar, EstatusBorr<CONTINUA>
;Expresion007=<CONTINUA>ador, EstatusPorConfirmar)) y<BR>        ((MovTipoEn(<T>VTAS<T>, Venta:Venta.Mov, (VTAS.N, VTAS.FM)) y (ConDatos(Venta:Venta.MovID) o Config.VentaLiquidaIntegral) y (Venta:Condicion.ControlAnticipos<><T>Cobrar Pedido<T>)) o<BR>        (MovTipoEn(<T>VTAS<T>, Venta:Venta.Mov, (VTAS.S, VTAS.P, VTAS.VP, VTAS.SD, VTAS.B))  y (Venta:Condicion.ControlAnticipos=<T>Cobrar Pedido<T>)) o<BR>        (MovTipoEn(<T>VTAS<T>, Venta:Venta.Mov, (VTAS.F, VTAS.FAR, VTAS.FB, VTAS.D, VTAS.DF)) y (Venta:Venta.Vencimiento<=Venta:Venta.FechaEmision) y Config.FacturaCobroIntegrado y (Venta:Condicion.ControlAnticipos<><T>Cobrar Pedido<T>) y (Venta:Venta.OrigenTipo<><T>VMOS<T>)))<BR>      Entonces<BR>        Asigna(Info.ID, Venta:Venta.ID)<BR>        Asigna(Info.Cerrado, Falso)<BR>        Asigna(Info.VentaCobroDevolu<CONTINUA>
;Expresion008=<CONTINUA>cion, MovTipoEn(<T>VTAS<T>, Venta:Venta.Mov, (VTAS.VP, VTAS.SD, VTAS.B, VTAS.D, VTAS.DF)))<BR>        Forma(<T>VentaCobro<T>)<BR>      Sino<BR>        Si<BR>          (Venta:Venta.Estatus en (EstatusSinAfectar, EstatusBorrador, EstatusPorConfirmar)) o ((MovTipo(<T>VTAS<T>,Venta:Venta.Mov)=VTAS.S) y (Venta:Venta.Estatus=EstatusPorConfirmar))<BR>        Entonces<BR>          Si(Config.CompraVentaSinIVA y (Suma(VentaD:Impuesto)=0.0) y (Suma(VentaD:Importe)>0.0), Si(Confirmacion(<T>Movimiento sin Impuestos<T>+NuevaLinea+<T>¿ Es Correcto ?<T>,BotonSi,BotonNo)=BotonNo,AbortarOperacion))<BR><BR>          Si<BR>            Empresa.CFD y SQL(<T>SELECT CFD FROM MovTipo WHERE Modulo=:tModulo AND Mov=:tMov<T>, Afectar.Modulo, Afectar.Mov)<BR>          Entonces<BR>            EjecutarSQL(<T>spAfectar :<CONTINUA>
;Expresion009=<CONTINUA>tModulo, :nID, :tAccion<T>, Afectar.Modulo, Afectar.ID, <T>CONSECUTIVO<T>)<BR>            Si(no CFD.Generar(Afectar.Modulo, Afectar.ID),  Forma.ActualizarForma AbortarOperacion)<BR>            Asigna(Afectar.EnviarCFD, SQL(<T>SELECT EnviarAlAfectar FROM EmpresaCFD WHERE Empresa=:tEmpresa<T>, Empresa))<BR>          Fin<BR><BR>          Si<BR>            Venta:Venta.Estatus=EstatusPorConfirmar<BR>          Entonces<BR>            Caso MovTipo(<T>VTAS<T>, Venta:Venta.Mov)<BR>              Es VTAS.S  Entonces Dialogo(<T>GenerarServicioPorConfirmar<T>)<BR>              Es VTAS.CS Entonces Dialogo(<T>GenerarCotizacionServicio<T>)<BR>              Es VTAS.C  Entonces<BR>                          Si (Venta:Venta.OrigenTipo=<T>VTAS<T>) y (MovTipo(<T>VTAS<T>, Venta:Venta.Origen)=VTAS.S)<BR>         <CONTINUA>
;Expresion010=<CONTINUA>                  Entonces<BR>                             Asigna(Afectar.Mov, Venta:Venta.Origen)<BR>                             Asigna(Afectar.MovID, Venta:Venta.OrigenID)<BR>                             Asigna(Afectar.ID, SQL(<T>SELECT ID FROM Venta WHERE Empresa = :tEmpresa AND Mov = :tMov AND MovID = :tMovID AND Estatus NOT IN (<T>+Comillas(EstatusSinAfectar)+<T>, <T>+Comillas(EstatusCancelado)+<T>)<T>, Empresa, Afectar.Mov, Afectar.MovID))<BR>                             Dialogo(<T>AfectarServicio<T>)<BR>                           Sino<BR>                             Dialogo(<T>GenerarCotizacion<T>)<BR>                         Fin<BR>              Es VTAS.CO Entonces Dialogo(<T>GenerarContrato<T>)<BR>              Sino Afectar(Afectar.Modulo, Afectar.ID, Afectar.Mov, Afectar.MovID, <CONTINUA>
;Expresion011=<CONTINUA><T>Todo<T>, <T><T>, <T>Venta<T>)<BR>            Fin<BR>          Sino<BR>            Si<BR>              Config.Partidas y (MovTipo(<T>VTAS<T>, Venta:Venta.Mov)=VTAS.R)<BR>            Entonces<BR>              Forma(<T>AfectarPartidasRemision<T>)<BR>            Sino<BR>              Afectar(Afectar.Modulo, Afectar.ID, Afectar.Mov, Afectar.MovID, <T>Todo<T>, <T><T>, <T>Venta<T>)<BR>              SI (Venta:Venta.Mov=<T>Solicitud Credito<T>)y(SQL(<T>SELECT COUNT(ID) FROM dbo.Venta WITH(NOLOCK) WHERE ID=:tId AND Estatus=:tE<T>,Venta:Venta.ID,<T>PENDIENTE<T>)=1)<BR>              ENTONCES<BR>                  SI (SQL(<T>SELECT COUNT(Numero) FROM dbo.TablaNumD WITH(NOLOCK)WHERE TablaNum=:tB AND Numero=:tN<T>,<T>SUCURSALES SHM<T>,Sucursal)=0 ) y ((SQL(<T>Select Count(*) From VentasCanalMAVI Where <CONTINUA>
;Expresion012=<CONTINUA>ID=:nID and Cadena=:tCad<T>,Venta:Venta.EnviarA,<T>VENTA VALE<T>)=0) o (SQL(<T>Select count(*) From VentaD with(nolock) where ID = <T> + Venta:Venta.ID +<T> and Articulo like <T> + Comillas(<T>%VALR%<T>)) > 0))<BR>                  ENTONCES<BR>                      Si((Venta:Venta.Mov=<T>Solicitud Credito<T>),Ejecutar(<T>PlugIns\DM0221LiberadorAuto.exe <T> + Venta:Venta.ID + <T> <T> + Venta:Venta.Usuario,Verdadero))<BR>                  SINO<BR>                     SI<BR>                     (SQL(<T>Select Count(*) From VentasCanalMAVI Where ID=:nID and Cadena=:tCad<T>,Venta:Venta.EnviarA,<T>VENTA VALE<T>)=0) o (SQL(<T>Select count(*) From VentaD with(nolock) where ID = <T> + Venta:Venta.ID +<T> and Articulo like <T> + Comillas(<T>%VALR%<T>)) > 0)<BR>                             Entonces<B<CONTINUA>
;Expresion013=<CONTINUA>R>                             SQL(<T>EXEC dbo.SP_SHM_APARTAMOV :tId,:tSuc<T>,Venta:Venta.ID,Sucursal)<BR>                                SI SQL(<T>SELECT COUNT(Numero) FROM dbo.TablaNumD WHERE TablaNum=:tTab AND CAST(Numero AS INT)=:nSuc<T>, <T>SUCURSALES RDP<T>, Sucursal)=1<BR>                                  Entonces<BR>                                  Asigna(Info.MovID,SQL(<T>SELECT MovID FROM dbo.Venta WITH(NOLOCK) WHERE ID=:tID<T>,Venta:Venta.ID))<BR>                                  Ejecutar(<T>PlugIns\RutaTicket.exe <T>+<T>SHM<T>+<T> <T>+Info.MovID+<T> <T>+Usuario+<T> <T>+Venta:Venta.Cliente+<T> <T>+Sucursal+<T> <T>+EstacionTrabajo)<BR>                                 Sino<BR>                                     Asigna(Info.MovID,SQL(<T>SELECT MovID FROM dbo.Venta WITH(NOLOCK) WH<CONTINUA>
;Expresion014=<CONTINUA>ERE ID=:tID<T>,Venta:Venta.ID))<BR>                                     Ejecutar(<T>C:\AppsMavi\SHM\SHM.exe <T>+Usuario+<T> <T>+Sucursal+<T> <T>+Info.MovID+<T> <T>+Venta:Venta.Cliente)<BR>                                 Fin<BR>                            Fin<BR>                            Si (SQL(<T>Select Cadena From VentasCanalMAVI Where ID=:nID<T>,Venta:Venta.EnviarA)=<T>VENTA VALE<T>)) y (SQL(<T>Select count(*) From VentaD with(nolock) where ID = <T> + Venta:Venta.ID +<T> and Articulo like <T> + Comillas(<T>%VALR%<T>)) = 0)<BR><BR>                            Entonces<BR>                            Si ((SQL(<T>Select dbo.fnClientesNuevosCasaMAVI(:nId)<T>,Venta:Venta.ID) = <T>Nuevo<T>) y (SQL(<T>Select count(*) From VentaD with(nolock) Where Articulo like <T> + Comillas(<T>%VALR%<T>) + <CONTINUA>
;Expresion015=<CONTINUA><T> And ID = <T> + Venta:Venta.ID) = 0) y (Venta:Venta.Mov=<T>Solicitud Credito<T>) y (Venta:Venta.EnviarA = 76) y (SQL(<T>select cOUNT(*) from Venta With(NoLock) where Cliente = <T> + comillas(Venta:Venta.Cliente) +<T> AND ESTATUS = <T>+comillas(<T>Concluido<T>) + <T> and Mov in (<T> + comillas(<T>Factura<T>) +<T>,<T>+comillas(<T>Credilana<T>)+<T>) and EnviarA = 76<T>) = 0) ))<BR>                            Entonces<BR>                              SI<BR>                               SQL(<T>Select Count(*) From MovBitacora with(nolock) where ID = <T>+ Venta:Venta.ID + <T> And Clave in (select valor from SHM_ValorDeEventosValera with(nolock))<T>) =0<BR>                                Entonces<BR>                                        Asigna(Mavi.BanderarFlujo,1)<BR>                      <CONTINUA>
;Expresion016=<CONTINUA>                  Asigna(Info.AgenteA,Venta:Venta.Agente)<BR>                                        informacion(<T>Agregar evento para valera<T>)<BR>                                        Forma(<T>MovBitacoraAgregar<T>)<BR>                                    Fin<BR>                                Fin<BR>                                 <BR>                                 SI SQL(<T>SELECT COUNT(Numero) FROM dbo.TablaNumD WHERE TablaNum=:tTab AND CAST(Numero AS INT)=:nSuc<T>, <T>SUCURSALES RDP<T>, Sucursal)=1<BR>                                      Entonces<BR>                                         EjecutarSQL(<T>EXEC SP_DM0244ActualizaSertipoope :nID<T>,Venta:Venta.ID)<BR>                                         Asigna(Info.MovID,SQL(<T>SELECT MovID FROM dbo.Venta WITH(NOLOCK) WHERE I<CONTINUA>
;Expresion017=<CONTINUA>D=:tID<T>,Venta:Venta.ID))<BR>                                         Ejecutar(<T>PlugIns\RutaTicket.exe <T>+<T>SHM3<T>+<T> <T>+Info.MovID+<T> <T>+Usuario+<T> <T>+Venta:Venta.Cliente+<T> <T>+Sucursal+<T> <T>+EstacionTrabajo)<BR>                                      sino<BR>                                         EjecutarSQL(<T>EXEC SP_DM0244ActualizaSertipoope :nID<T>,Venta:Venta.ID)<BR>                                         Asigna(Info.MovID,SQL(<T>SELECT MovID FROM dbo.Venta WITH(NOLOCK) WHERE ID=:tID<T>,Venta:Venta.ID))<BR>                                        Ejecutar(<T>C:\AppsMavi\SHM\SHM.exe <T>+<T>CLIENTEFINAL<T>+<T> <T>+ Usuario+<T> <T>+Info.MovID+<T> <T>+Sucursal)<BR>                                   fin<BR>                         Fin<BR>                  FIN<BR>         <CONTINUA>
;Expresion018=<CONTINUA>     SINO<BR>                Verdadero<BR>              FIN<BR>              Forma.ActualizarForma<BR>            Fin<BR>          Fin<BR><BR>          Si(Afectar.EnviarCFD, CFD.Enviar(Afectar.Modulo, Afectar.ID))<BR>        Sino<BR>          Asigna(Info.Modulo, <T>VTAS<T>)<BR>          Asigna(Info.Mov, Venta:Venta.Mov)<BR>          Asigna(Info.MovID, Venta:Venta.MovID)<BR>          Asigna(Afectar.Base, <T>Pendiente<T>)<BR>          Asigna(Afectar.GenerarMov, <T><T>)<BR>          Asigna(Afectar.FormaCaptura, <T>Venta<T>)<BR>          Si<BR>            (ConfigModulo(Info.Modulo, <T>FlujoAbierto<T>) = <T>Si<T>) y (no MovTipoEn(<T>VTAS<T>, Venta:Venta.Mov, (VTAS.F, VTAS.FAR, VTAS.FB)))<BR>          Entonces<BR>            Si<BR>              Forma(<T>GenerarMovFlujo<T>)<BR>            Entonce<CONTINUA>
;Expresion019=<CONTINUA>s<BR>              Caso Info.MovGenerar<BR>                Es <T>(Reservar)<T>    Entonces Si(Usuario.Reservar,    Dialogo(<T>Reservar<T>),     Precaucion(<T>No Tiene Acceso<T>))<BR>                Es <T>(Desreservar)<T> Entonces Si(Usuario.Desreservar, Dialogo(<T>DesReservar<T>),  Precaucion(<T>No Tiene Acceso<T>))<BR>                Es <T>(Asignar)<T>     Entonces Si(Usuario.Asignar,     Dialogo(<T>Asignar<T>),      Precaucion(<T>No Tiene Acceso<T>))<BR>                Es <T>(Desasignar)<T>  Entonces Si(Usuario.DesAsignar,  Dialogo(<T>DesAsignar<T>),   Precaucion(<T>No Tiene Acceso<T>))<BR>                Es <T>(Facturacion Rapida)<T>          Entonces ProcesarSQL(<T>spFacturacionRapida :nID, :tUsuario, :tEmpresa<T>,    Afectar.ID, Usuario, Empresa)<BR>                Es <T>(Facturacion <CONTINUA>
;Expresion020=<CONTINUA>Rapida Agrupada)<T> Entonces ProcesarSQL(<T>spFacturacionRapida :nID, :tUsuario, :tEmpresa, 1<T>, Afectar.ID, Usuario, Empresa)<BR>                Es <T>(Generar Orden Transferencia)<T><BR>                 Entonces<BR>                   Si<BR>                     Usuario.PedidoGenerarOT y Dialogo(<T>EstaSeguro<T>)<BR>                   Entonces<BR>                     Si<BR>                       Usuario.PedidoGenerarOTAbrir<BR>                     Entonces<BR>                       FormaPos(<T>Inv<T>, SQLEnLista(<T>spPedidoGenerarOT :tEmpresa, :nID, :nSucursal, :tUsuario, :tMov, @VerID = 1<T>, Empresa, Venta:Venta.ID, Sucursal, Usuario, ConfigMov.InvOrdenTransferencia))<BR>                     Sino<BR>                       ProcesarSQL(<T>spPedidoGenerarOT :tEmpresa, :nID, :nSucursal, :tU<CONTINUA>
;Expresion021=<CONTINUA>suario, :tMov<T>, Empresa, Venta:Venta.ID, Sucursal, Usuario, ConfigMov.InvOrdenTransferencia)<BR>                     Fin<BR>                   Sino<BR>                     Precaucion(<T>No Tiene Acceso<T>)<BR>                   Fin<BR>                Sino<BR>                  Asigna(Afectar.GenerarMov, Info.MovGenerar)<BR>                  Asigna(Info.TituloDialogo, <T>Generar <T>+Comillas(Info.MovGenerar)+<T> de <T>+Comillas(Info.Mov))<BR>                  SI(Venta:Venta.EnviarA=11,Dialogo(<T>GenerarPedidoPendiente<T>),Generar(Afectar.Modulo, Afectar.ID, Afectar.Mov, Afectar.MovID, <T>Pendiente<T>, Afectar.GenerarMov,Afectar.FormaCaptura))<BR>              Fin<BR>            Fin<BR>          Sino<BR>            Caso MovTipo(<T>VTAS<T>, Venta:Venta.Mov)<BR>              Es VTAS.PR  Enton<CONTINUA>
;Expresion022=<CONTINUA>ces Dialogo(<T>GenerarPresupuestoVentas<T>)<BR>              Es VTAS.P   Entonces Dialogo(Info.Dialogo)<BR>              Es VTAS.S   Entonces Dialogo(<T>GenerarServicio<T>) <BR>              Es VTAS.R   Entonces Dialogo(<T>GenerarRemision<T>)<BR>              Es VTAS.VCR Entonces Dialogo(<T>GenerarRemisionConsignacion<T>)<BR>              Es VTAS.VC  Entonces Dialogo(<T>GenerarVentaConsignacion<T>)<BR>              Es VTAS.F   Entonces Dialogo(<T>GenerarFactura<T>)<BR>              Es VTAS.FAR Entonces Dialogo(<T>GenerarFactura<T>)<BR>              Es VTAS.FB  Entonces Dialogo(<T>GenerarFactura<T>)<BR>              Es VTAS.FR  Entonces Dialogo(<T>GenerarFacturaRecurrente<T>)<BR>              Es VTAS.SD  Entonces Dialogo(<T>GenerarSolicitudDevolucion<T>)<BR>            Fin<BR>          Fin<<CONTINUA>
;Expresion023=<CONTINUA>BR>        Fin<BR>      Fin<BR>    Fin<BR>    Si<BR>    Venta:Venta.Mov en (<T>Solicitud Credito<T>,<T>Analisis Credito<T>,<T>Pedido<T>,<T>Factura<T>,<T>Credilana<T>,<T>Seguro Vida<T>,<T>Seguro Auto<T>,<T>Solicitud Mayoreo<T>,<T>Analisis Mayoreo<T>,<T>Pedido Mayoreo<T>,<T>Factura Mayoreo<T>)<BR>    Entonces<BR>    Asigna(Info.Conteo, Info.Conteo+1)<BR>    Sino<BR>    Asigna(Info.Conteo, 0)<BR>    Fin<BR>           <BR>    Asigna(Mavi.MonederoRedimeMensaje,SQL(<T>EXEC dbo.SP_MensajeDevMonedero :tFac,:tFacId,:nOp<T>,Venta:Venta.Mov,Venta:Venta.ID,3))<BR>    SI ConDatos(Mavi.MonederoRedimeMensaje)<BR>    ENTONCES<BR>        Precaucion(Mavi.MonederoRedimeMensaje)<BR>    SINO<BR>        1=1<BR>    FIN<BR>Fin<BR>FIN<BR>si(SQL(<T>Select Count(*) From VentasCanalMAVI Where ID=:nID and cadena=:tCad<CONTINUA>
;Expresion024=<CONTINUA><T>,Venta:Venta.EnviarA,<T>VENTA VALE<T>)> 0, EjecutarSQL(<T>SP_DM0244NipValesVta :tid, :tvale, :testatus<T>, Venta:Venta.ID, Mavi.DM0244Vale, <T>afectar<T>),Falso)<BR><BR>SI<BR>   (Venta:Venta.Mov en (<T>Solicitud Credito<T>,<T>Analisis Credito<T>,<T>Pedido<T>,<T>Factura VIU<T>,<T>Credilana<T>, <T>Prestamo Personal<T>, <T>Seguro Vida<T>, <T>Factura<T>) y (Venta:Venta.Estatus <> <T>CANCELADO<T>)) y (SQL(<T>SELECT CATEGORIA FROM VentasCanalMavi WHERE ID=:nId<T>,Venta:Venta.EnviarA)=<T>CREDITO MENUDEO<T>)<BR>ENTONCES<BR>    EjecutarSQL(<T>SP_DM0169AcutalizaBanderaVenta <T>+comillas(Venta:Venta.Cliente)+<T>, <T>+comillas(Venta:Venta.Mov)+<T>, <T>+comillas(Venta:Venta.MovID)+<T>, 1<T>))<BR>FIN<BR>Si (Venta:Venta.Mov = <T>Solicitud Credito<T>)<BR>Entonces<BR>     EjecutarSQL( <T>EXEC dbo.SP_DM0<CONTINUA>
;Expresion025=<CONTINUA>257ListaNegra <T> + Comillas(Venta:Venta.Cliente) + <T>, <T> + Comillas(Usuario) + <T>, <T> + Comillas(Sucursal) + <T>, <T> + Comillas(Venta:Venta.ID)+ <T>, <T>+ Comillas(Venta:Venta.MovID))<BR>Fin<BR>SI(Venta:Venta.Mov=<T>Pedido<T>,EjecutarSql(<T>EXEC SP_DM0270ConsecPedido :nID<T>,Venta:Venta.ID)ActualizarVista)<BR>ASIGNA(Info.ArtSerie,SQL(<T>select propiedades from SerieLoteMov where modulo = :tMod AND id = :tId <T>,<T>VTAS<T>,Venta:Venta.ID) )<BR>ASIGNA(Info.SaldoMAVI,SQL(<T>SELECT dbo.FN_DM0169PrecioContadoItalika(:nID)<T>,Venta:Venta.ID))*Si (SQL(<T>Select dbo.FN_DM0169ValidacionItalika(:tID)<T>, Venta:Venta.ID) = 1) Y (SQL(<T>select Valor from TablaStD where TablaSt = :tTab AND Nombre = :tNom <T>, <T>ITALIKA<T>, <T>ACTIVO<T> ) = 1)<BR>entonces<BR>Ejecutar(<T>PlugIns\italika\Italika.e<CONTINUA>
;Expresion026=<CONTINUA>xe <T>+<T>3<T>+<T> <T>+Vacio(Info.ArtSerie,<T>0<T>)+<T> <T>+Vacio(VentaD:VentaD.Sucursal,<T>0<T>)+<T> <T>+FechaDMA(Vacio(Venta:Venta.FechaEmision,<T>01/01/1999<T>))+<T> <T>+Vacio(Info.SaldoMAVI,<T>0<T>)+<T> <T>+Vacio(Venta:Venta.MovID,<T>0<T>)+<T> <T>+FechaDMA(Vacio(Venta:Venta.FechaEmision,<T>01/01/1999<T>)))<BR>Fin<BR>SI (SQL(<T>Select ISNULL(Valor,0) From TablaStD Where TablaSt=:tA and Nombre=:tB<T>,<T>PRERASTREO COINCIDENCIAS<T>,<T>Prerastreo Ventas<T>)=1)<BR>ENTONCES<BR>    SI (Venta:Venta.Mov en (<T>Solicitud Credito<T>) y (Venta:Venta.Estatus = <T>PENDIENTE<T>)) y<BR>       (SQL(<T>SELECT CATEGORIA FROM VentasCanalMavi WHERE ID=:nId<T>,Venta:Venta.EnviarA)=<T>CREDITO MENUDEO<T>)<BR>    ENTONCES<BR>        SI (SQL(<T>Select ISNULL(Valor,0) From TablaStD Where TablaSt=:tA and Nombre=:<CONTINUA>
;Expresion027=<CONTINUA>tB<T>,<T>PRERASTREO COINCIDENCIAS<T>,<T>Prerastreo Tipo<T>)=<T>Nuevo<T>)<BR>        ENTONCES<BR>            SI (SQL(<T>SELECT MAVITIPOVENTA FROM Venta WHERE ID=:nId<T>,Venta:Venta.Id)=<T>Nuevo<T>)<BR>            ENTONCES<BR>                 EjecutarSQL( <T>EXEC dbo.SP_MAVICoincidenciasNewCola <T> + Comillas(Venta:Venta.Cliente) + <T>,  <T> + Comillas(Usuario))<BR>            FIN<BR>        SINO<BR>            EjecutarSQL( <T>EXEC dbo.SP_MAVICoincidenciasNewCola <T> + Comillas(Venta:Venta.Cliente) + <T>  <T> + Comillas(Usuario))<BR>        FIN<BR>    FIN<BR>FIN<BR>Si((Venta:Venta.Mov en (<T>Analisis Credito<T>) y (Venta:Venta.Estatus = <T>SINAFECTAR<T>)),SQL(<T>EXEC SP_CLONAR_EVENTO_VALERA :nID<T>,Venta:Venta.ID))<BR>Si (((SQL(<T>Select dbo.fnClientesNuevosCasaMAVI(:nId)<T>,Venta:Venta.ID) <CONTINUA>
;Expresion028=<CONTINUA>= <T>Nuevo<T>)o ((SQL(<T>select cOUNT(*) from DM0244_FOLIOS_VALES With(NoLock) where CUENTA = <T> + comillas(Venta:Venta.Cliente) +<T> AND ESTATUS = 1<T>) = 0))) y (SQL(<T>Select count(*) From VentaD with(nolock) Where Articulo like <T> + Comillas(<T>%VALR%<T>) + <T> And ID = <T> + Venta:Venta.ID) = 0) y (Venta:Venta.Mov=<T>Analisis Credito<T>) y (Venta:Venta.Estatus = <T>PENDIENTE<T>) y (Venta:Venta.EnviarA = 76) )<BR> Entonces<BR>    SI(SQL(<T>Select dbo.fn_MaviDM0244ValeAsignado(:nID)<T>,Venta:Venta.ID) =0,Asigna(Info.Acreditado,Venta:Venta.Cliente) Asigna(Info.ID,Venta:Venta.ID) Forma(<T>DM0244NipValesVtaFrm<T>) AbortarOperacion,Falso)<BR> Fin<BR> Si((Venta:Venta.Mov en (<T>Factura<T>,<T>Credilana<T>)) y (Venta:Venta.Estatus=<T>CONCLUIDO<T>) y (Venta:Venta.EnviarA=76),SQL(<T>EXEC SHM_I<CONTINUA>
;Expresion029=<CONTINUA>nsertImporte_Cte :nid , :tCte<T>,Venta:Venta.ID,Venta:Venta.Cliente))<BR> Si (Venta:Venta.Mov en (<T>Devolucion Venta<T>,<T>Devolucion VIU<T>,<T>Cancela Credilana<T>,<T>Cancela Prestamo<T>))<BR> Entonces<BR>   EjecutarSQL(<T>EXEC SPDM0274NotaCgoDevVenta :nId <T>,Venta:Venta.ID)<BR> Fin<BR> Si((Venta:Venta.Mov en (<T>Analisis Credito<T>) y (Venta:Venta.Estatus = <T>PENDIENTE<T>)),EjecutarSQL(<T>EXEC SP_MaviDM0286AgregarEventoAnalisis :nID, :nSuc, :tUs<T>,Venta:Venta.ID, sucursal,usuario))<BR>  EjecutarSQL( <T>EXEC dbo.SP_MaviDM0263ActAgente :tCte, :nId, :nSuc<T>, Venta:Venta.Cliente, Venta:Venta.ID, sucursal )<BR>  SI((Venta:Venta.Mov=<T>Pedido<T>)  y (Venta:Venta.SucursalVenta en (41,90)),Ejecutar(<T>PlugIns\ActualizaEcommers.exe<T>+<T> <T>+<T>VTASPEDIDO<T>+<T> <T>+Venta:Venta.IDEcommerce+<CONTINUA>
;Expresion030=<CONTINUA><T> <T>+<T>PROCESADO<T>))
Expresion=Asigna(Info.CantidadInventario,SQL(<T>Select dbo.fnDM0305validaTelCte(:tCte,:tUsr)<T>,Venta:Venta.Cliente,Usuario))<BR>Si<BR>  (Info.CantidadInventario <> 0 ) y (Venta:Venta.Mov <> <T>Analisis Credito<T>)<BR>Entonces<BR>   Ejecutar(<T>PlugIns\DM0305ValidaTelefono.exe <T>+Venta:Venta.Cliente+<T> <T>+ Usuario+<T> <T>+Info.CantidadInventario)<BR>   AbortarOperacion<BR> Fin<BR><BR>SI  (SQL(<T>Select dbo.fnDM0138validaCte(:tCte,:tUsr)<T>,Venta:Venta.Cliente, Usuario) =<T>SI<T>) y (vacio(Venta:Venta.Origen) o vacio(Venta:Venta.OrigenID)) y (Venta:Venta.Mov noen (<T>Devolucion Venta<T>,<T>Devolucion Mayoreo<T>,<T>Devolucion VIU<T>,<T>Sol Dev Mayoreo<T>,<T>Solicitud Devolucion<T>))<BR> Entonces<BR>      Asigna(Mavi.DM0138Modulo,<T>VTAS<T>)<BR>      Forma(<T>DM0138CapturaCorreo<T>)<BR><BR> Sino<BR>Si<BR>    (Venta:Venta.Mov en (<T>Cancela Credilana<T>,<T>Cancela Prestamo<T>,<T>Cancela Seg Auto<T>,<T>Cancela Seg Vida<T>,<T>Cancelacion Factura<T>,<T>Devolucion Mayoreo<T>,<T>Devolucion Venta<T>,<T>Devolucion VIU<T>,<T>Credilana<T>,<T>Factura<T>,<T>Factura Mayoreo<T>,<T>Factura VIU<T>,<T>Prestamo Personal<T>,<T>Seguro Auto<T>,<T>Seguro Vida<T>)) y ((vacio(Venta:Venta.Origen)) o (vacio(Venta:Venta.OrigenID)))<BR>Entonces                                                                       <BR>  INFORMACION(<T>Movimiento no se puede Afectar<T>)<BR>  AbortarOperacion<BR>Sino<BR>    SI(((Venta:Venta.Estatus <> <T>CONCLUIDO<T>)y (Venta:Venta.Mov en (<T>Factura<T>,<T>Credilana<T>,<T>Factura VIU<T>)) y (Vacio(Venta:Venta.MovID))), (EjecutarSQL( <T>EXEC spConsecutivoGral :nID, :tMod, :bApl<T> ,Venta:Venta.ID, <T>VTAS<T>, 0)))<BR>    Asigna(Info.Modulo, <T>VTAS<T>)<BR>    Asigna(Info.ID, Venta:Venta.ID)<BR>    Asigna(Info.Mov, Venta:Venta.Mov)<BR>    Asigna(Info.MovID, Venta:Venta.MovID)<BR>    Si<BR>      (MovTipoEn(<T>VTAS<T>, Venta:Venta.Mov, (VTAS.P))) y (SQL(<T>Select count(*) from VentaD where ID=:nID<T>,Venta:Venta.ID)>0)<BR>    Entonces<BR>      SI(SQL(<T>spValidarFamilia_MAVI :nIDM<T>, Venta:Venta.ID) = 0,Si(Precaucion(<T>Se Agregaron Codigos Incompatibles<T>, BotonCancelar)=BotonCancelar, AbortarOperacion))<BR>    Fin<BR><BR>    Si<BR>      (MovTipoEn(<T>VTAS<T>, Venta:Venta.Mov, (VTAS.SD, VTAS.B, VTAS.D))) y (SQL(<T>Select count(*) from VentaD where ID=:nID<T>,Venta:Venta.ID)>0)<BR>    Entonces<BR>      SI(SQL(<T>spTipoCondicionMAVI :nID<T>, Venta:Venta.ID) = 0,Si(Precaucion(<T>Se agregaron artículos que provienen de movimientos con condiciones mayores y menores a 12 meses<T>, BotonAceptar)=BotonAceptar, AbortarOperacion, AbortarOperacion))<BR>    Fin<BR><BR>    Si<BR>      (Info.Mov en(<T>Credilana<T>,<T>Factura<T>,<T>Factura VIU<T>,<T>Seguro Auto<T>,<T>Seguro Vida<T>,<T>Prestamo Personal<T>,<T>Cancela Credilana<T>,<T>Cancela Prestamo<T>,<T>Cancela Seg Auto<T>,<T>Cancela Seg Vida<T>,<T>Devolucion Venta<T>,<T>Devolucion VIU<T>)) y (SQL(<T>Select count(*) from VentaD where ID=:nID<T>,Venta:Venta.ID)>0)<BR>    Entonces<BR>      SI(SQL(<T>spValidarFamiliaAlFacturar_MAVI :nIDM, :tMov<T>, Venta:Venta.ID,Info.Mov) = 0,Si(Precaucion(<T>Hay Codigos Incompatibles Con El Movimiento<T>, BotonCancelar)=BotonCancelar, AbortarOperacion))<BR>    Fin<BR><BR>    Si<BR>      Config.VentaActualizarPrecioMoneda y (Venta:Venta.Estatus en (EstatusSinAfectar, EstatusPorConfirmar)) y SQL(<T>spVentaActualizarPreciosChecar :nID<T>, Venta:Venta.ID)<BR>    Entonces<BR>      Caso Confirmacion(<T>¿ Desea Actualizar los Precios Otras Monedas ?<T>, BotonSi, BotonNo, BotonCancelar)<BR>        Es BotonSi Entonces EjecutarSQL(<T>spVentaActualizarPrecios :nID<T>, Venta:Venta.ID) AbortarOperacion<BR>        Es BotonCancelar Entonces AbortarOperacion<BR>      Fin<BR>    Fin<BR><BR>    Si(General.OFER, EjecutarSQL(<T>spOfertaAplicar :nID<T>, Venta:Venta.ID))<BR>    Si<BR>      (Venta:Venta.Mov=Info.MovProcesar) y (Venta:Venta.Estatus=EstatusSinAfectar)<BR>    Entonces<BR>      EjecutarSQL(<T>xpVentaAutoProcesar :nID<T>, Venta:Venta.ID)<BR>    Sino<BR>      Asigna(Afectar.Modulo, <T>VTAS<T>)<BR>      Asigna(Afectar.ID, Venta:Venta.ID)<BR>      Asigna(Afectar.Mov, Venta:Venta.Mov)<BR>      Asigna(Afectar.MovID, Venta:Venta.MovID)<BR>      Asigna(Afectar.FormaCaptura, <T>Venta<T>)<BR>      Asigna(Afectar.EnviarCFD, Falso)<BR>      Asigna(Info.TituloDialogo, Afectar.Mov+<T> <T>+Afectar.MovID)                              <BR>      Asigna(Info.MovTipo, MovTipo(<T>VTAS<T>, Venta:Venta.Mov))<BR>      Asigna(Info.Cliente, Venta:Venta.Cliente)<BR>      Asigna(Info.Moneda, Venta:Venta.Moneda)<BR>      Asigna(Info.TipoCambio, Venta:Venta.TipoCambio)<BR>      Asigna(Info.Importe, Redondea(Suma(VentaD:Importe)+Suma(VentaD:Impuesto)-Suma(VentaD:DescGlobal)+Suma(VentaD:ImporteSobrePrecio)-(Venta:Venta.AnticiposFacturados+Venta:Venta.Retencion), Config.VentaCobroRedondeoDecimales))<BR>      Si<BR>        (Info.Importe<>0) y<BR>        (Venta:Venta.Estatus en (EstatusSinAfectar, EstatusBorrador, EstatusPorConfirmar)) y<BR>        ((MovTipoEn(<T>VTAS<T>, Venta:Venta.Mov, (VTAS.N, VTAS.FM)) y (ConDatos(Venta:Venta.MovID) o Config.VentaLiquidaIntegral) y (Venta:Condicion.ControlAnticipos<><T>Cobrar Pedido<T>)) o<BR>        (MovTipoEn(<T>VTAS<T>, Venta:Venta.Mov, (VTAS.S, VTAS.P, VTAS.VP, VTAS.SD, VTAS.B))  y (Venta:Condicion.ControlAnticipos=<T>Cobrar Pedido<T>)) o<BR>        (MovTipoEn(<T>VTAS<T>, Venta:Venta.Mov, (VTAS.F, VTAS.FAR, VTAS.FB, VTAS.D, VTAS.DF)) y (Venta:Venta.Vencimiento<=Venta:Venta.FechaEmision) y Config.FacturaCobroIntegrado y (Venta:Condicion.ControlAnticipos<><T>Cobrar Pedido<T>) y (Venta:Venta.OrigenTipo<><T>VMOS<T>)))<BR>      Entonces<BR>        Asigna(Info.ID, Venta:Venta.ID)<BR>        Asigna(Info.Cerrado, Falso)<BR>        Asigna(Info.VentaCobroDevolucion, MovTipoEn(<T>VTAS<T>, Venta:Venta.Mov, (VTAS.VP, VTAS.SD, VTAS.B, VTAS.D, VTAS.DF)))<BR>        Forma(<T>VentaCobro<T>)<BR>      Sino<BR>        Si<BR>          (Venta:Venta.Estatus en (EstatusSinAfectar, EstatusBorrador, EstatusPorConfirmar)) o ((MovTipo(<T>VTAS<T>,Venta:Venta.Mov)=VTAS.S) y (Venta:Venta.Estatus=EstatusPorConfirmar))<BR>        Entonces<BR>          Si(Config.CompraVentaSinIVA y (Suma(VentaD:Impuesto)=0.0) y (Suma(VentaD:Importe)>0.0), Si(Confirmacion(<T>Movimiento sin Impuestos<T>+NuevaLinea+<T>¿ Es Correcto ?<T>,BotonSi,BotonNo)=BotonNo,AbortarOperacion))<BR><BR>          Si<BR>            Empresa.CFD y SQL(<T>SELECT CFD FROM MovTipo WHERE Modulo=:tModulo AND Mov=:tMov<T>, Afectar.Modulo, Afectar.Mov)<BR>          Entonces<BR>            EjecutarSQL(<T>spAfectar :tModulo, :nID, :tAccion<T>, Afectar.Modulo, Afectar.ID, <T>CONSECUTIVO<T>)<BR>            Si(no CFD.Generar(Afectar.Modulo, Afectar.ID),  Forma.ActualizarForma AbortarOperacion)<BR>            Asigna(Afectar.EnviarCFD, SQL(<T>SELECT EnviarAlAfectar FROM EmpresaCFD WHERE Empresa=:tEmpresa<T>, Empresa))<BR>          Fin<BR><BR>          Si<BR>            Venta:Venta.Estatus=EstatusPorConfirmar<BR>          Entonces<BR>            Caso MovTipo(<T>VTAS<T>, Venta:Venta.Mov)<BR>              Es VTAS.S  Entonces Dialogo(<T>GenerarServicioPorConfirmar<T>)<BR>              Es VTAS.CS Entonces Dialogo(<T>GenerarCotizacionServicio<T>)<BR>              Es VTAS.C  Entonces<BR>                          Si (Venta:Venta.OrigenTipo=<T>VTAS<T>) y (MovTipo(<T>VTAS<T>, Venta:Venta.Origen)=VTAS.S)<BR>                           Entonces<BR>                             Asigna(Afectar.Mov, Venta:Venta.Origen)<BR>                             Asigna(Afectar.MovID, Venta:Venta.OrigenID)<BR>                             Asigna(Afectar.ID, SQL(<T>SELECT ID FROM Venta WHERE Empresa = :tEmpresa AND Mov = :tMov AND MovID = :tMovID AND Estatus NOT IN (<T>+Comillas(EstatusSinAfectar)+<T>, <T>+Comillas(EstatusCancelado)+<T>)<T>, Empresa, Afectar.Mov, Afectar.MovID))<BR>                             Dialogo(<T>AfectarServicio<T>)<BR>                           Sino<BR>                             Dialogo(<T>GenerarCotizacion<T>)<BR>                         Fin<BR>              Es VTAS.CO Entonces Dialogo(<T>GenerarContrato<T>)<BR>              Sino Afectar(Afectar.Modulo, Afectar.ID, Afectar.Mov, Afectar.MovID, <T>Todo<T>, <T><T>, <T>Venta<T>)<BR>            Fin<BR>          Sino<BR>            Si<BR>              Config.Partidas y (MovTipo(<T>VTAS<T>, Venta:Venta.Mov)=VTAS.R)<BR>            Entonces<BR>              Forma(<T>AfectarPartidasRemision<T>)<BR>            Sino<BR>              Afectar(Afectar.Modulo, Afectar.ID, Afectar.Mov, Afectar.MovID, <T>Todo<T>, <T><T>, <T>Venta<T>)<BR>              SI (Venta:Venta.Mov=<T>Solicitud Credito<T>)y(SQL(<T>SELECT COUNT(ID) FROM dbo.Venta WITH(NOLOCK) WHERE ID=:tId AND Estatus=:tE<T>,Venta:Venta.ID,<T>PENDIENTE<T>)=1)<BR>              ENTONCES<BR>                  SI (SQL(<T>SELECT COUNT(Numero) FROM dbo.TablaNumD WITH(NOLOCK)WHERE TablaNum=:tB AND Numero=:tN<T>,<T>SUCURSALES SHM<T>,Sucursal)=0 ) y ((SQL(<T>Select Count(*) From VentasCanalMAVI Where ID=:nID and Cadena=:tCad<T>,Venta:Venta.EnviarA,<T>VENTA VALE<T>)=0) o (SQL(<T>Select count(*) From VentaD with(nolock) where ID = <T> + Venta:Venta.ID +<T> and Articulo like <T> + Comillas(<T>%VALR%<T>)) > 0))<BR>                  ENTONCES<BR>                      Si((Venta:Venta.Mov=<T>Solicitud Credito<T>),Ejecutar(<T>PlugIns\DM0221LiberadorAuto.exe <T> + Venta:Venta.ID + <T> <T> + Venta:Venta.Usuario,Verdadero))<BR>                  SINO<BR>                     SI<BR>                     (SQL(<T>Select Count(*) From VentasCanalMAVI Where ID=:nID and Cadena=:tCad<T>,Venta:Venta.EnviarA,<T>VENTA VALE<T>)=0) o (SQL(<T>Select count(*) From VentaD with(nolock) where ID = <T> + Venta:Venta.ID +<T> and Articulo like <T> + Comillas(<T>%VALR%<T>)) > 0)<BR>                             Entonces<BR>                             SQL(<T>EXEC dbo.SP_SHM_APARTAMOV :tId,:tSuc<T>,Venta:Venta.ID,Sucursal)<BR>                                SI SQL(<T>SELECT COUNT(Numero) FROM dbo.TablaNumD WHERE TablaNum=:tTab AND CAST(Numero AS INT)=:nSuc<T>, <T>SUCURSALES RDP<T>, Sucursal)=1<BR>                                  Entonces<BR>                                  Asigna(Info.MovID,SQL(<T>SELECT MovID FROM dbo.Venta WITH(NOLOCK) WHERE ID=:tID<T>,Venta:Venta.ID))<BR>                                  Ejecutar(<T>PlugIns\RutaTicket.exe <T>+<T>SHM<T>+<T> <T>+Info.MovID+<T> <T>+Usuario+<T> <T>+Venta:Venta.Cliente+<T> <T>+Sucursal+<T> <T>+EstacionTrabajo)<BR>                                 Sino<BR>                                     Asigna(Info.MovID,SQL(<T>SELECT MovID FROM dbo.Venta WITH(NOLOCK) WHERE ID=:tID<T>,Venta:Venta.ID))<BR>                                     Ejecutar(<T>C:\AppsMavi\SHM\SHM.exe <T>+Usuario+<T> <T>+Sucursal+<T> <T>+Info.MovID+<T> <T>+Venta:Venta.Cliente)<BR>                                 Fin<BR>                            Fin<BR>                            Si (SQL(<T>Select Cadena From VentasCanalMAVI Where ID=:nID<T>,Venta:Venta.EnviarA)=<T>VENTA VALE<T>)) y (SQL(<T>Select count(*) From VentaD with(nolock) where ID = <T> + Venta:Venta.ID +<T> and Articulo like <T> + Comillas(<T>%VALR%<T>)) = 0)<BR><BR>                            Entonces<BR>                            Si ((SQL(<T>Select dbo.fnClientesNuevosCasaMAVI(:nId)<T>,Venta:Venta.ID) = <T>Nuevo<T>) y (SQL(<T>Select count(*) From VentaD with(nolock) Where Articulo like <T> + Comillas(<T>%VALR%<T>) + <T> And ID = <T> + Venta:Venta.ID) = 0) y (Venta:Venta.Mov=<T>Solicitud Credito<T>) y (Venta:Venta.EnviarA = 76) y (SQL(<T>select cOUNT(*) from Venta With(NoLock) where Cliente = <T> + comillas(Venta:Venta.Cliente) +<T> AND ESTATUS = <T>+comillas(<T>Concluido<T>) + <T> and Mov in (<T> + comillas(<T>Factura<T>) +<T>,<T>+comillas(<T>Credilana<T>)+<T>) and EnviarA = 76<T>) = 0) ))<BR>                            Entonces<BR>                              SI<BR>                               SQL(<T>Select Count(*) From MovBitacora with(nolock) where ID = <T>+ Venta:Venta.ID + <T> And Clave in (select valor from SHM_ValorDeEventosValera with(nolock))<T>) =0<BR>                                Entonces<BR>                                        Asigna(Mavi.BanderarFlujo,1)<BR>                                        Asigna(Info.AgenteA,Venta:Venta.Agente)<BR>                                        informacion(<T>Agregar evento para valera<T>)<BR>                                        Forma(<T>MovBitacoraAgregar<T>)<BR>                                    Fin<BR>                                Fin<BR>                                 <BR>                                 SI SQL(<T>SELECT COUNT(Numero) FROM dbo.TablaNumD WHERE TablaNum=:tTab AND CAST(Numero AS INT)=:nSuc<T>, <T>SUCURSALES RDP<T>, Sucursal)=1<BR>                                      Entonces<BR>                                         EjecutarSQL(<T>EXEC SP_DM0244ActualizaSertipoope :nID<T>,Venta:Venta.ID)<BR>                                         Asigna(Info.MovID,SQL(<T>SELECT MovID FROM dbo.Venta WITH(NOLOCK) WHERE ID=:tID<T>,Venta:Venta.ID))<BR>                                         Ejecutar(<T>PlugIns\RutaTicket.exe <T>+<T>SHM3<T>+<T> <T>+Info.MovID+<T> <T>+Usuario+<T> <T>+Venta:Venta.Cliente+<T> <T>+Sucursal+<T> <T>+EstacionTrabajo)<BR>                                      sino<BR>                                         EjecutarSQL(<T>EXEC SP_DM0244ActualizaSertipoope :nID<T>,Venta:Venta.ID)<BR>                                         Asigna(Info.MovID,SQL(<T>SELECT MovID FROM dbo.Venta WITH(NOLOCK) WHERE ID=:tID<T>,Venta:Venta.ID))<BR>                                        Ejecutar(<T>C:\AppsMavi\SHM\SHM.exe <T>+<T>CLIENTEFINAL<T>+<T> <T>+ Usuario+<T> <T>+Info.MovID+<T> <T>+Sucursal)<BR>                                   fin<BR>                         Fin<BR>                  FIN<BR>              SINO<BR>                Verdadero<BR>              FIN<BR>              Forma.ActualizarForma<BR>            Fin<BR>          Fin<BR><BR>          Si(Afectar.EnviarCFD, CFD.Enviar(Afectar.Modulo, Afectar.ID))<BR>        Sino<BR>          Asigna(Info.Modulo, <T>VTAS<T>)<BR>          Asigna(Info.Mov, Venta:Venta.Mov)<BR>          Asigna(Info.MovID, Venta:Venta.MovID)<BR>          Asigna(Afectar.Base, <T>Pendiente<T>)<BR>          Asigna(Afectar.GenerarMov, <T><T>)<BR>          Asigna(Afectar.FormaCaptura, <T>Venta<T>)<BR>          Si<BR>            (ConfigModulo(Info.Modulo, <T>FlujoAbierto<T>) = <T>Si<T>) y (no MovTipoEn(<T>VTAS<T>, Venta:Venta.Mov, (VTAS.F, VTAS.FAR, VTAS.FB)))<BR>          Entonces<BR>            Si<BR>              Forma(<T>GenerarMovFlujo<T>)<BR>            Entonces<BR>              Caso Info.MovGenerar<BR>                Es <T>(Reservar)<T>    Entonces Si(Usuario.Reservar,    Dialogo(<T>Reservar<T>),     Precaucion(<T>No Tiene Acceso<T>))<BR>                Es <T>(Desreservar)<T> Entonces Si(Usuario.Desreservar, Dialogo(<T>DesReservar<T>),  Precaucion(<T>No Tiene Acceso<T>))<BR>                Es <T>(Asignar)<T>     Entonces Si(Usuario.Asignar,     Dialogo(<T>Asignar<T>),      Precaucion(<T>No Tiene Acceso<T>))<BR>                Es <T>(Desasignar)<T>  Entonces Si(Usuario.DesAsignar,  Dialogo(<T>DesAsignar<T>),   Precaucion(<T>No Tiene Acceso<T>))<BR>                Es <T>(Facturacion Rapida)<T>          Entonces ProcesarSQL(<T>spFacturacionRapida :nID, :tUsuario, :tEmpresa<T>,    Afectar.ID, Usuario, Empresa)<BR>                Es <T>(Facturacion Rapida Agrupada)<T> Entonces ProcesarSQL(<T>spFacturacionRapida :nID, :tUsuario, :tEmpresa, 1<T>, Afectar.ID, Usuario, Empresa)<BR>                Es <T>(Generar Orden Transferencia)<T><BR>                 Entonces<BR>                   Si<BR>                     Usuario.PedidoGenerarOT y Dialogo(<T>EstaSeguro<T>)<BR>                   Entonces<BR>                     Si<BR>                       Usuario.PedidoGenerarOTAbrir<BR>                     Entonces<BR>                       FormaPos(<T>Inv<T>, SQLEnLista(<T>spPedidoGenerarOT :tEmpresa, :nID, :nSucursal, :tUsuario, :tMov, @VerID = 1<T>, Empresa, Venta:Venta.ID, Sucursal, Usuario, ConfigMov.InvOrdenTransferencia))<BR>                     Sino<BR>                       ProcesarSQL(<T>spPedidoGenerarOT :tEmpresa, :nID, :nSucursal, :tUsuario, :tMov<T>, Empresa, Venta:Venta.ID, Sucursal, Usuario, ConfigMov.InvOrdenTransferencia)<BR>                     Fin<BR>                   Sino<BR>                     Precaucion(<T>No Tiene Acceso<T>)<BR>                   Fin<BR>                Sino<BR>                  Asigna(Afectar.GenerarMov, Info.MovGenerar)<BR>                  Asigna(Info.TituloDialogo, <T>Generar <T>+Comillas(Info.MovGenerar)+<T> de <T>+Comillas(Info.Mov))<BR>                  SI(Venta:Venta.EnviarA=11,Dialogo(<T>GenerarPedidoPendiente<T>),Generar(Afectar.Modulo, Afectar.ID, Afectar.Mov, Afectar.MovID, <T>Pendiente<T>, Afectar.GenerarMov,Afectar.FormaCaptura))<BR>              Fin<BR>            Fin<BR>          Sino<BR>            Caso MovTipo(<T>VTAS<T>, Venta:Venta.Mov)<BR>              Es VTAS.PR  Entonces Dialogo(<T>GenerarPresupuestoVentas<T>)<BR>              Es VTAS.P   Entonces Dialogo(Info.Dialogo)<BR>              Es VTAS.S   Entonces Dialogo(<T>GenerarServicio<T>) <BR>              Es VTAS.R   Entonces Dialogo(<T>GenerarRemision<T>)<BR>              Es VTAS.VCR Entonces Dialogo(<T>GenerarRemisionConsignacion<T>)<BR>              Es VTAS.VC  Entonces Dialogo(<T>GenerarVentaConsignacion<T>)<BR>              Es VTAS.F   Entonces Dialogo(<T>GenerarFactura<T>)<BR>              Es VTAS.FAR Entonces Dialogo(<T>GenerarFactura<T>)<BR>              Es VTAS.FB  Entonces Dialogo(<T>GenerarFactura<T>)<BR>              Es VTAS.FR  Entonces Dialogo(<T>GenerarFacturaRecurrente<T>)<BR>              Es VTAS.SD  Entonces Dialogo(<T>GenerarSolicitudDevolucion<T>)<BR>            Fin<BR>          Fin<BR>        Fin<BR>      Fin<BR>    Fin<BR>    Si<BR>    Venta:Venta.Mov en (<T>Solicitud Credito<T>,<T>Analisis Credito<T>,<T>Pedido<T>,<T>Factura<T>,<T>Credilana<T>,<T>Seguro Vida<T>,<T>Seguro Auto<T>,<T>Solicitud Mayoreo<T>,<T>Analisis Mayoreo<T>,<T>Pedido Mayoreo<T>,<T>Factura Mayoreo<T>)<BR>    Entonces<BR>    Asigna(Info.Conteo, Info.Conteo+1)<BR>    Sino<BR>    Asigna(Info.Conteo, 0)<BR>    Fin<BR>           <BR>    Asigna(Mavi.MonederoRedimeMensaje,SQL(<T>EXEC dbo.SP_MensajeDevMonedero :tFac,:tFacId,:nOp<T>,Venta:Venta.Mov,Venta:Venta.ID,3))<BR>    SI ConDatos(Mavi.MonederoRedimeMensaje)<BR>    ENTONCES<BR>        Precaucion(Mavi.MonederoRedimeMensaje)<BR>    SINO<BR>        1=1<BR>    FIN<BR>Fin<BR>FIN<BR>si(SQL(<T>Select Count(*) From VentasCanalMAVI Where ID=:nID and cadena=:tCad<T>,Venta:Venta.EnviarA,<T>VENTA VALE<T>)> 0, EjecutarSQL(<T>SP_DM0244NipValesVta :tid, :tvale, :testatus<T>, Venta:Venta.ID, Mavi.DM0244Vale, <T>afectar<T>),Falso)<BR><BR>SI<BR>   (Venta:Venta.Mov en (<T>Solicitud Credito<T>,<T>Analisis Credito<T>,<T>Pedido<T>,<T>Factura VIU<T>,<T>Credilana<T>, <T>Prestamo Personal<T>, <T>Seguro Vida<T>, <T>Factura<T>) y (Venta:Venta.Estatus <> <T>CANCELADO<T>)) y (SQL(<T>SELECT CATEGORIA FROM VentasCanalMavi WHERE ID=:nId<T>,Venta:Venta.EnviarA)=<T>CREDITO MENUDEO<T>)<BR>ENTONCES<BR>    EjecutarSQL(<T>SP_DM0169AcutalizaBanderaVenta <T>+comillas(Venta:Venta.Cliente)+<T>, <T>+comillas(Venta:Venta.Mov)+<T>, <T>+comillas(Venta:Venta.MovID)+<T>, 1<T>))<BR>FIN<BR>Si (Venta:Venta.Mov = <T>Solicitud Credito<T>)<BR>Entonces<BR>     EjecutarSQL( <T>EXEC dbo.SP_DM0257ListaNegra <T> + Comillas(Venta:Venta.Cliente) + <T>, <T> + Comillas(Usuario) + <T>, <T> + Comillas(Sucursal) + <T>, <T> + Comillas(Venta:Venta.ID)+ <T>, <T>+ Comillas(Venta:Venta.MovID))<BR>Fin<BR>SI(Venta:Venta.Mov=<T>Pedido<T>,EjecutarSql(<T>EXEC SP_DM0270ConsecPedido :nID<T>,Venta:Venta.ID)ActualizarVista)<BR>ASIGNA(Info.ArtSerie,SQL(<T>select propiedades from SerieLoteMov where modulo = :tMod AND id = :tId <T>,<T>VTAS<T>,Venta:Venta.ID) )<BR>ASIGNA(Info.SaldoMAVI,SQL(<T>SELECT dbo.FN_DM0169PrecioContadoItalika(:nID)<T>,Venta:Venta.ID))*Si (SQL(<T>Select dbo.FN_DM0169ValidacionItalika(:tID)<T>, Venta:Venta.ID) = 1) Y (SQL(<T>select Valor from TablaStD where TablaSt = :tTab AND Nombre = :tNom <T>, <T>ITALIKA<T>, <T>ACTIVO<T> ) = 1)<BR>entonces<BR>Ejecutar(<T>PlugIns\italika\Italika.exe <T>+<T>3<T>+<T> <T>+Vacio(Info.ArtSerie,<T>0<T>)+<T> <T>+Vacio(VentaD:VentaD.Sucursal,<T>0<T>)+<T> <T>+FechaDMA(Vacio(Venta:Venta.FechaEmision,<T>01/01/1999<T>))+<T> <T>+Vacio(Info.SaldoMAVI,<T>0<T>)+<T> <T>+Vacio(Venta:Venta.MovID,<T>0<T>)+<T> <T>+FechaDMA(Vacio(Venta:Venta.FechaEmision,<T>01/01/1999<T>)))<BR>Fin<BR>SI (SQL(<T>Select ISNULL(Valor,0) From TablaStD Where TablaSt=:tA and Nombre=:tB<T>,<T>PRERASTREO COINCIDENCIAS<T>,<T>Prerastreo Ventas<T>)=1)<BR>ENTONCES<BR>    SI (Venta:Venta.Mov en (<T>Solicitud Credito<T>) y (Venta:Venta.Estatus = <T>PENDIENTE<T>)) y<BR>       (SQL(<T>SELECT CATEGORIA FROM VentasCanalMavi WHERE ID=:nId<T>,Venta:Venta.EnviarA)=<T>CREDITO MENUDEO<T>)<BR>    ENTONCES<BR>        SI (SQL(<T>Select ISNULL(Valor,0) From TablaStD Where TablaSt=:tA and Nombre=:tB<T>,<T>PRERASTREO COINCIDENCIAS<T>,<T>Prerastreo Tipo<T>)=<T>Nuevo<T>)<BR>        ENTONCES<BR>            SI (SQL(<T>SELECT MAVITIPOVENTA FROM Venta WHERE ID=:nId<T>,Venta:Venta.Id)=<T>Nuevo<T>)<BR>            ENTONCES<BR>                 EjecutarSQL( <T>EXEC dbo.SP_MAVICoincidenciasNewCola <T> + Comillas(Venta:Venta.Cliente) + <T>,  <T> + Comillas(Usuario))<BR>            FIN<BR>        SINO<BR>            EjecutarSQL( <T>EXEC dbo.SP_MAVICoincidenciasNewCola <T> + Comillas(Venta:Venta.Cliente) + <T>  <T> + Comillas(Usuario))<BR>        FIN<BR>    FIN<BR>FIN<BR>Si((Venta:Venta.Mov en (<T>Analisis Credito<T>) y (Venta:Venta.Estatus = <T>SINAFECTAR<T>)),SQL(<T>EXEC SP_CLONAR_EVENTO_VALERA :nID<T>,Venta:Venta.ID))<BR>Si (((SQL(<T>Select dbo.fnClientesNuevosCasaMAVI(:nId)<T>,Venta:Venta.ID) = <T>Nuevo<T>)o ((SQL(<T>select cOUNT(*) from DM0244_FOLIOS_VALES With(NoLock) where CUENTA = <T> + comillas(Venta:Venta.Cliente) +<T> AND ESTATUS = 1<T>) = 0))) y (SQL(<T>Select count(*) From VentaD with(nolock) Where Articulo like <T> + Comillas(<T>%VALR%<T>) + <T> And ID = <T> + Venta:Venta.ID) = 0) y (Venta:Venta.Mov=<T>Analisis Credito<T>) y (Venta:Venta.Estatus = <T>PENDIENTE<T>) y (Venta:Venta.EnviarA = 76) )<BR> Entonces<BR>    SI(SQL(<T>Select dbo.fn_MaviDM0244ValeAsignado(:nID)<T>,Venta:Venta.ID) =0,Asigna(Info.Acreditado,Venta:Venta.Cliente) Asigna(Info.ID,Venta:Venta.ID) Forma(<T>DM0244NipValesVtaFrm<T>) AbortarOperacion,Falso)<BR> Fin<BR> Si((Venta:Venta.Mov en (<T>Factura<T>,<T>Credilana<T>)) y (Venta:Venta.Estatus=<T>CONCLUIDO<T>) y (Venta:Venta.EnviarA=76),SQL(<T>EXEC SHM_InsertImporte_Cte :nid , :tCte<T>,Venta:Venta.ID,Venta:Venta.Cliente))<BR> Si (Venta:Venta.Mov en (<T>Devolucion Venta<T>,<T>Devolucion VIU<T>,<T>Cancela Credilana<T>,<T>Cancela Prestamo<T>))<BR> Entonces<BR>   EjecutarSQL(<T>EXEC SPDM0274NotaCgoDevVenta :nId <T>,Venta:Venta.ID)<BR> Fin<BR> Si((Venta:Venta.Mov en (<T>Analisis Credito<T>) y (Venta:Venta.Estatus = <T>PENDIENTE<T>)),EjecutarSQL(<T>EXEC SP_MaviDM0286AgregarEventoAnalisis :nID, :nSuc, :tUs<T>,Venta:Venta.ID, sucursal,usuario))<BR>  EjecutarSQL( <T>EXEC dbo.SP_MaviDM0263ActAgente :tCte, :nId, :nSuc<T>, Venta:Venta.Cliente, Venta:Venta.ID, sucursal )<BR>  SI((Venta:Venta.Mov=<T>Pedido<T>)  y (Venta:Venta.SucursalVenta en (41,90)),Ejecutar(<T>PlugIns\ActualizaEcommers.exe<T>+<T> <T>+<T>VTASPEDIDO<T>+<T> <T>+Venta:Venta.IDEcommerce+<T> <T>+<T>PROCESADO<T>))<BR>si Venta:Venta.Mov en (<T>Devolucion Venta<T>,<T>Devolucion VIU<T>,<T>Devolucion Mayoreo<T>)<BR>Entonces<BR>    EjecutarSQL(<T>EXEC dbo.SP_RM1161AfectacionRepServicio :nID,:nIDSoporte,:nOpc<T>,Venta:Venta.ID,Venta:Venta.Sucursal,3)<BR>Fin<BR>Si (Venta:Venta.Mov en (<T>Factura<T>, <T>Credilana<T>, <T>Devolucion Venta<T>)) y (Venta:Venta.EnviarA = 76)<BR>Entonces<BR>    EjecutarSQL(<T>EXEC SpIDM0264_CalcMonederoDima :nID<T>,Venta:Venta.ID)<BR>Fin<BR>Si (Venta:Venta.Mov en (<T>Cancelacion Factura<T>, <T>Cancela Credilana<T>)) Y (Venta:Venta.EnviarA = 76)<BR>Entonces<BR>    EjecutarSQL(<T>EXEC SpIDM0264_DevMonederoDima :nID<T>,Venta:Venta.ID)<BR>Fin

AntesExpresiones=Si ((SQL(<T>Select dbo.fnClientesNuevosCasaMAVI(:nId)<T>,Venta:Venta.ID) = <T>Nuevo<T>) y (SQL(<T>EXEC SHM_Valida_Analisis :nId<T>,Venta:Venta.ID) = 0)  y (SQL(<T>Select count(*) From VentaD with(nolock) Where Articulo like <T> + Comillas(<T>%VALR%<T>) + <T> And ID = <T> + Venta:Venta.ID) = 0) y (Venta:Venta.Mov=<T>Analisis Credito<T>) y (Venta:Venta.Estatus = <T>PENDIENTE<T>) y (Venta:Venta.EnviarA = 76))<BR> Entonces<BR>    SI<BR>        SQL(<T>select count(*) from MovBitacora with(nolock) where ID = <T> + Venta:Venta.ID + <T> and Clave in (select Evento from SHM_ValorDeEventosValera with(nolock))<T>) = 0<BR>    Entonces<BR>        informacion(<T>No cuenta con el evento solicitud valera<T>)<BR>        AbortarOperacion<BR>    sino<BR>        si<BR>          SQL(<T>select count(*) from DM0244_FOLIOS_VALES With(NoLock) where IDSOLVTAVAL = :nId<T>,Venta:Venta.ID) = 0<BR>        entonces<BR>            informacion(<T>favor de imprimir valera y capturar el primer vale por concepto de este movimiento<T>)<BR>            SI(SQL(<T>Select dbo.fn_MaviDM0244ValeAsignado(:nID)<T>,Venta:Venta.ID) =0,Asigna(Info.Acreditado,Venta:Venta.Cliente) Asigna(Info.ID,Venta:Venta.ID) Forma(<T>DM0244NipValesVtaFrm<T>) AbortarOperacion,Falso)<BR>        fin<BR>    fin<BR> Fin<BR>Si<BR>  ((Venta:Venta.Mov en (<T>Credilana<T>,<T>Prestamo Personal<T>)) y (Venta:Venta.Estatus=EstatusSinAfectar)y (SQL(<T>select count(*) from Venta with(nolock) where ISNULL(Liberado,0) = 1 and ID = <T>+ Venta:Venta.ID )=0) y (Venta:Venta.Almacen <> <T>V00039<T>))<BR>Entonces<BR>  SI SQL(<T>SELECT COUNT(Numero) FROM dbo.TablaNumD WHERE TablaNum=:tTab AND CAST(Numero AS INT)=:nSuc<T>, <T>SUCURSALES RDP<T>, Sucursal)=1<BR>  Entonces<BR>     Ejecutar(<T>PlugIns\RutaTicket.exe <T>+<T>SHM8<T>+<T> <T>+Usuario+<T> <T>+Venta:Venta.ID+<T> <T>+Venta:Venta.Cliente+<T> <T>+Sucursal+<T> <T>+EstacionTrabajo)<BR>     AbortarOperacion<BR>  Sino<BR>      Ejecutar(<T>C:\AppsMavi\SHM\SHM.exe MACH <T>+Venta:Venta.ID+<T> <T>+Venta:Venta.Cliente)<BR>      AbortarOperacion<BR>  Fin<BR>Fin<BR>GuardarCambios<BR>Asigna(Info.IDMAVI,Venta:Venta.ID) Asigna(Info.UEN,Venta:Venta.UEN) Asigna(Info.Mov,Venta:Venta.Mov) Asigna(Info.Mensaje,SQL(<T>EXEC dbo.SP_MAVIDM0173RedimeOGeneraMONE :nId<T>,Info.IDMAVI))<BR>Si(Vacio(Info.Mensaje,<T><T>)<><T><T>,Informacion(Info.Mensaje),Verdadero)<BR>Si(ConDatos(Venta:Venta.Condicion),Asigna(Info.Mov,Venta:Venta.Mov),Si(Precaucion(<T>No se ha especificado la condición de pago<T>, BotonCancelar)=BotonCancelar, AbortarOperacion))<BR>Si(Info.Mov=<T>Factura<T>,Si(ConDatos(Venta:Venta.OrigenID),Asigna(Info.Mov,Venta:Venta.Mov),Si(Precaucion(<T>No se pueden realizar facturas directas<T>, BotonCancelar)=BotonCancelar, AbortarOperacion)))<BR>Si(Info.Mov=<T>Factura<T>,Si(Info.UEN<>1,Si(Precaucion(<T>La UEN no corresponde con el movimiento<T>, BotonCancelar)=BotonCancelar, AbortarOperacion)))<BR>Si(Info.Mov=<T>Credilana<T>,Si(ConDatos(Venta:Venta.OrigenID),Asigna(Info.Mov,Venta:Venta.Mov), Si(Precaucion(<T>No se pueden realizar este movimiento directo<T>, BotonCancelar)=BotonCancelar, AbortarOperacion)))<BR>Si(Info.Mov=<T>Credilana<T>,Si(Info.UEN<>1,Si(Precaucion(<T>La UEN no corresponde con el movimiento<T>, BotonCancelar)=BotonCancelar, AbortarOperacion)))<BR>Si(Info.Mov=<T>Factura VIU<T>,Si(ConDatos(Venta:Venta.OrigenID),Asigna(Info.Mov,Venta:Venta.Mov),Si(Precaucion(<T>No se pueden realizar facturas VIU directas<T>, BotonCancelar)=BotonCancelar, AbortarOperacion)))<BR>Si(Info.Mov=<T>Factura VIU<T>,Si(Info.UEN<>2,Si(Precaucion(<T>La UEN no corresponde con el movimiento<T>, BotonCancelar)=BotonCancelar, AbortarOperacion)))<BR>Si(Info.Mov=<T>Prestamo Personal<T>,Si(ConDatos(Venta:Venta.OrigenID),Asigna(Info.Mov,Venta:Venta.Mov),Si(Precaucion(<T>No se pueden realizar prestamos personales directos<T>, BotonCancelar)=BotonCancelar, AbortarOperacion)))<BR>Si(Info.Mov=<T>Prestamo Personal<T>,Si(Info.UEN<>2,Si(Precaucion(<T>La UEN no corresponde con el movimiento<T>, BotonCancelar)=BotonCancelar, AbortarOperacion)))<BR>Si(Info.Mov=<T>Seguro Vida<T>,Si(ConDatos(Venta:Venta.OrigenID),Asigna(Info.Mov,Venta:Venta.Mov),Si(Precaucion(<T>No se pueden realizar seguros de vida directos<T>, BotonCancelar)=BotonCancelar, AbortarOperacion)))<BR>Si Info.Mov=<T>Seguro Vida<T> Entonces<BR>  Caso Info.UEN<BR>    Es 1 Entonces Asigna(Info.Mov,Venta:Venta.Mov) Es 2 Entonces Asigna(Info.Mov,Venta:Venta.Mov) Sino Si(Precaucion(<T>La UEN no corresponde con el movimiento<T>, BotonCancelar)=BotonCancelar, AbortarOperacion)<BR>  Fin<BR>Fin<BR>Si(Info.Mov=<T>Seguro Auto<T>,Si(ConDatos(Venta:Venta.OrigenID),Asigna(Info.Mov,Venta:Venta.Mov),Si(Precaucion(<T>No se pueden realizar seguros de auto directos<T>, BotonCancelar)=BotonCancelar, AbortarOperacion)))<BR>Si Info.Mov=<T>Seguro Auto<T> Entonces<BR>  Caso Info.UEN<BR>    Es 1 Entonces Asigna(Info.Mov,Venta:Venta.Mov) Es 2 Entonces Asigna(Info.Mov,Venta:Venta.Mov) Sino Si(Precaucion(<T>La UEN no corresponde con el movimiento<T>, BotonCancelar)=BotonCancelar, AbortarOperacion)<BR>  Fin<BR>Fin<BR>Si(Info.Mov=<T>Analisis Credito<T>,Si(ConDatos(Venta:Venta.OrigenID),Asigna(Info.Mov,Venta:Venta.Mov),Si(Precaucion(<T>No se pueden realizar análisis de crédito directos<T>, BotonCancelar)=BotonCancelar, AbortarOperacion)))<BR>Si(Info.Mov=<T>Pedido<T>,Si(ConDatos(Venta:Venta.OrigenID),Asigna(Info.Mov,Venta:Venta.Mov),Si(SQL(<T>Select TipoCondicion from Condicion where condicion=:tcon<T>,Venta:Venta.Condicion)=<T>Contado<T>, Asigna(Info.Mov,Venta:Venta.Mov),Si(Precaucion(<T>No se pueden realizar pedidos directos si la condición de pago es a crédito<T>, BotonCancelar)=BotonCancelar, AbortarOperacion)))))<BR>Si(Info.Mov=<T>Analisis Mayoreo<T>,Si(ConDatos(Venta:Venta.OrigenID),Asigna(Info.Mov,Venta:Venta.Mov),Si(Precaucion(<T>No se pueden realizar análisis mayoreo directos<T>, BotonCancelar)=BotonCancelar, AbortarOperacion)))<BR>/*Si(Info.Mov=<T>Pedido Mayoreo<T>,Si(ConDatos(Venta:Venta.OrigenID),Asigna(Info.Mov,Venta:Venta.Mov),Si(Precaucion(<T>No se pueden realizar pedido de mayoreo directos<T>, BotonCancelar)=BotonCancelar, AbortarOperacion)))*/<BR>Si(Info.Mov=<T>Factura Mayoreo<T>,Si(ConDatos(Venta:Venta.OrigenID),Asigna(Info.Mov,Venta:Venta.Mov),Si(Precaucion(<T>No se pueden realizar facturas mayoreo directas<T>, BotonCancelar)=BotonCancelar, AbortarOperacion)))<BR>Si(Info.Mov=<T>Devolucion Venta<T>,Si(ConDatos(Venta:Venta.OrigenID),Asigna(Info.Mov,Venta:Venta.Mov),Si(Precaucion(<T>No se pueden realizar devolucines de venta directas<T>, BotonCancelar)=BotonCancelar, AbortarOperacion)))<BR>Si(Info.Mov=<T>Devolucion VIU<T>,Si(ConDatos(Venta:Venta.OrigenID),Asigna(Info.Mov,Venta:Venta.Mov),Si(Precaucion(<T>No se pueden realizar devoluciones VIU directas<T>, BotonCancelar)=BotonCancelar, AbortarOperacion)))<BR>Si(Info.Mov=<T>Devolucion Mayoreo<T>,Si(ConDatos(Venta:Venta.OrigenID),Asigna(Info.Mov,Venta:Venta.Mov),Si(Precaucion(<T>No se pueden realizar devoluciones de mayoreo directas<T>, BotonCancelar)=BotonCancelar, AbortarOperacion)))<BR>Asigna(Info.MovProcesar, ConfigMov.AutoRecaudacion)<BR>Si(General.AdvertirProyectosExpirados, Si(SQL(<T>SELECT COUNT(*) FROM Proy WHERE (Estatus = :tBaja OR FechaFin+1<GETDATE()) AND Proyecto=:tProy<T>, EstatusBaja, Venta:Venta.Proyecto) > 0, Si(Precaucion(<T>Proyecto Expirado<T>, BotonAceptar, BotonCancelar)=BotonCancelar, AbortarOperacion)))<BR>Si<BR>  (MovTipo(<T>VTAS<T>, Venta:Venta.Mov)=VTAS.P) Entonces<BR>  Si<BR>    General.Autotransportes  Entonces<BR>    Caso Venta:Venta.Mov<BR>      Es ConfigMov.AutoPapeleta Entonces Asigna(Info.Dialogo, <T>GenerarAutoPapeleta<T>) Es <T>Orden Mantenimiento<T>  Entonces Asigna(Info.Dialogo, <T>GenerarAutoOrdenMantenimiento<T>) Es <T>Orden Reparacion Int<T> Entonces Asigna(Info.Dialogo, <T>GenerarAutoOrdenReparacionInt<T>) Es <T>Orden Reparacion Ext<T> Entonces Asigna(Info.Dialogo, <T>GenerarAutoOrdenReparacionExt<T>) Es <T>Orden Reparacion Ter<T> Entonces Asigna(Info.Dialogo, <T>GenerarAutoOrdenReparacionTer<T>)<BR>    Sino<BR>      Asigna(Info.Dialogo, <T>GenerarPedido<T>)<BR>    Fin Sino<BR>    Caso Venta:Venta.Mov<BR>      Es ConfigMov.VentaReservacion Entonces Asigna(Info.Dialogo, <T>GenerarReservacion<T>) Es ConfigMov.VentaIngreso Entonces Asigna(Info.Dialogo, <T>GenerarVentaIngreso<T>)<BR>    Sino<BR>      Asigna(Info.Dialogo, <T>GenerarPedido<T>)<BR>    Fin<BR>  Fin<BR>Fin<BR>Si<BR>  General.CamposExtras=<T>Campos Extras<T> y (Venta:Venta.Estatus en (EstatusSinAfectar, EstatusPorConfirmar, EstatusBorrador)) y SQL(<T>SELECT CEAntesAfectar FROM MovTipo WHERE Modulo=:tModulo AND Mov=:tMov AND CE=1<T>, <T>VTAS<T>, Venta:Venta.Mov)<BR>Entonces<BR>  Si(no CamposExtrasMovimiento(<T>VTAS<T>, Venta:Venta.Mov, Venta:Venta.ID, Verdadero, Venta:Venta.Estatus noen (EstatusSinAfectar, EstatusPorConfirmar, EstatusBorrador)), AbortarOperacion)<BR>Fin<BR>Si(Info.Mov=<T>Devolucion VIU<T>,Si(Info.UEN<>2,Si(Precaucion(<T>La UEN no corresponde con el movimiento<T>, BotonCancelar)=BotonCancelar, AbortarOperacion)))<BR>Si(Info.Mov=<T>Devolucion Venta<T>,Si(Info.UEN<>1,Si(Precaucion(<T>La UEN no corresponde con el movimiento<T>, BotonCancelar)=BotonCancelar, AbortarOperacion)))<BR>Si(Info.Mov=<T>Devolucion Mayoreo<T>,Si(Info.UEN<>3,Si(Precaucion(<T>La UEN no corresponde con el movimiento<T>, BotonCancelar)=BotonCancelar, AbortarOperacion)))<BR>Si(Info.Mov=<T>Cancela Prestamo<T>,Si(Info.UEN<>2,Si(Precaucion(<T>La UEN no corresponde con el movimiento<T>, BotonCancelar)=BotonCancelar, AbortarOperacion)))<BR>Si(Info.Mov=<T>Cancela Credilana<T>,Si(Info.UEN<>1,Si(Precaucion(<T>La UEN no corresponde con el movimiento<T>, BotonCancelar)=BotonCancelar, AbortarOperacion)))<BR> Si SQL(<T>EXEC xpVerificarMovMonederoMAVI :nID<T>, Venta:Venta.ID) Entonces<BR>      Si SQL(<T>EXEC xpVerificarRedimeMAVI :nID<T>, Venta:Venta.ID) Entonces<BR>          Si<BR>              (SQL(<T>EXEC xpVerificarRedimeMAVI :nID<T>, Venta:Venta.ID)) y (SQL(<T>SELECT COUNT(*) FROM TarjetaMonederoMAVI WITH(NOLOCK) WHERE estatus = :tEst AND TipoMonedero = :tTip AND Cliente = :tCte <T>,<T>ACTIVA<T>,<T>VIRTUAL<T>,Venta:Venta.Cliente) > 0) y (SQL(<T>SELECT COUNT(*) FROM SHM_MonVirtual_RegistraRedencion WITH(NOLOCK) WHERE IDSol = :nId<T>,Venta:Venta.ID) = 0)<BR>          Entonces<BR>                  Asigna(Info.ID, Venta:Venta.ID) Asigna(Info.Importe, SQL(<T>SELECT SUM(ISNULL(ImporteTotal,0.0)) FROM VentaTCalc WHERE ID = :nID<T>, Venta:Venta.ID)) Asigna(Info.UEN, Venta:Venta.UEN)<BR>                      Si  Venta:Venta.EnviarA <> 76)<BR>                      Entonces<BR>                          Forma(<T>TipoMonederoDIMAfrm<T>)<BR>                      Sino         <BR>                          Forma(<T>DM0169MonederoVirtualClonFrm<T>)<BR>                      Fin<BR>                  AbortarOperacion<BR>          Sino<BR>              Si (SQL(<T>SELECT COUNT(*) FROM SHM_MonVirtual_RegistraRedencion WITH(NOLOCK) WHERE IDSol = :nId<T>,Venta:Venta.ID) = 0)<BR>              Entonces<BR>                  Asigna(Info.ID, Venta:Venta.ID) Asigna(Info.Importe, SQL(<T>SELECT SUM(ISNULL(ImporteTotal,0.0)) FROM VentaTCalc WHERE ID = :nID<T>, Venta:Venta.ID)) Asigna(Info.UEN, Venta:Venta.UEN) Forma(<T>TarjetaSerieMovMAVIRedimir<T>)<BR>              Fin<BR>          Fin<BR>      Sino<BR>          Asigna(Info.ID, Venta:Venta.ID) Asigna(Info.Importe, SQL(<T>SELECT SUM(ISNULL(ImporteTotal,0.0)) FROM VentaTCalc WHERE ID = :nID<T>, Venta:Venta.ID)) Asigna(Info.UEN, Venta:Venta.UEN) Forma(<T>TarjetaSerieMovMAVIAplicar<T>)<BR>      Fin<BR>  Fin<BR>SI((SQL(<T>Select dbo.fn_MaviDM0169GarantiaDetalle(:tmov,:nId)<T>,Venta:Venta.Mov,Venta:Venta.ID) = 0) ,EjecutarSQL(<T>EXEC SP_DM0169GarantiasVenta :nID,:nSuc,:tAlm<T>,Venta:Venta.ID,Venta:Venta.Sucursal,Venta:Venta.Almacen) ActualizarForma Informacion(<T>Ofrecer garantias Ampliadas, si no las requiere Favor de Borrarlas<T>) AbortarOperacion,<T><T>)<BR>SI SQL(<T>Select dbo.fn_MaviDM0169CampoExtraActivo(:tUsr,:nID)<T>, Usuario,Venta:Venta.ID) >= 1 Entonces<BR> Si General.CamposExtras=<T>Campos Extras<T> Entonces<BR>  Asigna(Temp.Reg, SQL(<T>spMostrarCamposExtra :tMov, :nID, :tEst, :tUs<T>,Venta:Venta.Mov,Venta:Venta.ID,Venta:Venta.Estatus, Izquierda(Usuario.Usuario,5) )) Asigna(Info.Mov, Temp.Reg[1]) Asigna(Info.ID, Temp.Reg[2]) Asigna(Info.Nombre,Temp.Reg[3])<BR>  CamposExtrasMovimiento(<T>VTAS<T>,Info.Mov, Info.ID, Falso,Info.Nombre noen (EstatusSinAfectar, EstatusPorConfirmar, EstatusBorrador))<BR>  EJECUTARSQL(<T>EXEC SP_DM0169VentaCamposExtra :nOp,:tCl,:nID,:nSu,:tUs<T>,1,Venta:Venta.Cliente,Venta:Venta.ID,nulo,nulo) Asigna(Info.Respuesta4,<T>lol<T>) AbortarOperacion Fin<BR>  Sino Verdadero Fin<BR> SINO SI ((Info.Respuesta4 = <T><T>) y (Venta:Venta.Mov=<T>Solicitud Credito<T>) y (Venta:Venta.Estatus=EstatusSinAfectar) y (SQL(<T>select dbo.fnClientesNuevosCasaMAVI (:nID)<T>,Venta:Venta.ID)=<T>Casa<T>)) ENTONCES Informacion(<T>Campos extra no requeridos, para agregarlos vaya a la opción de captura.<T>) Asigna(Info.Respuesta4,<T>lol<T>) EJECUTARSQL(<T>EXEC SP_DM0169VentaCamposExtra :nOp,:tCl,:nID,:nSu,:tUs<T>,2,Venta:Venta.Cliente,Venta:Venta.ID,Venta:Venta.Sucursal, Usuario ) FIN  Verdadero FIN<BR>Si (((SQL(<T>Select dbo.fnClientesNuevosCasaMAVI(:nId)<T>,Venta:Venta.ID) = <T>Casa<T>) o (SQL(<T>select cOUNT(*) from DM0244_FOLIOS_VALES With(NoLock) where CUENTA = <T> + comillas(Venta:Venta.Cliente) +<T> AND ESTATUS = 1<T>) > 0)) y (SQL(<T>Select count(*) From VentaD with(nolock) Where Articulo like <T> + Comillas(<T>%VALR%<T>) + <T> And ID = <T> + Venta:Venta.ID) = 0) y (Venta:Venta.Mov=<T>Solicitud Credito<T>) y (Venta:Venta.EnviarA = 76) )<BR> Entonces<BR>    SI<BR>        SQL(<T>Select dbo.fn_MaviDM0244ValeAsignado(:nID)<T>,Venta:Venta.ID) =0<BR>    Entonces<BR>        Asigna(Info.Acreditado,Venta:Venta.Cliente)<BR>        Asigna(Info.ID,Venta:Venta.ID)<BR>        Forma(<T>DM0244NipValesVtaFrm<T>)<BR>        AbortarOperacion<BR>    sino<BR>        Falso<BR>    fin<BR> Fin<BR> SI((SQL(<T>select SUBSTRING(Nombre,1,14) from Sucursal Where Sucursal=:nSuc<T>, Sucursal )=<T>VENTA EN LINEA<T>) y (Venta:Venta.EnviarA en (2,6)),Si(ConDatos(Venta:Venta.ReferenciaOrdenCompra),Verdadero,Error(<T>El campo pedido ecommerce es Obligarorio<T>) Abortaroperacion),Verdadero)<BR> SI(SQL(<T>Select dbo.FN_DM0292ValidaAplica(:nID)<T>,Venta:Venta.ID)=1,Asigna(Info.Respuesta,SQL(<T>EXEC SP_DM0292ValidaArtsQ :nID<T>,Venta:Venta.ID)) SI(Info.Respuesta=<T>Candidato para oferta articulos Q<T>, SI(Confirmacion(<T>Candidato para promocion de Calzado Q ¿Seguro que desea avanzar?<T>, BotonAceptar, BotonCancelar)=BotonAceptar, AbortarOperacion),Informacion(Info.Respuesta)))<BR>SI(SQL(<T>Select dbo.fn_DM0297CandadoArtSegu(:nID)<T>,Venta:Venta.ID) = 1,Verdadero,Informacion(<T>Debe ingresar el Telefono en los Datos de Entrega<T>) Abortaroperacion)

;EjecucionCondicion=SI ConDatos(Venta:Venta.Mov) y ConDatos(Venta:Venta.Almacen)<BR>ENTONCES<BR>    SI SQL(<T>EXEC dbo.SP_MAVIDM0138ValidaCorreo  :tCte, :tMov, :tEst<T>,Venta:Venta.Cliente,Venta:Venta.Mov,Venta:Venta.Estatus) = <T>1<T><BR>    ENTONCES<BR>        1=1<BR>    SINO<BR>        1=0<BR>        Asigna(Info.Cliente,Venta:Venta.Cliente)<BR>        Forma(<T>DM0138CapturaCorreo<T>)<BR>        Error(<T>Capture un Correo Valido en menu Otros <T>+Comillas(<T>Capturar Correo<T>))<BR>    FIN<BR>SINO<BR>    1=0<BR>FIN
;EjecucionCondicion=GuardarCambios            <BR>SI ConDatos(Venta:Venta.Mov) y ConDatos(Venta:Venta.Almacen)<BR>ENTONCES<BR>    SI SQL(<T>EXEC dbo.SP_MAVIDM0138ValidaCorreo  :tCte, :tMov, :tEst<T>,Venta:Venta.Cliente,Venta:Venta.Mov,Venta:Venta.Estatus) = <T>1<T><BR>    ENTONCES<BR>        SI SQL(<T>EXEC dbo.SP_MAVIDM0197DEVMenosVTA :nID<T>,Venta:Venta.ID)=<T>0<T><BR>        ENTONCES<BR>            1=1<BR>        SINO<BR>            1=0<BR>            Error(<T>La Devolucion debe contener el total de Articulos Vendidos<T>)<BR>        FIN<BR>    SINO<BR>        1=0<BR>        Asigna(Info.Cliente,Venta:Venta.Cliente)<BR>        Forma(<T>DM0138CapturaCorreo<T>)<BR>        Error(<T>Capture un Correo Valido en menu Otros <T>+Comillas(<T>Capturar Correo<T>))<BR>    FIN<BR>SINO<BR>    1=0<BR>FIN
;****************** Modificada Por: Noe de Jesus Ibarra Cardona, Se modifico la condicion de ejecucion para que valide si el cliente tiene correo electronico ya sea valido o no . 18/10/2013*******
;EjecucionCondicion=GuardarCambios<BR>Asigna(Mavi.DM0138Bandera,1)<BR>Asigna(Mavi.DM0138Modulo,<T>VTAS<T>)<BR>SI ConDatos(Venta:Venta.Mov) y ConDatos(Venta:Venta.Almacen)<BR>ENTONCES<BR>    SI Venta:Venta.Mov = <T>Pedido<T> y (Venta:Venta.Estatus en (EstatusSinAfectar))<BR>       y ((SQL(<T>EXEC dbo.SP_MAVIDM0138ValidaCorreo  :tCte, :tMov, :tEst<T>,Venta:Venta.Cliente,Venta:Venta.Mov,Venta:Venta.Estatus) = <T>1<T>)<BR>            o ((SQL(<T>EXEC SP_MAVIDM0138ChecarAbrirVentana :tCliente,:tMov,:tEstatus,:nBandera,:tInd,:nID,:tModulo<T>,Venta:Venta.Cliente,Venta:Venta.Mov,Venta:Venta.Estatus,Mavi.DM0138Bandera,3,Venta:Venta.ID,Mavi.DM0138Modulo))= 1))<BR>    ENTONCES<BR>        SQL(<T>EXEC SP_MAVIDM0138ChecarAbrirVentana  :tCliente,:tMov,:tEstatus,:nBandera,:tInd,:nID,:tModulo<T>,Venta:Venta.Cliente,Venta:Venta<CONTINUA>
;EjecucionCondicion002=<CONTINUA>.Mov,Venta:Venta.Estatus,Mavi.DM0138Bandera,2,Venta:Venta.ID,Mavi.DM0138Modulo)<BR>        Si SQL(<T>SELECT COUNT(Agente) FROM Agente WHERE SucursalEmpresa = :nSuc AND Agente = :tAgt<T>,Sucursal,Venta:Venta.Agente) = 0<BR>        Entonces<BR>            ERROR(<T>El Agente no corresponde a la lista<T>)<BR>        SINO<BR>            VERDADERO<BR>        FIN<BR>    SINO                                              <BR>        SI (SQL(<T>EXEC dbo.SP_MAVIDM0138ValidaCorreo  :tCte, :tMov, :tEst<T>,Venta:Venta.Cliente,Venta:Venta.Mov,Venta:Venta.Estatus) = <T>1<T><BR>             o ((SQL(<T>EXEC SP_MAVIDM0138ChecarAbrirVentana :tCliente,:tMov,:tEstatus,:nBandera,:tInd,:nID,:tModulo<T>,Venta:Venta.Cliente,Venta:Venta.Mov,Venta:Venta.Estatus,Mavi.DM0138Bandera,3,Venta:Venta.ID,Mavi.DM0138Modulo))=<CONTINUA>
;EjecucionCondicion003=<CONTINUA> 1))<BR>        ENTONCES<BR>            SI SQL(<T>EXEC dbo.SP_MAVIDM0197DEVMenosVTA :nID<T>,Venta:Venta.ID)=<T>0<T><BR>            ENTONCES<BR>                SQL(<T>EXEC SP_MAVIDM0138ChecarAbrirVentana :tCliente,:tMov,:tEstatus,:nBandera,:tInd,:nID,:tModulo<T>,Venta:Venta.Cliente,Venta:Venta.Mov,Venta:Venta.Estatus,Mavi.DM0138Bandera,2,Venta:Venta.ID,Mavi.DM0138Modulo)<BR>                1=1<BR>            SINO                                                <BR>                1=0<BR>                Error(<T>La Devolucion debe contener el total de Articulos Vendidos<T>)<BR>            FIN<BR>        SINO<BR>            1=0<BR>            Asigna(Info.Cliente,Venta:Venta.Cliente)<BR>            Asigna(Mavi.DM0138MovCorreo,Venta:Venta.Mov)<BR>            Asigna(Mavi.DM0138MovEstatus,Venta:Ve<CONTINUA>
;EjecucionCondicion004=<CONTINUA>nta.Estatus)<BR>            Asigna(Info.IDMAVI,Venta:Venta.ID) <BR>            Forma(<T>DM0138CapturaCorreo<T>)<BR>           // Error(<T>Capture un Correo Valido en menu Otros <T>+Comillas(<T>Capturar Correo<T>))<BR>        FIN<BR>    FIN<BR>SINO<BR>    1=0<BR>FIN
;****************** Modificada Por: Noe de Jesus Ibarra Cardona, se agrego la validacion alguno perfiles tengas permiso de acceder sin lanecesita de la validacion de los correos 23/10/2013********
;EjecucionCondicion=GuardarCambios<BR>Asigna(Mavi.DM0138Bandera,1)<BR>Asigna(Mavi.DM0138Modulo,<T>VTAS<T>)<BR>SI ConDatos(Venta:Venta.Mov) y ConDatos(Venta:Venta.Almacen)<BR>ENTONCES<BR>    SI Venta:Venta.Mov = <T>Pedido<T> y (Venta:Venta.Estatus en (EstatusSinAfectar))<BR>       y ((SQL(<T>EXEC dbo.SP_MAVIDM0138ValidaCorreo  :tCte, :tMov, :tEst<T>,Venta:Venta.Cliente,Venta:Venta.Mov,Venta:Venta.Estatus) = <T>1<T>)<BR>            o ((SQL(<T>EXEC SP_MAVIDM0138ChecarAbrirVentana :tCliente,:tMov,:tEstatus,:nBandera,:tInd,:nID,:tModulo<T>,Venta:Venta.Cliente,Venta:Venta.Mov,Venta:Venta.Estatus,Mavi.DM0138Bandera,3,Venta:Venta.ID,Mavi.DM0138Modulo))= 1)<BR>                o ((SQL(<T>SELECT COUNT(*) FROM TABLASTD WHERE TABLAST=:tTabla AND  NOMBRE=:tPerfil<T>,<T>EXCLUIRPERFILESDM0138<T>,Usuario.Acceso))>0))<BR>    E<CONTINUA>
;EjecucionCondicion002=<CONTINUA>NTONCES<BR>        SQL(<T>EXEC SP_MAVIDM0138ChecarAbrirVentana  :tCliente,:tMov,:tEstatus,:nBandera,:tInd,:nID,:tModulo<T>,Venta:Venta.Cliente,Venta:Venta.Mov,Venta:Venta.Estatus,Mavi.DM0138Bandera,2,Venta:Venta.ID,Mavi.DM0138Modulo)<BR>        Si SQL(<T>SELECT COUNT(Agente) FROM Agente WHERE SucursalEmpresa = :nSuc AND Agente = :tAgt<T>,Sucursal,Venta:Venta.Agente) = 0<BR>        Entonces<BR>            ERROR(<T>El Agente no corresponde a la lista<T>)<BR>        SINO<BR>            VERDADERO<BR>        FIN<BR>    SINO                                              <BR>        SI (SQL(<T>EXEC dbo.SP_MAVIDM0138ValidaCorreo  :tCte, :tMov, :tEst<T>,Venta:Venta.Cliente,Venta:Venta.Mov,Venta:Venta.Estatus) = <T>1<T><BR>             o ((SQL(<T>EXEC SP_MAVIDM0138ChecarAbrirVentana :tCliente,:tMov,:<CONTINUA>
;EjecucionCondicion003=<CONTINUA>tEstatus,:nBandera,:tInd,:nID,:tModulo<T>,Venta:Venta.Cliente,Venta:Venta.Mov,Venta:Venta.Estatus,Mavi.DM0138Bandera,3,Venta:Venta.ID,Mavi.DM0138Modulo))= 1)<BR>                 o ((SQL(<T>SELECT COUNT(*) FROM TABLASTD WHERE TABLAST=:tTabla AND  NOMBRE=:tPerfil<T>,<T>EXCLUIRPERFILESDM0138<T>,Usuario.Acceso))>0))<BR>        ENTONCES<BR>            SI SQL(<T>EXEC dbo.SP_MAVIDM0197DEVMenosVTA :nID<T>,Venta:Venta.ID)=<T>0<T><BR>            ENTONCES<BR>                SQL(<T>EXEC SP_MAVIDM0138ChecarAbrirVentana :tCliente,:tMov,:tEstatus,:nBandera,:tInd,:nID,:tModulo<T>,Venta:Venta.Cliente,Venta:Venta.Mov,Venta:Venta.Estatus,Mavi.DM0138Bandera,2,Venta:Venta.ID,Mavi.DM0138Modulo)<BR>                1=1<BR>            SINO                                                <BR>                1=0<BR> <CONTINUA>
;EjecucionCondicion004=<CONTINUA>               Error(<T>La Devolucion debe contener el total de Articulos Vendidos<T>)<BR>            FIN<BR>        SINO<BR>            1=0<BR>            Asigna(Info.Cliente,Venta:Venta.Cliente)<BR>            Asigna(Mavi.DM0138MovCorreo,Venta:Venta.Mov)<BR>            Asigna(Mavi.DM0138MovEstatus,Venta:Venta.Estatus)<BR>            Asigna(Info.IDMAVI,Venta:Venta.ID) <BR>            Forma(<T>DM0138CapturaCorreo<T>)<BR>           // Error(<T>Capture un Correo Valido en menu Otros <T>+Comillas(<T>Capturar Correo<T>))<BR>        FIN<BR>    FIN<BR>SINO<BR>    1=0<BR>FIN
;***** Se Modifico para que la venta dm0138  se abra si el el cliente no tiene un correo valido si su clave  es VTAS.P' o 'VTAS.F, Modificada por Noe de Jesus Ibarra Cardoana 24/10/2013
;EjecucionCondicion=GuardarCambios<BR>Asigna(Mavi.DM0138Bandera,1)<BR>Asigna(Mavi.DM0138Modulo,<T>VTAS<T>)<BR>SI ConDatos(Venta:Venta.Mov) y ConDatos(Venta:Venta.Almacen)<BR>ENTONCES<BR>    SI Venta:Venta.Mov = <T>Pedido<T> y (Venta:Venta.Estatus en (EstatusSinAfectar))<BR>       y ((SQL(<T>EXEC dbo.SP_MAVIDM0138ValidaCorreo  :tCte, :tMov, :tEst<T>,Venta:Venta.Cliente,Venta:Venta.Mov,Venta:Venta.Estatus) = <T>1<T>)<BR>            o ((SQL(<T>EXEC SP_MAVIDM0138ChecarAbrirVentana :tCliente,:tMov,:tEstatus,:nBandera,:tInd,:nID,:tModulo<T>,Venta:Venta.Cliente,Venta:Venta.Mov,Venta:Venta.Estatus,Mavi.DM0138Bandera,3,Venta:Venta.ID,Mavi.DM0138Modulo))= 1)<BR>                o ((SQL(<T>SELECT COUNT(*) FROM TABLASTD WHERE TABLAST=:tTabla AND  NOMBRE=:tPerfil<T>,<T>EXCLUIRPERFILESDM0138<T>,Usuario.Acceso))>0)<BR>      <CONTINUA>
;EjecucionCondicion002=<CONTINUA>              o (SQL(<T>SELECT COUNT(*) FROM MOVTIPO WHERE MOV= :tMov AND  Modulo = :tMod and Clave in (:tUno,:tDos )<T>,Venta:Venta.Mov, <T>VTAS<T>,<T>VTAS.P<T>,<T>VTAS.F<T>) = 0))<BR>    ENTONCES<BR>        SQL(<T>EXEC SP_MAVIDM0138ChecarAbrirVentana  :tCliente,:tMov,:tEstatus,:nBandera,:tInd,:nID,:tModulo<T>,Venta:Venta.Cliente,Venta:Venta.Mov,Venta:Venta.Estatus,Mavi.DM0138Bandera,2,Venta:Venta.ID,Mavi.DM0138Modulo)<BR>        Si SQL(<T>SELECT COUNT(Agente) FROM Agente WHERE SucursalEmpresa = :nSuc AND Agente = :tAgt<T>,Sucursal,Venta:Venta.Agente) = 0<BR>        Entonces<BR>            ERROR(<T>El Agente no corresponde a la lista<T>)<BR>        SINO<BR>            VERDADERO<BR>        FIN<BR>    SINO                                              <BR>        SI (SQL(<T>EXEC dbo.SP_MAVI<CONTINUA>
;EjecucionCondicion003=<CONTINUA>DM0138ValidaCorreo  :tCte, :tMov, :tEst<T>,Venta:Venta.Cliente,Venta:Venta.Mov,Venta:Venta.Estatus) = <T>1<T><BR>             o ((SQL(<T>EXEC SP_MAVIDM0138ChecarAbrirVentana :tCliente,:tMov,:tEstatus,:nBandera,:tInd,:nID,:tModulo<T>,Venta:Venta.Cliente,Venta:Venta.Mov,Venta:Venta.Estatus,Mavi.DM0138Bandera,3,Venta:Venta.ID,Mavi.DM0138Modulo))= 1)<BR>                 o ((SQL(<T>SELECT COUNT(*) FROM TABLASTD WHERE TABLAST=:tTabla AND  NOMBRE=:tPerfil<T>,<T>EXCLUIRPERFILESDM0138<T>,Usuario.Acceso))>0)<BR>                      o (SQL(<T>SELECT COUNT(*) FROM MOVTIPO WHERE MOV= :tMov AND  Modulo = :tMod and Clave in (:tUno,:tDos )<T>,Venta:Venta.Mov, <T>VTAS<T>,<T>VTAS.P<T>,<T>VTAS.F<T>) = 0))<BR>        ENTONCES<BR>            SI SQL(<T>EXEC dbo.SP_MAVIDM0197DEVMenosVTA :nID<T>,Venta:Venta.ID)<CONTINUA>
;EjecucionCondicion004=<CONTINUA>=<T>0<T><BR>            ENTONCES<BR>                SQL(<T>EXEC SP_MAVIDM0138ChecarAbrirVentana :tCliente,:tMov,:tEstatus,:nBandera,:tInd,:nID,:tModulo<T>,Venta:Venta.Cliente,Venta:Venta.Mov,Venta:Venta.Estatus,Mavi.DM0138Bandera,2,Venta:Venta.ID,Mavi.DM0138Modulo)<BR>                1=1<BR>            SINO                                                <BR>                1=0<BR>                Error(<T>La Devolucion debe contener el total de Articulos Vendidos<T>)<BR>            FIN<BR>        SINO<BR>            1=0<BR>            Asigna(Info.Cliente,Venta:Venta.Cliente)<BR>            Asigna(Mavi.DM0138MovCorreo,Venta:Venta.Mov)<BR>            Asigna(Mavi.DM0138MovEstatus,Venta:Venta.Estatus)<BR>            Asigna(Info.IDMAVI,Venta:Venta.ID) <BR>            Forma(<T>DM0138CapturaCorreo<CONTINUA>
;EjecucionCondicion005=<CONTINUA><T>)<BR>           // Error(<T>Capture un Correo Valido en menu Otros <T>+Comillas(<T>Capturar Correo<T>))<BR>        FIN<BR>    FIN<BR>SINO<BR>    1=0<BR>FIN
;***** Fernando Hernandez 10/12/14  DM0238 - Se modifico la ejecucion condicion insertando la condicion de estatus del canal de venta de instituciones.
;EjecucionCondicion=GuardarCambios<BR>Asigna(Mavi.DM0138Bandera,1)<BR>Asigna(Mavi.DM0138Modulo,<T>VTAS<T>)<BR><BR>SI SQL(<T>SELECT COUNT(ESTATUS) AS VALOR FROM DM0238VIGENCIASINSTITUCIONES DM JOIN VENTASCANALMAVI VC ON DM.CANAL_VENTA=VC.ID WHERE VC.CATEGORIA=:tcat AND CANAL_VENTA=:ncv AND (ESTATUS=:tcan OR ESTATUS=:tina)<T>,<T>INSTITUCIONES<T>,Venta:Venta.EnviarA,<T>CANCELADO<T>,<T>INACTIVA<T>)<>0<BR>ENTONCES<BR>Error(<T>Canal de Venta suspendido o cancelado<T>)<BR>sino<BR><BR>SI ConDatos(Venta:Venta.Mov) y ConDatos(Venta:Venta.Almacen)<BR>ENTONCES<BR>    SI Venta:Venta.Mov = <T>Pedido<T> y (Venta:Venta.Estatus en (EstatusSinAfectar))<BR>       y ((SQL(<T>EXEC dbo.SP_MAVIDM0138ValidaCorreo  :tCte, :tMov, :tEst<T>,Venta:Venta.Cliente,Venta:Venta.Mov,Venta:Venta.Estatus) = <T>1<T>)<BR>            o ((SQL(<T>EXE<CONTINUA>
;EjecucionCondicion002=<CONTINUA>C SP_MAVIDM0138ChecarAbrirVentana :tCliente,:tMov,:tEstatus,:nBandera,:tInd,:nID,:tModulo<T>,Venta:Venta.Cliente,Venta:Venta.Mov,Venta:Venta.Estatus,Mavi.DM0138Bandera,3,Venta:Venta.ID,Mavi.DM0138Modulo))= 1)<BR>                o ((SQL(<T>SELECT COUNT(*) FROM TABLASTD WHERE TABLAST=:tTabla AND  NOMBRE=:tPerfil<T>,<T>EXCLUIRPERFILESDM0138<T>,Usuario.Acceso))>0)<BR>                    o (SQL(<T>SELECT COUNT(*) FROM MOVTIPO WHERE MOV= :tMov AND  Modulo = :tMod and Clave in (:tUno,:tDos )<T>,Venta:Venta.Mov, <T>VTAS<T>,<T>VTAS.P<T>,<T>VTAS.F<T>) = 0))<BR>    ENTONCES<BR>        SQL(<T>EXEC SP_MAVIDM0138ChecarAbrirVentana  :tCliente,:tMov,:tEstatus,:nBandera,:tInd,:nID,:tModulo<T>,Venta:Venta.Cliente,Venta:Venta.Mov,Venta:Venta.Estatus,Mavi.DM0138Bandera,2,Venta:Venta.ID,Mavi.DM0138Modulo)<BR> <CONTINUA>
;EjecucionCondicion003=<CONTINUA>       Si SQL(<T>SELECT COUNT(Agente) FROM Agente WHERE SucursalEmpresa = :nSuc AND Agente = :tAgt<T>,Sucursal,Venta:Venta.Agente) = 0<BR>        Entonces<BR>            ERROR(<T>El Agente no corresponde a la lista<T>)<BR>        SINO<BR>            VERDADERO<BR>        FIN<BR>    SINO                                              <BR>        SI (SQL(<T>EXEC dbo.SP_MAVIDM0138ValidaCorreo  :tCte, :tMov, :tEst<T>,Venta:Venta.Cliente,Venta:Venta.Mov,Venta:Venta.Estatus) = <T>1<T><BR>             o ((SQL(<T>EXEC SP_MAVIDM0138ChecarAbrirVentana :tCliente,:tMov,:tEstatus,:nBandera,:tInd,:nID,:tModulo<T>,Venta:Venta.Cliente,Venta:Venta.Mov,Venta:Venta.Estatus,Mavi.DM0138Bandera,3,Venta:Venta.ID,Mavi.DM0138Modulo))= 1)<BR>                 o ((SQL(<T>SELECT COUNT(*) FROM TABLASTD WHERE TABLAST=:tTab<CONTINUA>
;EjecucionCondicion004=<CONTINUA>la AND  NOMBRE=:tPerfil<T>,<T>EXCLUIRPERFILESDM0138<T>,Usuario.Acceso))>0)<BR>                      o (SQL(<T>SELECT COUNT(*) FROM MOVTIPO WHERE MOV= :tMov AND  Modulo = :tMod and Clave in (:tUno,:tDos )<T>,Venta:Venta.Mov, <T>VTAS<T>,<T>VTAS.P<T>,<T>VTAS.F<T>) = 0))<BR>        ENTONCES<BR>            SI SQL(<T>EXEC dbo.SP_MAVIDM0197DEVMenosVTA :nID<T>,Venta:Venta.ID)=<T>0<T><BR>            ENTONCES<BR>                SQL(<T>EXEC SP_MAVIDM0138ChecarAbrirVentana :tCliente,:tMov,:tEstatus,:nBandera,:tInd,:nID,:tModulo<T>,Venta:Venta.Cliente,Venta:Venta.Mov,Venta:Venta.Estatus,Mavi.DM0138Bandera,2,Venta:Venta.ID,Mavi.DM0138Modulo)<BR>                1=1<BR>            SINO                                                <BR>                1=0<BR>                Error(<T>La Devolucion debe con<CONTINUA>
;EjecucionCondicion005=<CONTINUA>tener el total de Articulos Vendidos<T>)<BR>            FIN<BR>        SINO<BR>            1=0<BR>            Asigna(Info.Cliente,Venta:Venta.Cliente)<BR>            Asigna(Mavi.DM0138MovCorreo,Venta:Venta.Mov)<BR>            Asigna(Mavi.DM0138MovEstatus,Venta:Venta.Estatus)<BR>            Asigna(Info.IDMAVI,Venta:Venta.ID) <BR>            Forma(<T>DM0138CapturaCorreo<T>)<BR>           // Error(<T>Capture un Correo Valido en menu Otros <T>+Comillas(<T>Capturar Correo<T>))<BR>        FIN<BR>    FIN<BR>SINO<BR>    1=0<BR>FIN<BR>FIN
;***** Fernando Hernandez 02/01/15  DM0238 - Se modifico la ejecucion condicion insertando la condicion de estatus del canal de venta de instituciones y el tipo de movimiento
;EjecucionCondicion=GuardarCambios<BR>Asigna(Mavi.DM0138Bandera,1)<BR>Asigna(Mavi.DM0138Modulo,<T>VTAS<T>)<BR><BR>SI<BR>((SQL(<T>SELECT COUNT(ESTATUS) AS VALOR FROM DM0238VIGENCIASINSTITUCIONES DM JOIN VENTASCANALMAVI VC ON DM.CANAL_VENTA=VC.ID WHERE VC.CATEGORIA=:tcat AND CANAL_VENTA=:ncv AND (ESTATUS=:tcan OR ESTATUS=:tina)<T>,<T>INSTITUCIONES<T>,Venta:Venta.EnviarA,<T>CANCELADO<T>,<T>INACTIVA<T>)<>0)<BR>y (Venta:Venta.Mov en (<T>Solicitud Credito<T>,<T>Analisis Credito<T>,<T>Pedido<T>,<T>Factura<T>,<T>Credilana<T>,<T>Prestamo Personal<T>,<T>Factura VIU<T>,<T>Seguro Vida<T>)))<BR>ENTONCES<BR>Error(<T>Canal de Venta suspendido o cancelado<T>)<BR>sino<BR><BR>SI ConDatos(Venta:Venta.Mov) y ConDatos(Venta:Venta.Almacen)<BR>ENTONCES<BR>    SI Venta:Venta.Mov = <T>Pedido<T> y (Venta:Venta.Estatus en (EstatusSinAf<CONTINUA>
;EjecucionCondicion002=<CONTINUA>ectar))<BR>       y ((SQL(<T>EXEC dbo.SP_MAVIDM0138ValidaCorreo  :tCte, :tMov, :tEst<T>,Venta:Venta.Cliente,Venta:Venta.Mov,Venta:Venta.Estatus) = <T>1<T>)<BR>            o ((SQL(<T>EXEC SP_MAVIDM0138ChecarAbrirVentana :tCliente,:tMov,:tEstatus,:nBandera,:tInd,:nID,:tModulo<T>,Venta:Venta.Cliente,Venta:Venta.Mov,Venta:Venta.Estatus,Mavi.DM0138Bandera,3,Venta:Venta.ID,Mavi.DM0138Modulo))= 1)<BR>                o ((SQL(<T>SELECT COUNT(*) FROM TABLASTD WHERE TABLAST=:tTabla AND  NOMBRE=:tPerfil<T>,<T>EXCLUIRPERFILESDM0138<T>,Usuario.Acceso))>0)<BR>                    o (SQL(<T>SELECT COUNT(*) FROM MOVTIPO WHERE MOV= :tMov AND  Modulo = :tMod and Clave in (:tUno,:tDos )<T>,Venta:Venta.Mov, <T>VTAS<T>,<T>VTAS.P<T>,<T>VTAS.F<T>) = 0))<BR>    ENTONCES<BR>        SQL(<T>EXEC SP_MAVIDM0138ChecarAbr<CONTINUA>
:EjecucionCondicion003=<CONTINUA>irVentana  :tCliente,:tMov,:tEstatus,:nBandera,:tInd,:nID,:tModulo<T>,Venta:Venta.Cliente,Venta:Venta.Mov,Venta:Venta.Estatus,Mavi.DM0138Bandera,2,Venta:Venta.ID,Mavi.DM0138Modulo)<BR>        Si SQL(<T>SELECT COUNT(Agente) FROM Agente WHERE SucursalEmpresa = :nSuc AND Agente = :tAgt<T>,Sucursal,Venta:Venta.Agente) = 0<BR>        Entonces<BR>            ERROR(<T>El Agente no corresponde a la lista<T>)<BR>        SINO<BR>            VERDADERO<BR>        FIN<BR>    SINO                                              <BR>        SI (SQL(<T>EXEC dbo.SP_MAVIDM0138ValidaCorreo  :tCte, :tMov, :tEst<T>,Venta:Venta.Cliente,Venta:Venta.Mov,Venta:Venta.Estatus) = <T>1<T><BR>             o ((SQL(<T>EXEC SP_MAVIDM0138ChecarAbrirVentana :tCliente,:tMov,:tEstatus,:nBandera,:tInd,:nID,:tModulo<T>,Venta:Venta<CONTINUA>
;EjecucionCondicion004=<CONTINUA>.Cliente,Venta:Venta.Mov,Venta:Venta.Estatus,Mavi.DM0138Bandera,3,Venta:Venta.ID,Mavi.DM0138Modulo))= 1)<BR>                 o ((SQL(<T>SELECT COUNT(*) FROM TABLASTD WHERE TABLAST=:tTabla AND  NOMBRE=:tPerfil<T>,<T>EXCLUIRPERFILESDM0138<T>,Usuario.Acceso))>0)<BR>                      o (SQL(<T>SELECT COUNT(*) FROM MOVTIPO WHERE MOV= :tMov AND  Modulo = :tMod and Clave in (:tUno,:tDos )<T>,Venta:Venta.Mov, <T>VTAS<T>,<T>VTAS.P<T>,<T>VTAS.F<T>) = 0))<BR>        ENTONCES<BR>            SI SQL(<T>EXEC dbo.SP_MAVIDM0197DEVMenosVTA :nID<T>,Venta:Venta.ID)=<T>0<T><BR>            ENTONCES<BR>                SQL(<T>EXEC SP_MAVIDM0138ChecarAbrirVentana :tCliente,:tMov,:tEstatus,:nBandera,:tInd,:nID,:tModulo<T>,Venta:Venta.Cliente,Venta:Venta.Mov,Venta:Venta.Estatus,Mavi.DM0138Bandera,2,Venta:Venta.I<CONTINUA>
;EjecucionCondicion005=<CONTINUA>D,Mavi.DM0138Modulo)<BR>                1=1<BR>            SINO                                                <BR>                1=0<BR>                Error(<T>La Devolucion debe contener el total de Articulos Vendidos<T>)<BR>            FIN<BR>        SINO<BR>            1=0                                                                 <BR>            Asigna(Info.Cliente,Venta:Venta.Cliente)<BR>            Asigna(Mavi.DM0138MovCorreo,Venta:Venta.Mov)<BR>            Asigna(Mavi.DM0138MovEstatus,Venta:Venta.Estatus)<BR>            Asigna(Info.IDMAVI,Venta:Venta.ID)<BR>            Asigna(Info.ID,Venta:Venta.ID)<BR>            Asigna(Info.Modulo,<T>VTAS<T>)<BR>            Asigna(Info.UEN,Venta:Venta.UEN)<BR>            Forma(<T>DM0138CapturaCorreo<T>)<BR>           // Error(<T>Capture un<CONTINUA>
;EjecucionCondicion006=<CONTINUA> Correo Valido en menu Otros <T>+Comillas(<T>Capturar Correo<T>))<BR>        FIN<BR>    FIN<BR>SINO<BR>    1=0<BR>FIN<BR>FIN
;EjecucionCondicion=GuardarCambios<BR>SI ConDatos(Venta:Venta.Mov) y ConDatos(Venta:Venta.Almacen)<BR>ENTONCES<BR>    SI Venta:Venta.Mov = <T>Pedido<T> y (Venta:Venta.Estatus en (EstatusSinAfectar))<BR>       y (SQL(<T>EXEC dbo.SP_MAVIDM0138ValidaCorreo  :tCte, :tMov, :tEst<T>,Venta:Venta.Cliente,Venta:Venta.Mov,Venta:Venta.Estatus) = <T>1<T>)<BR>    ENTONCES<BR>        Si SQL(<T>SELECT COUNT(Agente) FROM Agente WHERE SucursalEmpresa = :nSuc AND Agente = :tAgt<T>,Sucursal,Venta:Venta.Agente) = 0<BR>        Entonces<BR>            ERROR(<T>El Agente no corresponde a la lista<T>)<BR>        SINO<BR>            VERDADERO<BR>        FIN<BR>    SINO<BR>        SI SQL(<T>EXEC dbo.SP_MAVIDM0138ValidaCorreo  :tCte, :tMov, :tEst<T>,Venta:Venta.Cliente,Venta:Venta.Mov,Venta:Venta.Estatus) = <T>1<T><BR>        ENTONCES<<CONTINUA>
;EjecucionCondicion002=<CONTINUA>BR>            SI SQL(<T>EXEC dbo.SP_MAVIDM0197DEVMenosVTA :nID<T>,Venta:Venta.ID)=<T>0<T><BR>            ENTONCES                                               <BR>                1=1<BR>            SINO<BR>                1=0<BR>                Error(<T>La Devolucion debe contener el total de Articulos Vendidos<T>)<BR>            FIN<BR>        SINO<BR>            1=0<BR>            Asigna(Info.Cliente,Venta:Venta.Cliente)<BR>            Forma(<T>DM0138CapturaCorreo<T>)<BR>            Error(<T>Capture un Correo Valido en menu Otros <T>+Comillas(<T>Capturar Correo<T>))<BR>        FIN<BR>    FIN<BR>SINO<BR>    1=0<BR>FIN
***** Arturo Corona Cazares 01/12/15 DM0138 -Se modifico la condicion de ejecucion en la llamada a la forma DM0138CapturaCorreo para que no aparezca en cada movimiento.
;EjecucionCondicion=GuardarCambios<BR>Asigna(Mavi.DM0138Bandera,0)<BR>Asigna(Mavi.DM0138Modulo,<T>VTAS<T>)<BR><BR>SI<BR>((SQL(<T>SELECT COUNT(ESTATUS) AS VALOR FROM DM0238VIGENCIASINSTITUCIONES DM JOIN VENTASCANALMAVI VC ON DM.CANAL_VENTA=VC.ID WHERE VC.CATEGORIA=:tcat AND CANAL_VENTA=:ncv AND (ESTATUS=:tcan OR ESTATUS=:tina)<T>,<T>INSTITUCIONES<T>,Venta:Venta.EnviarA,<T>CANCELADO<T>,<T>INACTIVA<T>)<>0)<BR>y (Venta:Venta.Mov en (<T>Solicitud Credito<T>,<T>Analisis Credito<T>,<T>Pedido<T>,<T>Factura<T>,<T>Credilana<T>,<T>Prestamo Personal<T>,<T>Factura VIU<T>,<T>Seguro Vida<T>)))<BR>ENTONCES<BR>Error(<T>Canal de Venta suspendido o cancelado<T>)<BR>sino<BR><BR>SI ConDatos(Venta:Venta.Mov) y ConDatos(Venta:Venta.Almacen)<BR>ENTONCES<BR>    SI Venta:Venta.Mov = <T>Pedido<T> y (Venta:Venta.Estatus en (EstatusSinAf<CONTINUA>
;EjecucionCondicion002=<CONTINUA>ectar))<BR>        y (SQL(<T>SELECT COUNT(*) FROM MOVTIPO WHERE MOV= :tMov AND  Modulo = :tMod and Clave in (:tUno,:tDos )<T>,Venta:Venta.Mov, <T>VTAS<T>,<T>VTAS.P<T>,<T>VTAS.F<T>) = 0)<BR>    ENTONCES<BR>        Si SQL(<T>SELECT COUNT(Agente) FROM Agente WHERE SucursalEmpresa = :nSuc AND Agente = :tAgt<T>,Sucursal,Venta:Venta.Agente) = 0<BR>        Entonces<BR>            ERROR(<T>El Agente no corresponde a la lista<T>)<BR>        SINO<BR>            VERDADERO<BR>        FIN<BR>    SINO                                              <BR><BR>      SI (SQL(<T>SELECT COUNT(*) FROM MOVTIPO WHERE MOV= :tMov AND  Modulo = :tMod and Clave in (:tUno,:tDos )<T>,Venta:Venta.Mov, <T>VTAS<T>,<T>VTAS.P<T>,<T>VTAS.F<T>) = 0))<BR>        ENTONCES<BR>            SI SQL(<T>EXEC dbo.SP_MAVIDM0197DEVMenosVTA <CONTINUA>
;EjecucionCondicion003=<CONTINUA>:nID<T>,Venta:Venta.ID)=<T>0<T><BR>            ENTONCES<BR>                1=1<BR>            SINO                                                <BR>                1=0<BR>                Error(<T>La Devolucion debe contener el total de Articulos Vendidos<T>)<BR>            FIN<BR>        SINO<BR>            1=0                                                                 <BR>            Asigna(Info.Cliente,Venta:Venta.Cliente)<BR>            Asigna(Mavi.DM0138MovCorreo,Venta:Venta.Mov)<BR>            Asigna(Mavi.DM0138MovEstatus,Venta:Venta.Estatus)<BR>            Asigna(Info.IDMAVI,Venta:Venta.ID)<BR>            Asigna(Info.ID,Venta:Venta.ID)<BR>            Asigna(Info.Modulo,<T>VTAS<T>)<BR>            Asigna(Info.UEN,Venta:Venta.UEN)<BR>      // Error(<T>Capture un Correo Valido en <CONTINUA>
;EjecucionCondicion004=<CONTINUA>menu Otros <T>+Comillas(<T>Capturar Correo<T>))<BR>        FIN<BR>    FIN<BR>SINO<BR>    1=0<BR>FIN<BR>FIN
***** Cambio del Mannu
EjecucionCondicion=GuardarCambios<BR>Asigna(Mavi.DM0138Bandera,0)<BR>Asigna(Mavi.DM0138Modulo,<T>VTAS<T>)<BR><BR>SI (Venta:Venta.Estatus = <T>PENDIENTE<T>) y (Venta:Venta.Situacion = <T>Liberado<T>) y (Venta:Venta.Mov = <T>Pedido Mayoreo<T>)<BR>ENTONCES<BR>    Asigna(Info.Mensaje,SQLEnLista(<T>SET ANSI_NULLS ON<BR>                                    SET ANSI_WARNINGS ON     <BR>                                    Select * from  dbo.FnAFListMovPendVehiculo (:tMov,:tVal)<T>,<T>MOVID<T>,Venta:Venta.MovID))<BR>   SI conDatos(Info.Mensaje) ENTONCES<BR>        INFORMACION(<T>El Pedido cuenta con los siguientes movimientos pendientes:<T>+NuevaLinea+NuevaLinea<BR>+Info.Mensaje<BR>+NuevaLinea+<T>Favor de concluirlos para poder continuar.<T>)<BR>        AbortarOperacion<BR>    FIN<BR>FIN<BR><BR>SI<BR>((SQL(<T>SELECT COUNT(ESTATUS) AS VALOR FROM DM0238VIGENCIASINSTITUCIONES DM JOIN VENTASCANALMAVI VC ON DM.CANAL_VENTA=VC.ID WHERE VC.CATEGORIA IN (:tcat,:tcat2) AND CANAL_VENTA=:ncv AND (ESTATUS=:tcan OR ESTATUS=:tina)<T>,<T>INSTITUCIONES<T>,<T>CREDITO MENUDEO<T>,Venta:Venta.EnviarA,<T>CANCELADO<T>,<T>INACTIVA<T>)<>0)<BR>y (Venta:Venta.Mov en (<T>Solicitud Credito<T>,<T>Analisis Credito<T>,<T>Pedido<T>,<T>Factura<T>,<T>Credilana<T>,<T>Prestamo Personal<T>,<T>Factura VIU<T>,<T>Seguro Vida<T>)))<BR>ENTONCES<BR>Error(<T>Canal de Venta suspendido o cancelado<T>)<BR>sino<BR><BR>SI ConDatos(Venta:Venta.Mov) y ConDatos(Venta:Venta.Almacen)<BR>ENTONCES<BR>    SI Venta:Venta.Mov = <T>Pedido<T> y (Venta:Venta.Estatus en (EstatusSinAfectar))<BR>        y (SQL(<T>SELECT COUNT(*) FROM MOVTIPO WHERE MOV= :tMov AND  Modulo = :tMod and Clave in (:tUno,:tDos )<T>,Venta:Venta.Mov, <T>VTAS<T>,<T>VTAS.P<T>,<T>VTAS.F<T>) = 0)<BR>    ENTONCES<BR>        VERDADERO<BR>    SINO<BR><BR>      SI (SQL(<T>SELECT COUNT(*) FROM MOVTIPO WHERE MOV= :tMov AND  Modulo = :tMod and Clave in (:tUno,:tDos )<T>,Venta:Venta.Mov, <T>VTAS<T>,<T>VTAS.P<T>,<T>VTAS.F<T>) = 0))<BR>        ENTONCES<BR>            SI SQL(<T>EXEC dbo.SP_MAVIDM0197DEVMenosVTA :nID<T>,Venta:Venta.ID)=<T>0<T><BR>            ENTONCES<BR>                1=1<BR>            SINO                                                <BR>                1=0<BR>                Error(<T>La Devolucion debe contener el total de Articulos Vendidos<T>)<BR>            FIN<BR>        SINO<BR>            1=0                                                                 <BR>            Asigna(Info.Cliente,Venta:Venta.Cliente)<BR>            Asigna(Mavi.DM0138MovCorreo,Venta:Venta.Mov)<BR>            Asigna(Mavi.DM0138MovEstatus,Venta:Venta.Estatus)<BR>            Asigna(Info.IDMAVI,Venta:Venta.ID)<BR>            Asigna(Info.ID,Venta:Venta.ID)<BR>            Asigna(Info.Modulo,<T>VTAS<T>)<BR>            Asigna(Info.UEN,Venta:Venta.UEN)<BR>      // Error(<T>Capture un Correo Valido en menu Otros <T>+Comillas(<T>Capturar Correo<T>))<BR>        FIN<BR>    FIN<BR>SINO<BR>    1=0<BR>FIN<BR>FIN<BR>Si Venta:Venta.Mov en (<T>Factura<T>,<T>Factura VIU<T>)<BR>Entonces<BR>Asigna(Mavi.RM1161Sucursal,Venta:Venta.Sucursal)<BR>Asigna(Mavi.RM1161IDVenta,Venta:Venta.ID)<BR>     Si (SQL(<T>EXEC dbo.SP_RM1161AfectacionRepServicio :nID,:nIDSoporte,:nOpc<T>,Venta:Venta.ID,Mavi.RM1161Sucursal,2)= 1) y (Mavi.RM1161Bandera=<T>VERDADERO<T>)<BR>     Entonces<BR>         Forma(<T>RM1161ValidaReporteSFRM<T>)<BR>         AbortarOperacion<BR> Sino<BR>     Verdadero<BR>  Fin<BR>Fin<BR><BR>Si<BR>    (Venta:Venta.EnviarA=76)<BR>Entonces<BR>  Si<BR>      SQL(<T>SELECT COUNT(Cliente) FROM Cte WHERE SinBonifDIMA = 1 and Cliente=:tCliente<T>,Venta:Venta.Cliente) > 0<BR>  Entonces<BR>      Informacion(<T>No es posible realizar la solicitud de credito. El cliente es DIMA y tiene intervención de cobranza<T>)<BR>      AbortarOperacion<BR>  Sino<BR>      Verdadero<BR>  Fin                                                                                         <BR>Fin<BR><BR>Asigna(Info.Mensaje,SQL(<T>SELECT dbo.FNCOMSValidaPedidoMayoreo (:nID)<T>,Venta:Venta.ID))<BR>Si<BR>    Info.Mensaje = <T>SIN ERROR<T><BR>Entonces<BR>    Verdadero<BR>Sino<BR>    Error(Info.Mensaje)<BR>    AbortarOperacion<BR>Fin
; **** Se modifico el nombre a desplegar ****
; ***** Integracion linea ClaveAccion para mandar llamar otra forma. JR 30-Nov-09 *****
; ***** Modificacion de AntesExpresiones para imprimir Facturas concluidas, CQ 26/09/2012 Carmen Quintana, dentro del paquete DM0138_27092012. JR 27-Sep-2012. *****
[Venta.frm/Acciones.CteEnviarA]
NombreDesplegar=Canales de Venta del Cliente...
ClaveAccion=SelelccionaCanalVentaCte
;AGR 15 ENE 2010 Se agrega linea para que asigne la uen a Info.UEN
Antes=S
AntesExpresiones=Asigna(Info.UEN, Usuario.UEN)<BR>Asigna(Info.Cliente, Venta:Venta.Cliente)<BR>Asigna(Mavi.DM0138RFC, Venta:Cte.RFC)

; **** Nueva Accion Agregada, muestra una forma que informa el monto del abono que debe pagar el cliente de acuerdo al tipo de forma de pago que se haya elegido ****
[Venta.frm/Acciones.MontoAbono_MAVI]
Nombre=MontoAbono_MAVI
Boton=64
NombreDesplegar=Monto del Abono
EnBarraHerramientas=S
EnMenu=N
TipoAccion=Formas
ClaveAccion=MontoAbono_MAVI
Activo=S
Antes=S
GuardarAntes=S
AntesExpresiones=Asigna(Info.ID,Venta:Venta.ID)
VisibleCondicion=MovTipo(<T>VTAS<T>,Venta:Venta.Mov)=<T>VTAS.F<T>



;**** Se modifico la acción para que solo se ejecute si el check de espacios (Modulo espacios) esta encendido en la configuracion general de la empresa ****
;**** El asistente para espacios aparece cuando en el detalle de la venta seleccionas un articulo que tenga activado el check de espacios en el catálogo de articulos ****
;**** Se comento el cambio porque interferia con los articulos tipo Juego ARC (07-Nov-08)****

[Venta.frm/Acciones.Asistente Articulos]
;ConCondicion=S
;EjecucionCondicion=General.Espacios
VisibleCondicion=medio(usuario,1,5)<><T>VENTP<T>
Visible=N



;**** Modificacion integrada por ARC (03-Dic-08) cambios realizados por MAVI *****
; se modifico a que este boton siempre este visible victor 09/02/2011. Mavi.
[Venta.frm/Acciones.AgregarEvento]
;ActivoCondicion=Asigna(Mavi.ServicasaConfigUsr1,(SQL(<T>SELECT ACCESO FROM USUARIO WHERE USUARIO=:tval1<T>,usuario)))<BR>Asigna(Mavi.ServicasaGrupoCalif,(SQL(<T>EXEC SP_MAVIULTIMACALIFICACION :nval1,:tval2<T>,Venta:Venta.ID,<T>Vtas<T>)))<BR>((Venta:Venta.Estatus<>EstatusCancelado) y ((Mavi.ServicasaConfigUsr1=<T>CREDI_GERA<T>) o (Mavi.ServicasaConfigUsr1=<T>CREDI_USRA<T>)) o ((Mavi.ServicasaConfigUsr1=<T>VENTR_GERA<T>) y (Mavi.ServicasaGrupoCalif=<T>D<T>)) o ((Mavi.ServicasaConfigUsr1=<T>VENTP_GERA<T>) y (Mavi.ServicasaGrupoCalif=<T>C<T>)) o ((Mavi.ServicasaConfigUsr1=<T>VENTP_SUPA<T>) y (Mavi.ServicasaGrupoCalif=<T>C<T>)) o ((Mavi.ServicasaConfigUsr1=<T>VENTI_GERA<T>) y (Mavi.ServicasaGrupoCalif=<T>C<T>)) o ((Mavi.ServicasaConfigUsr1=<T>VENTC_GERA<T>) y (Mavi.ServicasaGrupoCalif=<T>C<T>)) o (Usuario.Usuario =<T>ADMIN<T>)  o (Mavi.ServicasaConfigUsr1 en (<T>COBMA_GERA<T>,<T>COBMA_USRA<T>))))
;ActivoCondicion=Asigna(Mavi.ServicasaConfigUsr1,(SQL(<T>SELECT ACCESO FROM USUARIO WHERE USUARIO=:tval1<T>,usuario)))<BR>Asigna(Mavi.ServicasaGrupoCalif,(SQL(<T>EXEC SP_MAVIULTIMACALIFICACION :nval1,:tval2<T>,Venta:Venta.ID,<T>Vtas<T>)))<BR>((Venta:Venta.Estatus<>EstatusCancelado) y ((Mavi.ServicasaConfigUsr1=<T>CREDI_GERA<T>) o (Mavi.ServicasaConfigUsr1=<T>CREDI_USRA<T>) o (Mavi.ServicasaConfigUsr1=<T>COBMA_GERA<T>) o (Mavi.ServicasaConfigUsr1=<T>COBMA_USRA<T>)) o ((Mavi.ServicasaConfigUsr1=<T>VENTR_GERA<T>) y (Mavi.ServicasaGrupoCalif=<T>D<T>)) o ((Mavi.ServicasaConfigUsr1=<T>VENTP_GERA<T>) y (Mavi.ServicasaGrupoCalif=<T>C<T>)) o ((Mavi.ServicasaConfigUsr1=<T>VENTP_SUPA<T>) y (Mavi.ServicasaGrupoCalif=<T>C<T>)) o ((Mavi.ServicasaConfigUsr1=<T>VENTI_GERA<T>) y (Mavi.ServicasaGrupoCalif=<T>C<T>)) o ((Mavi.ServicasaConfigUsr1=<T>VENTC_GERA<T>) y (Mavi.ServicasaGrupoCalif=<T>C<T>)) o (Mavi.ServicasaConfigUsr1=<T>VENTC_USRA<T>) o (Mavi.ServicasaConfigUsr1 =<T>MAVI<T>) o (Mavi.ServicasaConfigUsr1 en (<T>COBMA_GE;RA<T>,<T>COBMA_USRA<T>))))
;RefrescarDespues=S
;ActivoCondicion=
;Activo=S
;Victoria Pérez -Fecha de Modificación: 25-01-2013 
Nombre=AgregarEvento
Boton=0
Menu=&Edición
NombreDesplegar=Agregar E&vento
TipoAccion=Formas
ClaveAccion=MovBitacoraAgregar
ConCondicion=S
Antes=S
RefrescarDespues=S
Visible=S
EnMenu=S
ActivoCondicion=SI ((IZQUIERDA(Usuario.Usuario,4)= <T>VENT<T>) y (IZQUIERDA(Usuario.Usuario,5) <> <T>VENTR<T>))<BR>ENTONCES<BR>    (sql(<T>Select count(v.ID)<BR>         From Venta v join V_MAVIUltMovBitacora vm on v.id=vm.id<BR>         Where v.Mov=:tM and ((vm.clave=:tCve<BR>and v.SucursalVenta=:nSUC and v.OrigenSucursal<>v.SucursalVenta) OR vm.grupo=:tg)<BR>AND V.ID=:nID<T> ,<T>Analisis Credito<T>,<T>MEN06206<T>,30,<T>Z<T>,Venta:Venta.ID ) = 0) o<BR>    (sql(<T>Select count(v.ID) From Venta v<BR>    join V_MAVIUltMovBitacora vm on v.id=vm.id<BR>Where v.Mov=:tMov and v.Situacion=:tSit<BR>and vm.clave=(Select Top 1 mbb.clave From MovBitacora mbb<BR>              Left Join V_MAVIUltMovBitacora vm on mbb.id=vm.id<BR>              Where v.Mov=:tM and (mbb.clave<> :tCve and Fecha<vm.FechaUlt)<BR>            <CONTINUA>
ActivoCondicion002=<CONTINUA>  and mbb.id=v.id<BR>              Order by Fecha Desc)AND V.ID=:nId<T>,<T>Analisis Credito<T>,<T>Agente Libre<T>,<BR>              <T>Analisis Credito<T>,<T>MEN06206<T>,Venta:Venta.ID ) = 1) <BR>SINO<BR>SI IZQUIERDA(Usuario.Usuario,5) = <T>VENTR<T><BR>ENTONCES<BR>     Usuario.Sucursal = 30  y  sql(<T>Select count(v.ID)<BR>         From Venta v join V_MAVIUltMovBitacora vm on v.id=vm.id<BR>         Where v.Mov=:tM and vm.clave<>:tCve and vm.grupo=:tg AND V.ID=:nID<T><BR>,<T>Analisis Credito<T>,<T>MEN06206<T>,<T>Z<T>,Venta:Venta.ID ) = 0<BR>SINO<BR>SI (Izquierda(Usuario.Usuario,4) = <T>CRED<T>) o (IZQUIERDA(Usuario.Usuario,4)<><T>VENT<T>)<BR>    o (IZQUIERDA(Usuario.Usuario,5)=<T>VENTM<T>)<BR>ENTONCES<BR>    VERDADERO<BR>SINO<BR>FALSO<BR>FIN
EjecucionCondicion=Si(Vacio(Venta:Venta.ID),  GuardarCambios)<BR>Verdadero
AntesExpresiones=Asigna(Info.Modulo, <T>VTAS<T>)<BR>Asigna(Info.ID, Venta:Venta.ID)<BR>Asigna(Info.Mov, Venta:Venta.Mov)<BR>Asigna(Info.MovID, Venta:Venta.MovID)<BR>Asigna(Info.AgenteA,Venta:Venta.Agente)



;*****Se modifico la expresion para que mostrara una forma antes para especificar el tipo de cliente **** Arly Rubio 07-08-08
; ***** JR 04-Dic-09. Se agrego linea boton para cte express. Cambio por Arturo Guizer. ****
[Venta.frm/Acciones.CteExpress]
;Expresion=Asigna(Info.Tipo, <T>Cliente<T>)<BR>Si Forma(<T>TipoCteMAVI<T>)<BR>  Entonces<BR>    Caso  Info.TipoCteExpress<BR>      Es <T>Persona Fisica<T><BR>        Entonces<BR>          Si Forma(<T>CteExpress<T>)<BR>            Entonces<BR>Asigna(Venta:Venta.Cliente, Info.Cliente)<BR>            Fin<BR>      Es <T>Persona Moral<T><BR>        Entonces<BR>          Si Forma(<T>CteMoralExpress<T>)<BR>            Entonces<BR>              Asigna(Venta:Venta.Cliente, Info.Cliente)<BR>            Fin<BR>      Sino  Error(<T>Tipo de cliente no valido<T>, BotonAceptar)<BR>    Fin<BR>  Fin
Expresion=Asigna(Info.Tipo, <T>Cliente<T>)<BR>FormaModal(<T>SeleccionCategoriaMavi<T>)<BR>Asigna(Info.Nombre,Nulo)<BR><BR>Asigna(Info.Nombre,SQL(<T>SELECT Nombre FROM Cte WHERE Cliente=<T>&comillas(Info.cliente)))<BR><BR>Si Info.Nombre <> nulo<BR>Entonces<BR> Asigna(Venta:Venta.Cliente,Info.cliente)<BR> Asigna(Venta:Cte.Nombre,SQL(<T>SELECT Nombre FROM Cte WHERE Cliente=<T>&comillas(Info.cliente)))<BR> Asigna(Venta:Venta.EnviarA,Info.CanalVentaMAVI)<BR>Fin<BR><BR>Asigna(Info.Nombre,Nulo)
ConCondicion=S
EjecucionConError=S
EjecucionCondicion=CONDATOS(Venta:Venta.Mov)
EjecucionMensaje=<T>Es necesario capturar un movimiento<T>
Boton=122

;***** Se configuro para que se ejecutaran acciones "antes de ejecutar" (ARC 11-Dic-08) ****
; **** Integracion de expresion (Jesus Del Toro Andrade. 30-Sep-2011) para desarrollo DM0152 Campos Extras, I(Informacion de Cliente) y Preliminar de Cobro dentro del paquete DM0152_30092011. JR 30-Sep-2011. **** 
[Venta.frm/Acciones.CamposExtras]
Antes=S
DespuesGuardar=S
AntesExpresiones=Asigna(Info.IDMAVI, Venta:Venta.ID)
;VisibleCondicion=((Info.Mov=<T>Solicitud Credito<T>) y (Info.Estatus=<T>SINAFECTAR<T>))
;Expresion=SI<BR>     Sql(<T>select count(u.usuario) from usuario u<BR>    join tablastd tb on u.acceso = tb.Nombre<BR>    where TablaSt = :tPrfil and u.usuario =:tUSR<T>, <T>CFG BLOQUEO PERFILES CE VENTAS<T>,Usuario) = 0<BR>    ENTONCES<BR>    Si<BR>      General.CamposExtras=<T>Campos Extras<T><BR>    Entonces<BR>      CamposExtrasMovimiento(<T>VTAS<T>, Venta:Venta.Mov, Venta:Venta.ID, Falso, Venta:Venta.Estatus noen (EstatusSinAfectar, EstatusPorConfirmar, EstatusBorrador))<BR>    Sino                            <BR>      Asigna(Info.Aplica, <T>Movimiento<T>)<BR>      Asigna(Info.Clave, <T>VTAS<T>+Venta:Venta.ID)<BR>      Asigna(Info.Nombre, Venta:Venta.Mov+<T> <T>+Venta:Venta.MovID)<BR>      Asigna(Info.Modulo, <T>VTAS<T>)<BR>      Asigna(Info.Mov, Venta:Venta.Mov)<BR>      Asigna(Info.Categoria,<CONTINUA>
;Expresion002=<CONTINUA> Nulo)<BR>      Asigna(Info.Grupo, Nulo)<BR>      Asigna(Info.Familia, Nulo)<BR>      Asigna(Info.Departamento, Nulo)<BR>      Asigna(Info.Puesto, Nulo)<BR>      Asigna(Info.SIC, Nulo)<BR><BR>      Asigna(Temp.Reg, SQL(<T>spFormaExtraVisible :tAplica, :tModulo, :tMov, :tCat, :tGrupo, :tFam, :tDepto, :tPuesto, :tSIC<T>, Info.Aplica, Info.Modulo, Info.Mov, Info.Categoria, Info.Grupo, Info.Familia, Info.Departamento, Info.Puesto, Info.SIC))<BR>      Si(Temp.Reg[1]>1, Si(no Forma(<T>EspecificarFormaTipo<T>), AbortarOperacion), Asigna(Info.FormaTipo, Temp.Reg[2]))<BR>      Si<BR>        ConDatos(Info.FormaTipo)<BR>      Entonces<BR>        Si<BR>          Venta:Venta.Estatus en (EstatusSinAfectar, EstatusPorConfirmar, EstatusBorrador)<BR>        Entonces<BR>          iForma(Info.FormaTipo, Info<CONTINUA>
;Expresion003=<CONTINUA>.Aplica, Info.Clave, Info.Nombre)<BR>        Sino<BR>          iConsulta(Info.FormaTipo, Info.Aplica, Info.Clave, Info.Nombre)<BR>        Fin<BR>      Sino<BR>        Informacion(<T>No Tiene Definida Ninguna Forma<T>)<BR>      Fin<BR>    Fin<BR>SINO<BR>    SI<BR>        (Venta:Venta.Estatus = <T>SINAFECTAR<T>)<BR>    ENTONCES<BR>         Si<BR>             General.CamposExtras=<T>Campos Extras<T><BR>         Entonces<BR>              CamposExtrasMovimiento(<T>VTAS<T>, Venta:Venta.Mov, Venta:Venta.ID, Falso, Venta:Venta.Estatus noen (EstatusSinAfectar, EstatusPorConfirmar, EstatusBorrador))<BR>         Sino<BR>              Asigna(Info.Aplica, <T>Movimiento<T>)<BR>              Asigna(Info.Clave, <T>VTAS<T>+Venta:Venta.ID)<BR>              Asigna(Info.Nombre, Venta:Venta.Mov+<T> <T>+Venta:V<CONTINUA>
;Expresion004=<CONTINUA>enta.MovID)<BR>              Asigna(Info.Modulo, <T>VTAS<T>)<BR>              Asigna(Info.Mov, Venta:Venta.Mov)<BR>              Asigna(Info.Categoria, Nulo)<BR>              Asigna(Info.Grupo, Nulo)<BR>              Asigna(Info.Familia, Nulo)                      <BR>              Asigna(Info.Departamento, Nulo)<BR>              Asigna(Info.Puesto, Nulo)<BR>              Asigna(Info.SIC, Nulo)<BR><BR>              Asigna(Temp.Reg, SQL(<T>spFormaExtraVisible :tAplica, :tModulo, :tMov, :tCat, :tGrupo, :tFam, :tDepto, :tPuesto, :tSIC<T>, Info.Aplica, Info.Modulo, Info.Mov, Info.Categoria, Info.Grupo, Info.Familia, Info.Departamento, Info.Puesto, Info.SIC))<BR>              Si(Temp.Reg[1]>1, Si(no Forma(<T>EspecificarFormaTipo<T>), AbortarOperacion), Asigna(Info.FormaTipo, Temp.Reg[2]))<BR>  <CONTINUA>
;Expresion005=<CONTINUA>            Si<BR>                ConDatos(Info.FormaTipo)<BR>              Entonces<BR>                Si<BR>                  Venta:Venta.Estatus en (EstatusSinAfectar, EstatusPorConfirmar, EstatusBorrador)<BR>                Entonces<BR>                  iForma(Info.FormaTipo, Info.Aplica, Info.Clave, Info.Nombre)<BR>                Sino<BR>                  iConsulta(Info.FormaTipo, Info.Aplica, Info.Clave, Info.Nombre)<BR>                Fin<BR>              Sino<BR>                Informacion(<T>No Tiene Definida Ninguna Forma<T>)<BR>              Fin<BR>           Fin<BR>    FIN<BR>FIN

;Fabian 09/05/2013
VisibleCondicion=
Expresion=SI<BR>     Sql(<T>select count(u.usuario) from usuario u<BR>    join tablastd tb on u.acceso = tb.Nombre<BR>    where TablaSt = :tPrfil and u.usuario =:tUSR<T>, <T>CFG BLOQUEO PERFILES CE VENTAS<T>,Usuario) = 0<BR>    ENTONCES<BR>    Si<BR>      General.CamposExtras=<T>Campos Extras<T><BR>    Entonces<BR>       Asigna(Temp.Reg, SQL(<T>spMostrarCamposExtra :tMov, :nID, :tEst, :tUs<T>,Venta:Venta.Mov,Venta:Venta.ID,Venta:Venta.Estatus, Izquierda(Usuario.Usuario,5) ))<BR>       Asigna(Info.Mov, Temp.Reg[1])<BR>       Asigna(Info.ID, Temp.Reg[2])<BR>       Asigna(Info.Nombre,Temp.Reg[3])<BR>      CamposExtrasMovimiento(<T>VTAS<T>,Info.Mov, Info.ID, Falso,Info.Nombre noen (EstatusSinAfectar, EstatusPorConfirmar, EstatusBorrador))<BR>    Sino<BR>      Asigna(Temp.Reg,Nulo)<BR>      Asigna(Info.Aplica, <T>Movimiento<T>)<BR>      Asigna(Info.Clave, <T>VTAS<T>+Venta:Venta.ID)<BR>      Asigna(Info.Nombre, Venta:Venta.Mov+<T> <T>+Venta:Venta.MovID)<BR>      Asigna(Info.Modulo, <T>VTAS<T>)<BR>      Asigna(Info.Mov, Venta:Venta.Mov)<BR>      Asigna(Info.Categoria, Nulo)<BR>      Asigna(Info.Grupo, Nulo)<BR>      Asigna(Info.Familia, Nulo)       <BR>      Asigna(Info.Departamento, Nulo)<BR>      Asigna(Info.Puesto, Nulo)<BR>      Asigna(Info.SIC, Nulo)<BR><BR>      Asigna(Temp.Reg, SQL(<T>spFormaExtraVisible :tAplica, :tModulo, :tMov, :tCat, :tGrupo, :tFam, :tDepto, :tPuesto, :tSIC<T>, Info.Aplica, Info.Modulo, Info.Mov, Info.Categoria, Info.Grupo, Info.Familia, Info.Departamento, Info.Puesto, Info.SIC))<BR>      Si(Temp.Reg[1]>1, Si(no Forma(<T>EspecificarFormaTipo<T>), AbortarOperacion), Asigna(Info.FormaTipo, Temp.Reg[2]))<BR>      Si<BR>        ConDatos(Info.FormaTipo)<BR>      Entonces<BR>        Si<BR>          Venta:Venta.Estatus en (EstatusSinAfectar, EstatusPorConfirmar, EstatusBorrador)<BR>        Entonces<BR>          iForma(Info.FormaTipo, Info.Aplica, Info.Clave, Info.Nombre)<BR>        Sino<BR>          iConsulta(Info.FormaTipo, Info.Aplica, Info.Clave, Info.Nombre)<BR>        Fin<BR>      Sino<BR>        Informacion(<T>No Tiene Definida Ninguna Forma<T>)<BR>      Fin<BR>    Fin<BR>SINO<BR><BR>         Si<BR>             General.CamposExtras=<T>Campos Extras<T><BR>         Entonces<BR>              Asigna(Temp.Reg, SQL(<T>spMostrarCamposExtra :tMov, :nID, :tEst, :tUs<T>,Venta:Venta.Mov,Venta:Venta.ID,Venta:Venta.Estatus, Izquierda(Usuario.Usuario,5) ))<BR>             Asigna(Info.Mov, Temp.Reg[1])<BR>             Asigna(Info.ID, Temp.Reg[2])<BR>             Asigna(Info.Nombre,Temp.Reg[3])<BR>             CamposExtrasMovimiento(<T>VTAS<T>,Info.Mov, Info.ID, Falso,Info.Nombre noen (EstatusSinAfectar, EstatusPorConfirmar, EstatusBorrador))<BR>         Sino<BR>              Asigna(Temp.Reg,Nulo)<BR>              Asigna(Info.Aplica, <T>Movimiento<T>)<BR>              Asigna(Info.Clave, <T>VTAS<T>+Venta:Venta.ID)<BR>              Asigna(Info.Nombre, Venta:Venta.Mov+<T> <T>+Venta:Venta.MovID)<BR>              Asigna(Info.Modulo, <T>VTAS<T>)<BR>              Asigna(Info.Mov, Venta:Venta.Mov)<BR>              Asigna(Info.Categoria, Nulo)<BR>              Asigna(Info.Grupo, Nulo)<BR>              Asigna(Info.Familia, Nulo)<BR>              Asigna(Info.Departamento, Nulo)<BR>              Asigna(Info.Puesto, Nulo)<BR>              Asigna(Info.SIC, Nulo)<BR><BR>              Asigna(Temp.Reg, SQL(<T>spFormaExtraVisible :tAplica, :tModulo, :tMov, :tCat, :tGrupo, :tFam, :tDepto, :tPuesto, :tSIC<T>, Info.Aplica, Info.Modulo, Info.Mov, Info.Categoria, Info.Grupo, Info.Familia, Info.Departamento, Info.Puesto, Info.SIC))<BR>              Si(Temp.Reg[1]>1, Si(no Forma(<T>EspecificarFormaTipo<T>), AbortarOperacion), Asigna(Info.FormaTipo, Temp.Reg[2]))<BR>              Si<BR>                ConDatos(Info.FormaTipo)<BR>              Entonces<BR>                Si<BR>                  Venta:Venta.Estatus en (EstatusSinAfectar, EstatusPorConfirmar, EstatusBorrador)<BR>                Entonces<BR>                  iForma(Info.FormaTipo, Info.Aplica, Info.Clave, Info.Nombre)<BR>                Sino<BR>                  iConsulta(Info.FormaTipo, Info.Aplica, Info.Clave, Info.Nombre)<BR>                Fin<BR>              Sino<BR>                Informacion(<T>No Tiene Definida Ninguna Forma<T>)<BR>              Fin<BR>           Fin<BR>   <BR>FIN


;*****SE LE AGREGA LA ASIGNACION DE LAS VARIABLES INFO.SUCURSAL E INFO.CLIENTE PARA EL SP_MaviDM0146CopiarVale, Paquete DM0146_17082011 BVF 17082011
;***** Nueva accion agregada para que se capturen los vales en los movimientos de venta ARC 17-Dic-08****
[Venta.frm/Acciones.ValesMAVI]
Nombre=ValesMAVI
Boton=0
Menu=&Edición
NombreDesplegar=Agregar Vales...
GuardarAntes=S
EnMenu=S
TipoAccion=Formas
ClaveAccion=VentaValeMAVI
ConCondicion=S
Antes=S
DespuesGuardar=S
Visible=S
ActivoCondicion=Venta:Venta.UEN = 1 y (Venta:Venta.Estatus en (EstatusSinAfectar))
EjecucionCondicion=ConDatos(Venta:Venta.ID)
AntesExpresiones=Asigna(Info.IDMAVI, Venta:Venta.ID)<BR>Asigna(Info.Cliente,Venta:Venta.Cliente)<BR>Asigna(Info.Sucursal,Venta:Venta.EnviarA)



;***** Nueva accion agregada para que se visualicen los vales en los movimientos de venta ARC 17-Dic-08****
[Venta.frm/Acciones.ValesMAVILista]
Nombre=ValesMAVILista
Boton=0
Menu=&Ver
NombreDesplegar=Vales
EnMenu=S
TipoAccion=Formas
ClaveAccion=VentaValeMAVILista
ConCondicion=S
Antes=S
Visible=N
Activo=S
EjecucionCondicion=ConDatos(Venta:Venta.ID)
AntesExpresiones=Asigna(Info.IDMAVI, Venta:Venta.ID)
VisibleCondicion=Venta:Venta.UEN = 1 y (Venta:Venta.Estatus en (EstatusPendiente, EstatusConcluido, EstatusCancelado))

;***** Nuevas acciones agregadas para Editar/No Editar Detalle
;***** Modificacion a AntesExpresiones que reactiva el botón Imprimir al crear un Nuevo Documento dentro del paquete DM0116_20072012_1853. JR 23-Jul-2012. ****
[Venta.frm/Acciones.Nuevo]
Antes=S
AntesExpresiones=Asigna(MAVI.DM0116FaseC,0)<BR>Asigna(Mavi.RM1161Bandera,<T>VERDADERO<T>)<BR>Asigna(Info.Conteo, 0)<BR>Asigna(Mavi.ServicasaCapDetallVentas,0)<BR>Asigna(Info.Respuesta4,<T><T>)<BR>SI(((Venta:Venta.Estatus <> <T>CONCLUIDO<T>)y (Venta:Venta.Mov en (<T>Factura<T>,<T>Credilana<T>,<T>Factura VIU<T>)) y (Vacio(Venta:Venta.MovID,Nulo) <> Nulo)), (EjecutarSQL(<T>SPCancelaFolioVTASMAVI :n<T>,Venta:Venta.ID )))


[Venta.frm/Acciones.Abrir]
TipoAccion=Expresion
Antes=S
Expresion=Asigna(Info.Conteo, 0)<BR>Forma.Accion(<T>Cerrar<T>)<BR>Caso  Mavi.ServicasaModulo<BR>  Es 0 Entonces Forma(<T>Venta<T>)<BR>  Es 1 Entonces Forma(<T>MaviServicasaVtasPisoFrm<T>)<BR>  Es 2 Entonces Forma(<T>MaviServicredVtasPisoFrm<T>)<BR>  Es 3 Entonces Forma(<T>MaviServicasaCredFrm<T>)<BR>  Es 4 Entonces Forma(<T>MaviServicredCredFrm<T>)<BR>  Es 5 Entonces Forma(<T>MaviServicasaCrMayFrm<T>)<BR>  Es 6 Entonces Forma(<T>MaviServicredCrMayFrm<T>)<BR>Sino<BR>  <T><T><BR>Fin<BR>Asigna(Mavi.ServicasaCapDetallVentas,0)<BR>SI(((Venta:Venta.Estatus <> <T>CONCLUIDO<T>)y (Venta:Venta.Mov en (<T>Factura<T>,<T>Credilana<T>,<T>Factura VIU<T>)) y (Vacio(Venta:Venta.MovID,Nulo) <> Nulo)), (EjecutarSQL('SPCancelaFolioVTASMAVI :n',Venta:Venta.ID )))
AntesExpresiones=Asigna(Info.Conteo, 0)
VisibleCondicion=medio(usuario,1,5)<><T>VENTP<T>
Visible=N


[Venta.frm/Acciones.MovCopiar]
Antes=S
AntesExpresiones=Asigna(Info.Conteo, 0)<BR>SI(((Venta:Venta.Estatus <> <T>CONCLUIDO<T>)y (Venta:Venta.Mov en (<T>Factura<T>,<T>Credilana<T>,<T>Factura VIU<T>)) y (Vacio(Venta:Venta.MovID,Nulo) <> Nulo)), (EjecutarSQL('SPCancelaFolioVTASMAVI :n',Venta:Venta.ID )))<BR>
;Jesus Del Toro Andrade 18-08-2014, se agrega condicion para no copiar solicitud devolucion
ConCondicion=S
EjecucionConError=S
EjecucionCondicion=Venta:Venta.Mov NoEn (<T>Solicitud Devolucion<T>)
EjecucionMensaje=<T>No se puede copiar el movimiento: <T> & Venta:Venta.Mov

;**** ARC 13-Ene-08: Nueva accion agregada PROPRE *****
;Se actualizo para qeu solo aparezca en las solicitudes de credito mayoreo/menudeo y pedido BVF10032011
[Venta.frm/Acciones.UsuarioDescuento]
Nombre=UsuarioDescuento
Boton=0
NombreDesplegar=Usuario Descuento
EnMenu=S
Visible=S
GuardarAntes=S
TipoAccion=Expresion
Antes=S
DespuesGuardar=S
Expresion=Forma(<T>UsuarioDescuento<T>)<BR>Forma.ActualizarVista(<T>Detalle<T>)
ActivoCondicion=(Venta:Venta.Estatus = <T>SINAFECTAR<T>) y (vacio(Venta:Venta.Origen)) y (vacio(Venta:Venta.OrigenID)) y (Venta:Venta.Mov en(<T>Solicitud Credito<T>,<T>Solicitud Mayoreo<T>,<T>Pedido Mayoreo<T>)) o ((Venta:Venta.Mov en(<T>Pedido<T>)) y (Venta:Venta.FormaPagoTipo en(<T>CONTADO<T>,<T>Contado<T>)) y (Venta:Venta.Estatus = <T>SINAFECTAR<T>))
AntesExpresiones=Asigna(Info.ID,Venta:Venta.ID)<BR>Asigna(Info.Modulo,<T>VTAS<T>)<BR>Asigna(Info.Renglon,VentaD:VentaD.Renglon)<BR>Asigna(Info.Articulo,VentaD:VentaD.Articulo)<BR>Asigna(Info.Porcentaje,VentaD:PropreListaDFinal.Factor01)<BR>Asigna(Info.Precio,VentaD:VentaD.Precio)


;*** Se integro modificacion Anticipos MAVI Moises Garcia 26/03/2009 MAVI0001
;*** Modificacion: 19-Mar-09   ALQG:  Integracion del desarrollo de Anticipos Folio 2600 ***
; **** Integracion condicion y mensaje de ejecucion, condicion de no ejecucion en clientes de tipo prospecto, Jesus Del Toro Andrade 23-03-2012, para el desarrollo DM0179 Anticipos Prospectos dentro del paquete DM0179_31032012. JR 02-Abr-2012. ****
[Venta.frm/Acciones.Anticipos]
Expresion=Asigna(Info.ID, Venta:Venta.ID)<BR>Asigna(Info.Mov, Venta:Venta.Mov)<BR>Asigna(Info.MovID, Venta:Venta.MovID)<BR>Asigna(Info.EnviarA, Venta:Venta.EnviarA)<BR>Asigna(Info.Rama, <T>CXC<T>)<BR>Asigna(Info.Cuenta, Venta:Venta.Cliente)<BR>Asigna(Info.Agente, Venta:Venta.Agente)<BR>Asigna(Info.Moneda, Venta:Venta.Moneda)<BR>Asigna(Info.TipoCambio, Venta:Venta.TipoCambio)<BR>Asigna(Info.Estatus, Venta:Venta.Estatus)<BR>Asigna(Info.PorcentajeImpuesto,  Redondea(Si(Venta:Venta.DesglosarImpuesto2, General.DefImpuesto, (Suma(VentaD:Impuesto)/Suma(VentaD:SubTotal))*100), 8))<BR>Asigna(Info.Concepto, Venta:Venta.Concepto)<BR>Asigna(Info.Proyecto, Venta:Venta.Proyecto)<BR>Asigna(Info.Condicion,Venta:Venta.Condicion)<BR>Asigna(Mavi.BloqCposCxcAnticContApart,051020)<BR>Forma(<T>VentaVerAnticipo<T>)
Activo=N
ActivoCondicion=MovTipoEn(<T>VTAS<T>, Venta:Venta.Mov, (VTAS.P, VTAS.S)) y (Venta:Venta.Estatus en (EstatusPendiente, EstatusConcluido)) 
ConCondicion=S
EjecucionCondicion=SQL(<T>SELECT Tipo FROM Cte WITH(NOLOCK) WHERE Cliente=:tUsuario<T>,Venta:Venta.Cliente)<><T>Prospecto<T>
EjecucionMensaje=<T>El Cliente no debe ser de Tipo Prospecto<T>
EjecucionConError=S



;**** ARC 19-Feb-09 Nueva Accion agregada ****
[Venta.frm/Acciones.IngresosGenerados]
Nombre=IngresosGenerados
Boton=0
Menu=&Ver
NombreDesplegar=Ingresos Generados
EnMenu=S
TipoAccion=Formas
ClaveAccion=IngresosDevolucionesMAVI
ConCondicion=S
Antes=S
ActivoCondicion=(Venta:Venta.Estatus en (EstatusConcluido)) y (Venta:Venta.Mov en(<T>Cancela Credilana<T>,<T>Cancela Prestamo<T>))
EjecucionCondicion=Venta:Venta.Estatus en (EstatusConcluido)
AntesExpresiones=Asigna(Info.IDMAVI, Venta:Venta.ID)
Visible=S


;***** SE agrego Accion Huella *************
[Venta.frm/Acciones.Huella]
Nombre=Huella
Menu=&Edición
NombreDesplegar=Identificar Cte x Preguntas de Seguridad
EnBarraHerramientas=N
EnMenu=S
TipoAccion=Expresion
Activo=S
Expresion=Si(ConDatos(Venta:Venta.Cliente),Asigna(Info.Cliente,Venta:Venta.Cliente))<BR>Si(ConDatos(Venta:Cte.Nombre),Asigna(Info.ClienteNombre,Venta:Cte.Nombre))<BR>Asigna(Info.Reporte,<T>Preguntas<T>)<BR>Forma(<T>RegistroCte<T>)
ConCondicion=S
;EjecucionCondicion=ConDatos(Venta:Venta.Cliente)
EjecucionCondicion=(SQL(<T>SELECT COUNT(*) FROM Fingerprints WHERE FingerID=:t<T>,Venta:Venta.Cliente))>=1 y ConDatos(Venta:Venta.Cliente)
EjecucionMensaje=<T>El Cliente <T>+Comillas(Venta:Venta.Cliente)+<T> no tiene Huella(s) capturada(s)<T>
;EjecucionMensaje=<T>Es Necesario Especificar un Cliente<T>
EjecucionConError=S
VisibleCondicion=Venta:Venta.Mov en (<T>Pedido<T>,<T>Solicitud Credito<T>)

[Venta.frm/Acciones.Huella2]
Nombre=Huella2
Boton=74
NombreDesplegar=&Identificación x Huella
EnBarraHerramientas=S
TipoAccion=Expresion
Activo=S
ConCondicion=S
EjecucionConError=S
Antes=S
GuardarAntes=S
DespuesGuardar=S
Expresion=//Plugin(<T>Acceso<T>)<BR>Ejecutar(Temp.Texto)
EjecucionCondicion=((SQL(<T>SELECT COUNT(*) FROM Fingerprints WHERE FingerID=:t<T>,Venta:Venta.Cliente))>=1) y (ConDatos(Venta:Venta.Cliente)) y (SQL(<T>SELECT dbo.fnExisteRegistroValidadoHuella(:tCte)<T>,Venta:Venta.Cliente)=1)
EjecucionMensaje=<T>El Cliente <T>+Comillas(Venta:Venta.Cliente)+<T> no tiene Huella(s) capturada(s) o no tiene ningun registro validado<T>
AntesExpresiones=EjecutarSQL(<T>xpInsertaTemporales :tCte, :nSuc, :nEst, :tUser<T>,Venta:Venta.Cliente,Sucursal,EstacionTrabajo,Usuario)<BR>Asigna(Info.Cliente, Venta:Venta.Cliente)<BR>Asigna(Info.Nombre, Venta:Cte.Nombre)<BR>Asigna(Temp.Numerico1,0)<BR>Asigna(Info.Tipo,<T>Cliente,<T>)<BR>Asigna(Temp.Texto,<T>c:\huella\Mavihuella.exe #91-5-i87n654t$,<T> + Hoy + <T>,<T> + Usuario + <T>,<T> + Info.Cliente + <T>,<T> + Info.Nombre + <T>,<T> + Info.Tipo + <T><T> + Temp.Numerico1)
VisibleCondicion=1=0//Venta:Venta.Mov en (<T>Pedido<T>,<T>Solicitud Credito<T>)

;Nombre=Huella2
;Boton=74
;NombreDesplegar=&Registro x Huella
;EnBarraHerramientas=S
;TipoAccion=Expresion
;Expresion=Plugin(<T>Acceso<T>)
;Activo=S
;ConCondicion=S
;EjecucionCondicion= (SQL(<T>SELECT COUNT(*) FROM Fingerprints WHERE FingerID=:t<T>,Venta:Venta.Cliente))>=1 y ConDatos(Venta:Venta.Cliente)
;EjecucionMensaje=<T>El Cliente <T>+Comillas(Venta:Venta.Cliente)+<T> no tiene Huella(s) capturada(s)<T>
;EjecucionConError=S
;Antes=S
;AntesExpresiones=EjecutarSQL(<T>xpInsertaTemporales :tCte, :nSuc, :nEst, :tUser<T>,Venta:Venta.Cliente,Sucursal,EstacionTrabajo,Usuario)
;VisibleCondicion=Venta:Venta.Mov en (<T>Pedido<T>,<T>Solicitud Credito<T>)





;***Agergo Oscar Danell Moran    19-junio-2009 ***

[Venta.frm/Acciones.Recalcular]
Nombre=Recalcular
Boton=82
NombreEnBoton=S
NombreDesplegar=Recalcular
EnBarraHerramientas=S
TipoAccion=Controles Captura
ClaveAccion=Actualizar Vista
Visible=S
EspacioPrevio=S
GuardarAntes=S
Antes=S
DespuesGuardar=S
ActivoCondicion=(Venta:Venta.Estatus = EstatussinAfectar) y (vacio(Venta:Venta.Origen)) y (vacio(Venta:Venta.OrigenID))
AntesExpresiones=ProcesarSQL(<T>spPropreActualizarPrecios :nid,:tEstatus<T>,Venta:Venta.ID,Venta:Venta.Estatus)

;**** PENDIENTEINTEGRACIONMOISES SE AGREGA NUEVA ACCION PARA DESPLEGAR LA FORMA DE MODIFICACION DE LA SUCURSAL CUANDO EL MOVIMIENTO SEA "ANALISIS CREDITO" Y ESTE EN ESTATUS "PENDIENTE" Y EL USUARIO TENGA ACCESO A LA OPCION DE CONFIGURACION MOISES MAVI 15/JUNIO/2009
[Venta.frm/Acciones.SucVen]
Nombre=SucVen
Boton=0
NombreEnBoton=S
NombreDesplegar=Modificar Sucursal Venta
EnMenu=S
Menu=&Edición
RefrescarDespues=S
TipoAccion=Expresion
Antes=S
GuardarAntes=S
Activo=S
ConCondicion=S
EjecucionConError=S
Expresion=FormaModal(<T>MaviCambiaSucVentaFRM<T>)<BR>Forma.ActualizarVista<BR>Forma.RefrescarControles<BR>Forma.ActualizarForma
EjecucionCondicion=SQL(<T>Exec SP_MaviValidaAcceso <T>&Comillas(Usuario))=1
EjecucionMensaje=<T>No tienes Permiso para realizar esta Accion<T>
AntesExpresiones=Asigna(Info.ID, Venta:Venta.ID)<BR>Asigna(Info.Mov, Venta:Venta.Mov)<BR>Asigna(Info.MovID, Venta:Venta.MovID)<BR>Asigna(Temp.Num,(SQL(<T>Exec SP_MaviValidaAcceso <T>&Comillas(Usuario))))<BR>Asigna(Info.Estatus,Venta:Venta.Estatus)
VisibleCondicion=((Venta:Venta.Mov = <T>Analisis Credito<T>) o (Venta:Venta.Mov = <T>Analisis Credito Mayoreo<T>)) y<BR>(Venta:Venta.Estatus = <T>PENDIENTE<T>)

;*** Integracion nuevas validaciones en expresion,antes expresion y activo condicion paquete DM0116_14092011 BVF 14092011 
;*** Integracion validaciones en expresion en accion impresion de CFD BVF 08082011 paquete DM0116_08082011 
;*** Integracion validaciones en expresion en accion impresion de CFD BVF 04072011 paquete DM0116_02072011 
;*** Integracion validaciones en expresion para impresion de CFD paqeute DM0116_23062011 BVF 23062011
;Modificacion victor 25082010 se modifico la accion para que funcionara llamando los reportes correspondientes segun el movimiento
; ***** Integracion validaciones en expresion para el desarrollo de CFD dentro del paquete DM_CFD_12052011. Se agrega la configuracion para imprimir los formatos de factura... tanto de CFD como el embarque y la copia TEG 12052011. JR 12-May-2011. *****
; ***** Integracion validaciones en expresion para la impresion  Factura Mayoreo CFD,Simplificado y Ciego BVF 17052011
; **** Modificacion de AntesExpresiones para desarrollo RM0847A Relación de Pedidos por Cliente dentro del paquete RM0847A_06062012, 06/06/2012 VEMT. JR 06-Jun-2012. ****
; **** Modificacion de Expresion para desarrollo DM0116 Impresiones por Sucursal dentro del paquete DM0116_08062012. JR 08-Jun-2012.****
; **** Modificacion de expresion y antesexpresiones para desarrollo DM0116 CFD dentro del paquete DM0116_06072012. JR 06-Jul-2012. **** 
; **** Modificacion de expresion para desarrollo DM0116 CFD del paquete DM0116_11072012. JR 11-Jul-2012. **** 
;***** CQ 12/09/2012 Carmen Quintana Se agrega validación para Imprimir únicamente cuando las FACTURAS esten CONCLUIDAS. Integra BVF 13092012 DM0116_13092012
[Venta.frm/Acciones.Imprimir]
Antes=S
ConCondicion=S
EjecucionConError=S
EjecucionCondicion=Si (Venta:Venta.Estatus = <T>CONCLUIDO<T>)<BR>    Entonces<BR>        Verdadero<BR>    Sino<BR>        Si (SQL(<T>Select count(Mov) From MovTipoCFDFlex Where Modulo = :tVta and Mov = :tMov<T>, <T>VTAS<T>, Venta:Venta.Mov))>0<BR>            Entonces<BR>                Falso<BR>            Sino<BR>                Verdadero<BR>        Fin<BR>Fin
EjecucionMensaje=<T>La Factura debe estar Concluida<T>

;***** CQ 17/07/2012 Carmen Quintana Modificación de la acción Imprimir. Integro BVF 17072012
;**** Modificacion de activo, activocondicion, antesexpresiones y expresiones dentro del paquete DM0116_18072012. JR 18-Jul-2012. ****
Activo=
ActivoCondicion=MAVI.DM0116FaseC <> 1

;***** CQ 28/08/2012 Carmen Quintana Modificación a la acción del botón Imprimir.Integra BVF 28082012 DM0116_28082012_1356
;Expresion=Asigna(MAVI.DM0116FaseC,1)<BR>Actualizarforma<BR>Si (SQL(<T>Select count(Mov) From MovTipoCFDFlex Where Modulo = :tVta and Mov = :tMov<T>, <T>VTAS<T>, Venta:Venta.Mov))>0<BR>    Entonces<BR>        Si (SQL(<T>Select COUNT(*) From TablaStd where TablaSt=:tda and Nombre in (SELECT ACCESO FROM USUARIO WHERE Usuario =:tUsu)<T>,<T>CFD PERFILES P/IMPRESION<T>,Usuario)>0)<BR>            entonces<BR>                Si (SQL(<T>exec SP_MaviDM0116BuscarCombinacion :nFas, :nId, :nSuc, :tMov, :tMovId, :tCond, :tCat<T>, 4, Venta:Venta.ID, Venta:Venta.SucursalDestino, Venta:Venta.Mov,  Venta:Venta.MovID, Venta:Venta.Condicion, Venta:CteEnviarA.Categoria)=<T>TICKET<T>)<BR>                    entonces<BR>                        SI SQL(<T>SELECT COUNT(Numero) FROM dbo.TablaNumD WHERE TablaNum=:tTab AND CAST<CONTINUA>
;Expresion002=<CONTINUA>(Numero AS INT)=:nSuc<T>, <T>SUCURSALES RDP<T>, Sucursal)=1<BR>                            Entonces<BR>                                Ejecutar(<T>PlugIns\RutaTicket.exe <T>+<T>VTAS<T>+<T> <T>+Venta:Venta.ID+<T> <T>+Usuario+<T> <T>+<T>1<T>+<T> <T>+Sucursal+<T> <T>+EstacionTrabajo)<BR>                            Sino<BR>                                Ejecutar(<T>C:\AppsMavi\Factura.exe <T>+Venta:Venta.ID+<T> <T>+Usuario+<T> 1 <T>+Sucursal)<BR>                        Fin<BR>                    Sino<BR>                        Si (SQL(<T>exec SP_MaviDM0116BuscarCombinacion :nFas, :nId, :nSuc, :tMov, :tMovId, :tCond, :tCat<T>, 4, Venta:Venta.ID, Venta:Venta.SucursalDestino, Venta:Venta.Mov,  Venta:Venta.MovID, Venta:Venta.Condicion, Venta:CteEnviarA.Categoria)=<T>CARTA<T>)<BR>                 <CONTINUA>
;Expresion003=<CONTINUA>           entonces<BR>                                Si (SQL(<T>Select left(Valor,1) From TablaStd where TablaSt=:tda and Nombre in (SELECT ACCESO FROM USUARIO WHERE Usuario =:tUsu)<T>,<T>CFD PERFILES P/IMPRESION<T>,Usuario)=1)<BR>                                    entonces<BR>                                        Si (SQL(<T>Select right(Valor,1) From TablaStd where TablaSt=:tda and Nombre in (SELECT ACCESO FROM USUARIO WHERE Usuario =:tUsu)<T>,<T>CFD PERFILES P/IMPRESION<T>,Usuario)=1)<BR>                                            entonces<BR>                                                Si (SQL(<T>exec SP_MaviDM0116BuscarCombinacion :nFas, :nId, :nSuc, :tMov, :tMovId, :tCond, :tCat<T>, 3, Venta:Venta.ID, Venta:Venta.SucursalDestino, Venta:Venta.Mov,  Venta:Venta.MovID, Venta:Vent<CONTINUA>
;Expresion004=<CONTINUA>a.Condicion, Venta:CteEnviarA.Categoria)=<T>111<T>)<BR>                                                    Entonces<BR>                                                        ReporteImpresora(<T>FacturaMAVIMayoreo12Imp<T>,Venta:Venta.ID,2)<BR>                                                        EjecutarSQL(<T>spConsecutivoImpresion :nID, :ncom<T>, Info.ID, 2)<BR>                                                        ReporteImpresora(<T>FacturaMAVIMayoreo12Imp<T>,Venta:Venta.ID,3)<BR>                                                        EjecutarSQL(<T>spConsecutivoImpresion :nID, :ncom<T>, Info.ID, 1)<BR>                                                        Si VentaD:Art.Linea = (SQL(<T>SELECT Nombre FROM TablaSTD WHERE TablaSt = :tConv AND Nombre = :tLinea<T>, <T>EXCEPCIONES DM0116<CONTINUA>
;Expresion005=<CONTINUA> IMPRESION CO<T>, VentaD:Art.Linea))<BR>                                                            entonces<BR>                                                                ReporteImpresora(<T>FacturaMAVIMayoreo12Imp<T>,Venta:Venta.ID,1)<BR>                                                                EjecutarSQL(<T>spConsecutivoImpresion :nID, :ncom<T>, Info.ID, 3)<BR>                                                            sino<BR>                                                                Si (SQL(<T>exec SP_MaviDM0116BuscarCombinacion :nFas, :nId, :nSuc, :tMov, :tMovId, :tCond, :tCat<T>, 2, Venta:Venta.ID, Venta:Venta.SucursalDestino, Venta:Venta.Mov,  Venta:Venta.MovID, Venta:Venta.Condicion, Venta:CteEnviarA.Categoria)=0)<BR>                                                <CONTINUA>
;Expresion006=<CONTINUA>                    Entonces<BR>                                                                        ReporteImpresora(<T>FacturaMAVIMayoreo12Imp<T>,Venta:Venta.ID,1)<BR>                                                                        EjecutarSQL(<T>spConsecutivoImpresion :nID, :ncom<T>, Info.ID, 3)<BR>                                                                    Sino<BR>                                                                        Si (SQL(<T>exec SP_MaviDM0116BuscarCombinacion :nFas, :nId, :nSuc, :tMov, :tMovId, :tCond, :tCat<T>, 2, Venta:Venta.ID, Venta:Venta.SucursalDestino, Venta:Venta.Mov,  Venta:Venta.MovID, Venta:Venta.Condicion, Venta:CteEnviarA.Categoria)>=<BR>                                                                            (SQL(<T>Select Sum(A.<CONTINUA>
;Expresion007=<CONTINUA>Saldo) As Saldo From CxcPendiente A Where A.PadreMavi = :tMov and A.PadreIdMavi = :tMovId Group By A.PadreMavi, A.PadreIDMavi<T>, Venta:Venta.Mov,  Venta:Venta.MovID)))<BR>                                                                            Entonces<BR>                                                                                ReporteImpresora(<T>FacturaMAVIMayoreo12Imp<T>,Venta:Venta.ID,1)<BR>                                                                                EjecutarSQL(<T>spConsecutivoImpresion :nID, :ncom<T>, Info.ID, 3)<BR>                                                                        Fin<BR>                                                                Fin<BR>                                                        Fin<BR>                              <CONTINUA>
;Expresion008=<CONTINUA>                      Sino<BR>                                                        Si (SQL(<T>exec SP_MaviDM0116BuscarCombinacion :nFas, :nId, :nSuc, :tMov, :tMovId, :tCond, :tCat<T>, 3, Venta:Venta.ID, Venta:Venta.SucursalDestino, Venta:Venta.Mov,  Venta:Venta.MovID, Venta:Venta.Condicion, Venta:CteEnviarA.Categoria)=<T>110<T>)<BR>                                                            Entonces<BR>                                                                ReporteImpresora(<T>FacturaMAVIMayoreo12Imp<T>,Venta:Venta.ID,2)<BR>                                                                EjecutarSQL(<T>spConsecutivoImpresion :nID, :ncom<T>, Info.ID, 2)<BR>                                                                Si VentaD:Art.Linea = (SQL(<T>SELECT Nombre FROM TablaSTD WHER<CONTINUA>
;Expresion009=<CONTINUA>E TablaSt = :tConv AND Nombre = :tLinea<T>, <T>EXCEPCIONES DM0116 IMPRESION CO<T>, VentaD:Art.Linea))<BR>                                                                    entonces<BR>                                                                        ReporteImpresora(<T>FacturaMAVIMayoreo12Imp<T>,Venta:Venta.ID,1)<BR>                                                                        EjecutarSQL(<T>spConsecutivoImpresion :nID, :ncom<T>, Info.ID, 3)<BR>                                                                    sino<BR>                                                                        Si (SQL(<T>exec SP_MaviDM0116BuscarCombinacion :nFas, :nId, :nSuc, :tMov, :tMovId, :tCond, :tCat<T>, 2, Venta:Venta.ID, Venta:Venta.SucursalDestino, Venta:Venta.Mov,  Venta:Venta.MovID, <CONTINUA>
;Expresion010=<CONTINUA>Venta:Venta.Condicion, Venta:CteEnviarA.Categoria)=0)<BR>                                                                            Entonces<BR>                                                                                ReporteImpresora(<T>FacturaMAVIMayoreo12Imp<T>,Venta:Venta.ID,1)<BR>                                                                                EjecutarSQL(<T>spConsecutivoImpresion :nID, :ncom<T>, Info.ID, 3)<BR>                                                                            Sino<BR>                                                                                Si (SQL(<T>exec SP_MaviDM0116BuscarCombinacion :nFas, :nId, :nSuc, :tMov, :tMovId, :tCond, :tCat<T>, 2, Venta:Venta.ID, Venta:Venta.SucursalDestino, Venta:Venta.Mov,  Venta:Venta.MovID, Venta:Ve<CONTINUA>
;Expresion011=<CONTINUA>nta.Condicion, Venta:CteEnviarA.Categoria)>=<BR>                                                                                    (SQL(<T>Select Sum(A.Saldo) As Saldo From CxcPendiente A Where A.PadreMavi = :tMov and A.PadreIdMavi = :tMovId Group By A.PadreMavi, A.PadreIDMavi<T>, Venta:Venta.Mov,  Venta:Venta.MovID)))<BR>                                                                                    Entonces<BR>                                                                                        ReporteImpresora(<T>FacturaMAVIMayoreo12Imp<T>,Venta:Venta.ID,1)<BR>                                                                                        EjecutarSQL(<T>spConsecutivoImpresion :nID, :ncom<T>, Info.ID, 3)<BR>                                                                  <CONTINUA>
;Expresion012=<CONTINUA>              Fin<BR>                                                                        Fin<BR>                                                                Fin<BR>                                                            Sino<BR>                                                                Si (SQL(<T>exec SP_MaviDM0116BuscarCombinacion :nFas, :nId, :nSuc, :tMov, :tMovId, :tCond, :tCat<T>, 3, Venta:Venta.ID, Venta:Venta.SucursalDestino, Venta:Venta.Mov,  Venta:Venta.MovID, Venta:Venta.Condicion, Venta:CteEnviarA.Categoria)=<T>101<T>)<BR>                                                                    Entonces<BR>                                                                        ReporteImpresora(<T>FacturaMAVIMayoreo12Imp<T>,Venta:Venta.ID,3)<BR>                          <CONTINUA>
;Expresion013=<CONTINUA>                                              EjecutarSQL(<T>spConsecutivoImpresion :nID, :ncom<T>, Info.ID, 1)<BR>                                                                        Si VentaD:Art.Linea = (SQL(<T>SELECT Nombre FROM TablaSTD WHERE TablaSt = :tConv AND Nombre = :tLinea<T>, <T>EXCEPCIONES DM0116 IMPRESION CO<T>, VentaD:Art.Linea))<BR>                                                                            entonces<BR>                                                                                ReporteImpresora(<T>FacturaMAVIMayoreo12Imp<T>,Venta:Venta.ID,1)<BR>                                                                                EjecutarSQL(<T>spConsecutivoImpresion :nID, :ncom<T>, Info.ID, 3)<BR>                                                             <CONTINUA>
;Expresion014=<CONTINUA>               sino<BR>                                                                                Si (SQL(<T>exec SP_MaviDM0116BuscarCombinacion :nFas, :nId, :nSuc, :tMov, :tMovId, :tCond, :tCat<T>, 2, Venta:Venta.ID, Venta:Venta.SucursalDestino, Venta:Venta.Mov,  Venta:Venta.MovID, Venta:Venta.Condicion, Venta:CteEnviarA.Categoria)=0)<BR>                                                                                    Entonces<BR>                                                                                        ReporteImpresora(<T>FacturaMAVIMayoreo12Imp<T>,Venta:Venta.ID,1)<BR>                                                                                        EjecutarSQL(<T>spConsecutivoImpresion :nID, :ncom<T>, Info.ID, 3)<BR>                                             <CONTINUA>
;Expresion015=<CONTINUA>                                       Sino<BR>                                                                                        Si (SQL(<T>exec SP_MaviDM0116BuscarCombinacion :nFas, :nId, :nSuc, :tMov, :tMovId, :tCond, :tCat<T>, 2, Venta:Venta.ID, Venta:Venta.SucursalDestino, Venta:Venta.Mov,  Venta:Venta.MovID, Venta:Venta.Condicion, Venta:CteEnviarA.Categoria)>=<BR>                                                                                            (SQL(<T>Select Sum(A.Saldo) As Saldo From CxcPendiente A Where A.PadreMavi = :tMov and A.PadreIdMavi = :tMovId Group By A.PadreMavi, A.PadreIDMavi<T>, Venta:Venta.Mov,  Venta:Venta.MovID)))<BR>                                                                                            Entonces<BR>                                  <CONTINUA>
;Expresion016=<CONTINUA>                                                              ReporteImpresora(<T>FacturaMAVIMayoreo12Imp<T>,Venta:Venta.ID,1)<BR>                                                                                                EjecutarSQL(<T>spConsecutivoImpresion :nID, :ncom<T>, Info.ID, 3)<BR>                                                                                        Fin<BR>                                                                                Fin<BR>                                                                        Fin<BR>                                                                    Sino<BR>                                                                        Si (SQL(<T>exec SP_MaviDM0116BuscarCombinacion :nFas, :nId, :nSuc, :tMov, :tMovId, :tCond, :tCat<CONTINUA>
;Expresion017=<CONTINUA><T>, 3, Venta:Venta.ID, Venta:Venta.SucursalDestino, Venta:Venta.Mov,  Venta:Venta.MovID, Venta:Venta.Condicion, Venta:CteEnviarA.Categoria)=<T>100<T>)<BR>                                                                            Entonces<BR>                                                                                Si VentaD:Art.Linea = (SQL(<T>SELECT Nombre FROM TablaSTD WHERE TablaSt = :tConv AND Nombre = :tLinea<T>, <T>EXCEPCIONES DM0116 IMPRESION CO<T>, VentaD:Art.Linea))<BR>                                                                                    entonces<BR>                                                                                        ReporteImpresora(<T>FacturaMAVIMayoreo12Imp<T>,Venta:Venta.ID,1)<BR>                                                          <CONTINUA>
;Expresion018=<CONTINUA>                              EjecutarSQL(<T>spConsecutivoImpresion :nID, :ncom<T>, Info.ID, 3)<BR>                                                                                    sino<BR>                                                                                        Si (SQL(<T>exec SP_MaviDM0116BuscarCombinacion :nFas, :nId, :nSuc, :tMov, :tMovId, :tCond, :tCat<T>, 2, Venta:Venta.ID, Venta:Venta.SucursalDestino, Venta:Venta.Mov,  Venta:Venta.MovID, Venta:Venta.Condicion, Venta:CteEnviarA.Categoria)=0)<BR>                                                                                            Entonces<BR>                                                                                                ReporteImpresora(<T>FacturaMAVIMayoreo12Imp<T>,Venta:Venta.ID,1)<BR>          <CONTINUA>
;Expresion019=<CONTINUA>                                                                                      EjecutarSQL(<T>spConsecutivoImpresion :nID, :ncom<T>, Info.ID, 3)<BR>                                                                                            Sino<BR>                                                                                                Si (SQL(<T>exec SP_MaviDM0116BuscarCombinacion :nFas, :nId, :nSuc, :tMov, :tMovId, :tCond, :tCat<T>, 2, Venta:Venta.ID, Venta:Venta.SucursalDestino, Venta:Venta.Mov,  Venta:Venta.MovID, Venta:Venta.Condicion, Venta:CteEnviarA.Categoria)>=<BR>                                                                                                    (SQL(<T>Select Sum(A.Saldo) As Saldo From CxcPendiente A Where A.PadreMavi = :tMov and A.PadreIdMavi = :tMo<CONTINUA>
;Expresion020=<CONTINUA>vId Group By A.PadreMavi, A.PadreIDMavi<T>, Venta:Venta.Mov,  Venta:Venta.MovID)))<BR>                                                                                                    Entonces<BR>                                                                                                        ReporteImpresora(<T>FacturaMAVIMayoreo12Imp<T>,Venta:Venta.ID,1)<BR>                                                                                                        EjecutarSQL(<T>spConsecutivoImpresion :nID, :ncom<T>, Info.ID, 3)<BR>                                                                                                Fin<BR>                                                                                        Fin<BR>                                                           <CONTINUA>
;Expresion021=<CONTINUA>                     Fin<BR>                                                                            Sino<BR>                                                                                Si (SQL(<T>exec SP_MaviDM0116BuscarCombinacion :nFas, :nId, :nSuc, :tMov, :tMovId, :tCond, :tCat<T>, 3, Venta:Venta.ID, Venta:Venta.SucursalDestino, Venta:Venta.Mov,  Venta:Venta.MovID, Venta:Venta.Condicion, Venta:CteEnviarA.Categoria)=<T>011<T>)<BR>                                                                                    Entonces<BR>                                                                                        ReporteImpresora(<T>FacturaMAVIMayoreo12Imp<T>,Venta:Venta.ID,2)<BR>                                                                                        EjecutarSQL(<T>sp<CONTINUA>
;Expresion022=<CONTINUA>ConsecutivoImpresion :nID, :ncom<T>, Info.ID, 2)<BR>                                                                                        ReporteImpresora(<T>FacturaMAVIMayoreo12Imp<T>,Venta:Venta.ID,3)<BR>                                                                                        EjecutarSQL(<T>spConsecutivoImpresion :nID, :ncom<T>, Info.ID, 1)<BR>                                                                                    Sino<BR>                                                                                        Si (SQL(<T>exec SP_MaviDM0116BuscarCombinacion :nFas, :nId, :nSuc, :tMov, :tMovId, :tCond, :tCat<T>, 3, Venta:Venta.ID, Venta:Venta.SucursalDestino, Venta:Venta.Mov,  Venta:Venta.MovID, Venta:Venta.Condicion, Venta:CteEnviarA.Categoria)=<T>010<T>)<BR>    <CONTINUA>
;Expresion023=<CONTINUA>                                                                                        Entonces<BR>                                                                                                ReporteImpresora(<T>FacturaMAVIMayoreo12Imp<T>,Venta:Venta.ID,2)<BR>                                                                                                EjecutarSQL(<T>spConsecutivoImpresion :nID, :ncom<T>, Info.ID, 2)<BR>                                                                                            Sino<BR>                                                                                                Si (SQL(<T>exec SP_MaviDM0116BuscarCombinacion :nFas, :nId, :nSuc, :tMov, :tMovId, :tCond, :tCat<T>, 3, Venta:Venta.ID, Venta:Venta.SucursalDestino, Venta:Venta.Mov,  Venta:Ve<CONTINUA>
;Expresion024=<CONTINUA>nta.MovID, Venta:Venta.Condicion, Venta:CteEnviarA.Categoria)=<T>001<T>)<BR>                                                                                                    Entonces<BR>                                                                                                        ReporteImpresora(<T>FacturaMAVIMayoreo12Imp<T>,Venta:Venta.ID,3)<BR>                                                                                                        EjecutarSQL(<T>spConsecutivoImpresion :nID, :ncom<T>, Info.ID, 1)<BR>                                                                                                Fin<BR>                                                                                        Fin<BR>                                                                     <CONTINUA>
;Expresion025=<CONTINUA>           Fin<BR>                                                                        Fin<BR>                                                                Fin<BR>                                                        Fin<BR>                                                Fin<BR>                                            sino<BR>                                                Si (SQL(<T>exec SP_MaviDM0116BuscarCombinacion :nFas, :nId, :nSuc, :tMov, :tMovId, :tCond, :tCat<T>, 3, Venta:Venta.ID, Venta:Venta.SucursalDestino, Venta:Venta.Mov,  Venta:Venta.MovID, Venta:Venta.Condicion, Venta:CteEnviarA.Categoria)=<T>111<T>)<BR>                                                    Entonces<BR>                                                        si (sql(<T>select isnull(ContImpSimp,0) fro<CONTINUA>
;Expresion026=<CONTINUA>m venta where id=:nId<T>,Venta:Venta.ID)=0)<BR>                                                            entonces<BR>                                                                ReporteImpresora(<T>FacturaMAVIMayoreo12Imp<T>,Venta:Venta.ID,2)<BR>                                                                EjecutarSQL(<T>spConsecutivoImpresion :nID, :ncom<T>, Info.ID, 2)<BR>                                                            sino<BR>                                                                Informacion(<T>Este reporte <T>+ COMILLAS(<T>Copia<T>)+<T> ya fue impreso. Su perfil de usuario no cuenta con privilegios para poder hacer una reimpresión del mismo.<T>)<BR>                                                        Fin<BR>                                                <CONTINUA>
;Expresion027=<CONTINUA>        si (sql(<T>select isnull(ContImpCiego,0) from venta where id=:nId<T>,Venta:Venta.ID)=0)<BR>                                                            entonces<BR>                                                                ReporteImpresora(<T>FacturaMAVIMayoreo12Imp<T>,Venta:Venta.ID,3)<BR>                                                                EjecutarSQL(<T>spConsecutivoImpresion :nID, :ncom<T>, Info.ID, 1)<BR>                                                            sino<BR>                                                                Informacion(<T>Este reporte <T>+ COMILLAS(<T>Copia Embarque<T>)+<T> ya fue impreso. Su perfil de usuario no cuenta con privilegios para poder hacer una reimpresión del mismo.<T>)<BR>                                                  <CONTINUA>
;Expresion028=<CONTINUA>      Fin<BR>                                                        si (sql(<T>select isnull(ContImpCFD,0) from venta where id=:nId<T>,Venta:Venta.ID)=0)<BR>                                                            entonces<BR>                                                                Si VentaD:Art.Linea = (SQL(<T>SELECT Nombre FROM TablaSTD WHERE TablaSt = :tConv AND Nombre = :tLinea<T>, <T>EXCEPCIONES DM0116 IMPRESION CO<T>, VentaD:Art.Linea))<BR>                                                                    entonces<BR>                                                                        ReporteImpresora(<T>FacturaMAVIMayoreo12Imp<T>,Venta:Venta.ID,1)<BR>                                                                        EjecutarSQL(<T>spConsecutivoImpresion :nID, :nc<CONTINUA>
;Expresion029=<CONTINUA>om<T>, Info.ID, 3)<BR>                                                                    sino<BR>                                                                        Si (SQL(<T>exec SP_MaviDM0116BuscarCombinacion :nFas, :nId, :nSuc, :tMov, :tMovId, :tCond, :tCat<T>, 2, Venta:Venta.ID, Venta:Venta.SucursalDestino, Venta:Venta.Mov,  Venta:Venta.MovID, Venta:Venta.Condicion, Venta:CteEnviarA.Categoria)=0)<BR>                                                                            Entonces<BR>                                                                                ReporteImpresora(<T>FacturaMAVIMayoreo12Imp<T>,Venta:Venta.ID,1)<BR>                                                                                EjecutarSQL(<T>spConsecutivoImpresion :nID, :ncom<T>, Info.ID, 3)<BR>  <CONTINUA>
;Expresion030=<CONTINUA>                                                                          Sino<BR>                                                                                Si (SQL(<T>exec SP_MaviDM0116BuscarCombinacion :nFas, :nId, :nSuc, :tMov, :tMovId, :tCond, :tCat<T>, 2, Venta:Venta.ID, Venta:Venta.SucursalDestino, Venta:Venta.Mov,  Venta:Venta.MovID, Venta:Venta.Condicion, Venta:CteEnviarA.Categoria)>=<BR>                                                                                    (SQL(<T>Select Sum(A.Saldo) As Saldo From CxcPendiente A Where A.PadreMavi = :tMov and A.PadreIdMavi = :tMovId Group By A.PadreMavi, A.PadreIDMavi<T>, Venta:Venta.Mov,  Venta:Venta.MovID)))<BR>                                                                                    Entonces<BR>                       <CONTINUA>
;Expresion031=<CONTINUA>                                                                 ReporteImpresora(<T>FacturaMAVIMayoreo12Imp<T>,Venta:Venta.ID,1)<BR>                                                                                        EjecutarSQL(<T>spConsecutivoImpresion :nID, :ncom<T>, Info.ID, 3)<BR>                                                                                Fin<BR>                                                                        Fin<BR>                                                                Fin<BR>                                                            sino<BR>                                                                Informacion(<T>Este reporte <T>+ COMILLAS(<T>CFD<T>)+<T> ya fue impreso. Su perfil de usuario no cuenta con privilegios para poder hacer una <CONTINUA>
;Expresion032=<CONTINUA>reimpresión del mismo.<T>)<BR>                                                        Fin<BR>                                                    Sino<BR>                                                        Si (SQL(<T>exec SP_MaviDM0116BuscarCombinacion :nFas, :nId, :nSuc, :tMov, :tMovId, :tCond, :tCat<T>, 3, Venta:Venta.ID, Venta:Venta.SucursalDestino, Venta:Venta.Mov,  Venta:Venta.MovID, Venta:Venta.Condicion, Venta:CteEnviarA.Categoria)=<T>110<T>)<BR>                                                            Entonces<BR>                                                                si (sql(<T>select isnull(ContImpSimp,0) from venta where id=:nId<T>,Venta:Venta.ID)=0)<BR>                                                                    entonces<BR>                                  <CONTINUA>
;Expresion033=<CONTINUA>                                      ReporteImpresora(<T>FacturaMAVIMayoreo12Imp<T>,Venta:Venta.ID,2)<BR>                                                                        EjecutarSQL(<T>spConsecutivoImpresion :nID, :ncom<T>, Info.ID, 2)<BR>                                                                    sino<BR>                                                                        Informacion(<T>Este reporte <T>+ COMILLAS(<T>Copia<T>)+<T> ya fue impreso. Su perfil de usuario no cuenta con privilegios para poder hacer una reimpresión del mismo.<T>)<BR>                                                                Fin<BR>                                                                si (sql(<T>select isnull(ContImpCFD,0) from venta where id=:nId<T>,Venta:Venta.ID)=0)<BR>        <CONTINUA>
;Expresion034=<CONTINUA>                                                            entonces<BR>                                                                        Si VentaD:Art.Linea = (SQL(<T>SELECT Nombre FROM TablaSTD WHERE TablaSt = :tConv AND Nombre = :tLinea<T>, <T>EXCEPCIONES DM0116 IMPRESION CO<T>, VentaD:Art.Linea))<BR>                                                                            entonces<BR>                                                                                ReporteImpresora(<T>FacturaMAVIMayoreo12Imp<T>,Venta:Venta.ID,1)<BR>                                                                                EjecutarSQL(<T>spConsecutivoImpresion :nID, :ncom<T>, Info.ID, 3)<BR>                                                                            sino<BR>                    <CONTINUA>
;Expresion035=<CONTINUA>                                                            Si (SQL(<T>exec SP_MaviDM0116BuscarCombinacion :nFas, :nId, :nSuc, :tMov, :tMovId, :tCond, :tCat<T>, 2, Venta:Venta.ID, Venta:Venta.SucursalDestino, Venta:Venta.Mov,  Venta:Venta.MovID, Venta:Venta.Condicion, Venta:CteEnviarA.Categoria)=0)<BR>                                                                                    Entonces<BR>                                                                                        ReporteImpresora(<T>FacturaMAVIMayoreo12Imp<T>,Venta:Venta.ID,1)<BR>                                                                                        EjecutarSQL(<T>spConsecutivoImpresion :nID, :ncom<T>, Info.ID, 3)<BR>                                                                                    Sino<CONTINUA>
;Expresion036=<CONTINUA><BR>                                                                                        Si (SQL(<T>exec SP_MaviDM0116BuscarCombinacion :nFas, :nId, :nSuc, :tMov, :tMovId, :tCond, :tCat<T>, 2, Venta:Venta.ID, Venta:Venta.SucursalDestino, Venta:Venta.Mov,  Venta:Venta.MovID, Venta:Venta.Condicion, Venta:CteEnviarA.Categoria)>=<BR>                                                                                            (SQL(<T>Select Sum(A.Saldo) As Saldo From CxcPendiente A Where A.PadreMavi = :tMov and A.PadreIdMavi = :tMovId Group By A.PadreMavi, A.PadreIDMavi<T>, Venta:Venta.Mov,  Venta:Venta.MovID)))<BR>                                                                                            Entonces<BR>                                                                             <CONTINUA>
;Expresion037=<CONTINUA>                   ReporteImpresora(<T>FacturaMAVIMayoreo12Imp<T>,Venta:Venta.ID,1)<BR>                                                                                                EjecutarSQL(<T>spConsecutivoImpresion :nID, :ncom<T>, Info.ID, 3)<BR>                                                                                        Fin<BR>                                                                                Fin<BR>                                                                        Fin<BR>                                                                    sino<BR>                                                                        Informacion(<T>Este reporte <T>+ COMILLAS(<T>CFD<T>)+<T> ya fue impreso. Su perfil de usuario no cuenta con privilegios para poder hacer un<CONTINUA>
;Expresion038=<CONTINUA>a reimpresión del mismo.<T>)<BR>                                                                Fin    <BR>                                                            Sino<BR>                                                                Si (SQL(<T>exec SP_MaviDM0116BuscarCombinacion :nFas, :nId, :nSuc, :tMov, :tMovId, :tCond, :tCat<T>, 3, Venta:Venta.ID, Venta:Venta.SucursalDestino, Venta:Venta.Mov,  Venta:Venta.MovID, Venta:Venta.Condicion, Venta:CteEnviarA.Categoria)=<T>101<T>)<BR>                                                                    Entonces<BR>                                                                        si (sql(<T>select isnull(ContImpCiego,0) from venta where id=:nId<T>,Venta:Venta.ID)=0)<BR>                                                                   <CONTINUA>
;Expresion039=<CONTINUA>         entonces<BR>                                                                                ReporteImpresora(<T>FacturaMAVIMayoreo12Imp<T>,Venta:Venta.ID,3)<BR>                                                                                EjecutarSQL(<T>spConsecutivoImpresion :nID, :ncom<T>, Info.ID, 1)<BR>                                                                            sino<BR>                                                                                Informacion(<T>Este reporte <T>+ COMILLAS(<T>Copia Embarque<T>)+<T> ya fue impreso. Su perfil de usuario no cuenta con privilegios para poder hacer una reimpresión del mismo.<T>)<BR>                                                                        Fin <BR>                                                        <CONTINUA>
;Expresion040=<CONTINUA>                si (sql(<T>select isnull(ContImpCFD,0) from venta where id=:nId<T>,Venta:Venta.ID)=0)<BR>                                                                            entonces<BR>                                                                                Si VentaD:Art.Linea = (SQL(<T>SELECT Nombre FROM TablaSTD WHERE TablaSt = :tConv AND Nombre = :tLinea<T>, <T>EXCEPCIONES DM0116 IMPRESION CO<T>, VentaD:Art.Linea))<BR>                                                                                    entonces<BR>                                                                                        ReporteImpresora(<T>FacturaMAVIMayoreo12Imp<T>,Venta:Venta.ID,1)<BR>                                                                                        EjecutarSQL(<T>spCon<CONTINUA>
;Expresion041=<CONTINUA>secutivoImpresion :nID, :ncom<T>, Info.ID, 3)<BR>                                                                                    sino<BR>                                                                                        Si (SQL(<T>exec SP_MaviDM0116BuscarCombinacion :nFas, :nId, :nSuc, :tMov, :tMovId, :tCond, :tCat<T>, 2, Venta:Venta.ID, Venta:Venta.SucursalDestino, Venta:Venta.Mov,  Venta:Venta.MovID, Venta:Venta.Condicion, Venta:CteEnviarA.Categoria)=0)<BR>                                                                                            Entonces<BR>                                                                                                ReporteImpresora(<T>FacturaMAVIMayoreo12Imp<T>,Venta:Venta.ID,1)<BR>                                                            <CONTINUA>
;Expresion042=<CONTINUA>                                    EjecutarSQL(<T>spConsecutivoImpresion :nID, :ncom<T>, Info.ID, 3)<BR>                                                                                            Sino<BR>                                                                                                Si (SQL(<T>exec SP_MaviDM0116BuscarCombinacion :nFas, :nId, :nSuc, :tMov, :tMovId, :tCond, :tCat<T>, 2, Venta:Venta.ID, Venta:Venta.SucursalDestino, Venta:Venta.Mov,  Venta:Venta.MovID, Venta:Venta.Condicion, Venta:CteEnviarA.Categoria)>=<BR>                                                                                                    (SQL(<T>Select Sum(A.Saldo) As Saldo From CxcPendiente A Where A.PadreMavi = :tMov and A.PadreIdMavi = :tMovId Group By A.PadreMavi, A.PadreIDMavi<T>, Venta:<CONTINUA>
;Expresion043=<CONTINUA>Venta.Mov,  Venta:Venta.MovID)))<BR>                                                                                                    Entonces<BR>                                                                                                        ReporteImpresora(<T>FacturaMAVIMayoreo12Imp<T>,Venta:Venta.ID,1)<BR>                                                                                                        EjecutarSQL(<T>spConsecutivoImpresion :nID, :ncom<T>, Info.ID, 3)<BR>                                                                                                Fin<BR>                                                                                        Fin<BR>                                                                                Fin<BR>                      <CONTINUA>
;Expresion044=<CONTINUA>                                                      sino<BR>                                                                                Informacion(<T>Este reporte <T>+ COMILLAS(<T>CFD<T>)+<T> ya fue impreso. Su perfil de usuario no cuenta con privilegios para poder hacer una reimpresión del mismo.<T>)<BR>                                                                        Fin   <BR>                                                                    Sino<BR>                                                                        Si (SQL(<T>exec SP_MaviDM0116BuscarCombinacion :nFas, :nId, :nSuc, :tMov, :tMovId, :tCond, :tCat<T>, 3, Venta:Venta.ID, Venta:Venta.SucursalDestino, Venta:Venta.Mov,  Venta:Venta.MovID, Venta:Venta.Condicion, Venta:CteEnviarA.Categoria)=<T>100<T>)<BR>      <CONTINUA>
;Expresion045=<CONTINUA>                                                                      Entonces<BR>                                                                                si (sql(<T>select isnull(ContImpCFD,0) from venta where id=:nId<T>,Venta:Venta.ID)=0)<BR>                                                                                    entonces<BR>                                                                                        Si VentaD:Art.Linea = (SQL(<T>SELECT Nombre FROM TablaSTD WHERE TablaSt = :tConv AND Nombre = :tLinea<T>, <T>EXCEPCIONES DM0116 IMPRESION CO<T>, VentaD:Art.Linea))<BR>                                                                                            entonces<BR>                                                                                              <CONTINUA>
;Expresion046=<CONTINUA>  ReporteImpresora(<T>FacturaMAVIMayoreo12Imp<T>,Venta:Venta.ID,1)<BR>                                                                                                EjecutarSQL(<T>spConsecutivoImpresion :nID, :ncom<T>, Info.ID, 3)<BR>                                                                                            sino<BR>                                                                                                Si (SQL(<T>exec SP_MaviDM0116BuscarCombinacion :nFas, :nId, :nSuc, :tMov, :tMovId, :tCond, :tCat<T>, 2, Venta:Venta.ID, Venta:Venta.SucursalDestino, Venta:Venta.Mov,  Venta:Venta.MovID, Venta:Venta.Condicion, Venta:CteEnviarA.Categoria)=0)<BR>                                                                                                    Entonces<BR>              <CONTINUA>
;Expresion047=<CONTINUA>                                                                                          ReporteImpresora(<T>FacturaMAVIMayoreo12Imp<T>,Venta:Venta.ID,1)<BR>                                                                                                        EjecutarSQL(<T>spConsecutivoImpresion :nID, :ncom<T>, Info.ID, 3)<BR>                                                                                                    Sino<BR>                                                                                                        Si (SQL(<T>exec SP_MaviDM0116BuscarCombinacion :nFas, :nId, :nSuc, :tMov, :tMovId, :tCond, :tCat<T>, 2, Venta:Venta.ID, Venta:Venta.SucursalDestino, Venta:Venta.Mov,  Venta:Venta.MovID, Venta:Venta.Condicion, Venta:CteEnviarA.Categoria)>=<BR>               <CONTINUA>
;Expresion048=<CONTINUA>                                                                                             (SQL(<T>Select Sum(A.Saldo) As Saldo From CxcPendiente A Where A.PadreMavi = :tMov and A.PadreIdMavi = :tMovId Group By A.PadreMavi, A.PadreIDMavi<T>, Venta:Venta.Mov,  Venta:Venta.MovID)))<BR>                                                                                                            Entonces<BR>                                                                                                                ReporteImpresora(<T>FacturaMAVIMayoreo12Imp<T>,Venta:Venta.ID,1)<BR>                                                                                                                EjecutarSQL(<T>spConsecutivoImpresion :nID, :ncom<T>, Info.ID, 3)<BR>                                 <CONTINUA>
;Expresion049=<CONTINUA>                                                                       Fin<BR>                                                                                                Fin<BR>                                                                                        Fin<BR>                                                                                    sino<BR>                                                                                        Informacion(<T>Este reporte <T>+ COMILLAS(<T>CFD<T>)+<T> ya fue impreso. Su perfil de usuario no cuenta con privilegios para poder hacer una reimpresión del mismo.<T>)<BR>                                                                                Fin<BR>                                                                            Sino<BR>  <CONTINUA>
;Expresion050=<CONTINUA>                                                                              Si (SQL(<T>exec SP_MaviDM0116BuscarCombinacion :nFas, :nId, :nSuc, :tMov, :tMovId, :tCond, :tCat<T>, 3, Venta:Venta.ID, Venta:Venta.SucursalDestino, Venta:Venta.Mov,  Venta:Venta.MovID, Venta:Venta.Condicion, Venta:CteEnviarA.Categoria)=<T>011<T>)<BR>                                                                                    Entonces<BR>                                                                                        si (sql(<T>select isnull(ContImpSimp,0) from venta where id=:nId<T>,Venta:Venta.ID)=0)<BR>                                                                                            entonces<BR>                                                                                             <CONTINUA>
;Expresion051=<CONTINUA>   ReporteImpresora(<T>FacturaMAVIMayoreo12Imp<T>,Venta:Venta.ID,2)<BR>                                                                                                EjecutarSQL(<T>spConsecutivoImpresion :nID, :ncom<T>, Info.ID, 2)<BR>                                                                                            sino<BR>                                                                                                Informacion(<T>Este reporte <T>+ COMILLAS(<T>Copia<T>)+<T> ya fue impreso. Su perfil de usuario no cuenta con privilegios para poder hacer una reimpresión del mismo.<T>)<BR>                                                                                        Fin<BR>                                                                                        si (sql(<T>s<CONTINUA>
;Expresion052=<CONTINUA>elect isnull(ContImpCiego,0) from venta where id=:nId<T>,Venta:Venta.ID)=0)<BR>                                                                                            entonces<BR>                                                                                                ReporteImpresora(<T>FacturaMAVIMayoreo12Imp<T>,Venta:Venta.ID,3)<BR>                                                                                                EjecutarSQL(<T>spConsecutivoImpresion :nID, :ncom<T>, Info.ID, 1)<BR>                                                                                            sino<BR>                                                                                                Informacion(<T>Este reporte <T>+ COMILLAS(<T>Copia Embarque<T>)+<T> ya fue impreso. Su perfi<CONTINUA>
;Expresion053=<CONTINUA>l de usuario no cuenta con privilegios para poder hacer una reimpresión del mismo.<T>)<BR>                                                                                        Fin<BR>                                                                                    Sino<BR>                                                                                        Si (SQL(<T>exec SP_MaviDM0116BuscarCombinacion :nFas, :nId, :nSuc, :tMov, :tMovId, :tCond, :tCat<T>, 3, Venta:Venta.ID, Venta:Venta.SucursalDestino, Venta:Venta.Mov,  Venta:Venta.MovID, Venta:Venta.Condicion, Venta:CteEnviarA.Categoria)=<T>010<T>)<BR>                                                                                            Entonces<BR>                                                                                <CONTINUA>
;Expresion054=<CONTINUA>                si (sql(<T>select isnull(ContImpSimp,0) from venta where id=:nId<T>,Venta:Venta.ID)=0)<BR>                                                                                                    entonces<BR>                                                                                                        ReporteImpresora(<T>FacturaMAVIMayoreo12Imp<T>,Venta:Venta.ID,2)<BR>                                                                                                        EjecutarSQL(<T>spConsecutivoImpresion :nID, :ncom<T>, Info.ID, 2)<BR>                                                                                                    sino<BR>                                                                                                        Informacion(<T>Este repor<CONTINUA>
;Expresion055=<CONTINUA>te <T>+ COMILLAS(<T>Copia<T>)+<T> ya fue impreso. Su perfil de usuario no cuenta con privilegios para poder hacer una reimpresión del mismo.<T>)<BR>                                                                                                Fin<BR>                                                                                            Sino<BR>                                                                                                Si (SQL(<T>exec SP_MaviDM0116BuscarCombinacion :nFas, :nId, :nSuc, :tMov, :tMovId, :tCond, :tCat<T>, 3, Venta:Venta.ID, Venta:Venta.SucursalDestino, Venta:Venta.Mov,  Venta:Venta.MovID, Venta:Venta.Condicion, Venta:CteEnviarA.Categoria)=<T>001<T>)<BR>                                                                                                    En<CONTINUA>
;Expresion056=<CONTINUA>tonces<BR>                                                                                                        si (sql(<T>select isnull(ContImpCiego,0) from venta where id=:nId<T>,Venta:Venta.ID)=0)<BR>                                                                                                            entonces<BR>                                                                                                                ReporteImpresora(<T>FacturaMAVIMayoreo12Imp<T>,Venta:Venta.ID,3)<BR>                                                                                                                EjecutarSQL(<T>spConsecutivoImpresion :nID, :ncom<T>, Info.ID, 1)<BR>                                                                                                            sino<B<CONTINUA>
;Expresion057=<CONTINUA>R>                                                                                                                Informacion(<T>Este reporte <T>+ COMILLAS(<T>Copia Embarque<T>)+<T> ya fue impreso. Su perfil de usuario no cuenta con privilegios para poder hacer una reimpresión del mismo.<T>)<BR>                                                                                                        Fin<BR>                                                                                                Fin<BR>                                                                                        Fin<BR>                                                                                Fin<BR>                                                                        Fin<BR>                             <CONTINUA>
;Expresion058=<CONTINUA>                                   Fin<BR>                                                        Fin<BR>                                                Fin<BR>                                        Fin<BR>                                    sino<BR>                                        Si (SQL(<T>Select right(Valor,1) From TablaStd where TablaSt=:tda and Nombre in (SELECT ACCESO FROM USUARIO WHERE Usuario =:tUsu)<T>,<T>CFD PERFILES P/IMPRESION<T>,Usuario)=1)<BR>                                            entonces<BR>                                                Si (SQL(<T>exec SP_MaviDM0116BuscarCombinacion :nFas, :nId, :nSuc, :tMov, :tMovId, :tCond, :tCat<T>, 3, Venta:Venta.ID, Venta:Venta.SucursalDestino, Venta:Venta.Mov,  Venta:Venta.MovID, Venta:Venta.Condicion, Venta:CteEnviarA.<CONTINUA>
;Expresion059=<CONTINUA>Categoria)=<T>111<T>)<BR>                                                    Entonces<BR>                                                        ReporteImpresora(<T>FacturaMAVIMayoreo12Imp<T>,Venta:Venta.ID,2)<BR>                                                        EjecutarSQL(<T>spConsecutivoImpresion :nID, :ncom<T>, Info.ID, 2)<BR>                                                        ReporteImpresora(<T>FacturaMAVIMayoreo12Imp<T>,Venta:Venta.ID,3)<BR>                                                        EjecutarSQL(<T>spConsecutivoImpresion :nID, :ncom<T>, Info.ID, 1)<BR>                                                        ReporteImpresora(<T>FacturaMAVIMayoreo12Imp<T>,Venta:Venta.ID,1)<BR>                                                        EjecutarSQL(<T>spConsecutivoImpre<CONTINUA>
;Expresion060=<CONTINUA>sion :nID, :ncom<T>, Info.ID, 3)<BR>                                                    Sino<BR>                                                        Si (SQL(<T>exec SP_MaviDM0116BuscarCombinacion :nFas, :nId, :nSuc, :tMov, :tMovId, :tCond, :tCat<T>, 3, Venta:Venta.ID, Venta:Venta.SucursalDestino, Venta:Venta.Mov,  Venta:Venta.MovID, Venta:Venta.Condicion, Venta:CteEnviarA.Categoria)=<T>110<T>)<BR>                                                            Entonces<BR>                                                                ReporteImpresora(<T>FacturaMAVIMayoreo12Imp<T>,Venta:Venta.ID,2)<BR>                                                                EjecutarSQL(<T>spConsecutivoImpresion :nID, :ncom<T>, Info.ID, 2)<BR>                                                            <CONTINUA>
;Expresion061=<CONTINUA>    ReporteImpresora(<T>FacturaMAVIMayoreo12Imp<T>,Venta:Venta.ID,1)<BR>                                                                EjecutarSQL(<T>spConsecutivoImpresion :nID, :ncom<T>, Info.ID, 3)<BR>                                                            Sino<BR>                                                                Si (SQL(<T>exec SP_MaviDM0116BuscarCombinacion :nFas, :nId, :nSuc, :tMov, :tMovId, :tCond, :tCat<T>, 3, Venta:Venta.ID, Venta:Venta.SucursalDestino, Venta:Venta.Mov,  Venta:Venta.MovID, Venta:Venta.Condicion, Venta:CteEnviarA.Categoria)=<T>101<T>)<BR>                                                                    Entonces<BR>                                                                        ReporteImpresora(<T>FacturaMAVIMayoreo12Imp<T>,Venta:Venta.I<CONTINUA>
;Expresion062=<CONTINUA>D,3)<BR>                                                                        EjecutarSQL(<T>spConsecutivoImpresion :nID, :ncom<T>, Info.ID, 1)<BR>                                                                        ReporteImpresora(<T>FacturaMAVIMayoreo12Imp<T>,Venta:Venta.ID,1)<BR>                                                                        EjecutarSQL(<T>spConsecutivoImpresion :nID, :ncom<T>, Info.ID, 3)<BR>                                                                    Sino<BR>                                                                        Si (SQL(<T>exec SP_MaviDM0116BuscarCombinacion :nFas, :nId, :nSuc, :tMov, :tMovId, :tCond, :tCat<T>, 3, Venta:Venta.ID, Venta:Venta.SucursalDestino, Venta:Venta.Mov,  Venta:Venta.MovID, Venta:Venta.Condicion, Venta:CteEnvi<CONTINUA>
;Expresion063=<CONTINUA>arA.Categoria)=<T>100<T>)<BR>                                                                            Entonces<BR>                                                                                ReporteImpresora(<T>FacturaMAVIMayoreo12Imp<T>,Venta:Venta.ID,1)<BR>                                                                                EjecutarSQL(<T>spConsecutivoImpresion :nID, :ncom<T>, Info.ID, 3)<BR>                                                                            Sino<BR>                                                                                Si (SQL(<T>exec SP_MaviDM0116BuscarCombinacion :nFas, :nId, :nSuc, :tMov, :tMovId, :tCond, :tCat<T>, 3, Venta:Venta.ID, Venta:Venta.SucursalDestino, Venta:Venta.Mov,  Venta:Venta.MovID, Venta:Venta.Condicion, Venta:CteEnvi<CONTINUA>
;Expresion064=<CONTINUA>arA.Categoria)=<T>011<T>)<BR>                                                                                    Entonces<BR>                                                                                        ReporteImpresora(<T>FacturaMAVIMayoreo12Imp<T>,Venta:Venta.ID,2)<BR>                                                                                        EjecutarSQL(<T>spConsecutivoImpresion :nID, :ncom<T>, Info.ID, 2)<BR>                                                                                        ReporteImpresora(<T>FacturaMAVIMayoreo12Imp<T>,Venta:Venta.ID,3)<BR>                                                                                        EjecutarSQL(<T>spConsecutivoImpresion :nID, :ncom<T>, Info.ID, 1)<BR>                                                 <CONTINUA>
;Expresion065=<CONTINUA>                                   Sino<BR>                                                                                        Si (SQL(<T>exec SP_MaviDM0116BuscarCombinacion :nFas, :nId, :nSuc, :tMov, :tMovId, :tCond, :tCat<T>, 3, Venta:Venta.ID, Venta:Venta.SucursalDestino, Venta:Venta.Mov,  Venta:Venta.MovID, Venta:Venta.Condicion, Venta:CteEnviarA.Categoria)=<T>010<T>)<BR>                                                                                            Entonces<BR>                                                                                                ReporteImpresora(<T>FacturaMAVIMayoreo12Imp<T>,Venta:Venta.ID,2)<BR>                                                                                                EjecutarSQL(<T>spConsecutivoImpresion :nID, :ncom<T>, <CONTINUA>
;Expresion066=<CONTINUA>Info.ID, 2)<BR>                                                                                            Sino<BR>                                                                                                Si (SQL(<T>exec SP_MaviDM0116BuscarCombinacion :nFas, :nId, :nSuc, :tMov, :tMovId, :tCond, :tCat<T>, 3, Venta:Venta.ID, Venta:Venta.SucursalDestino, Venta:Venta.Mov,  Venta:Venta.MovID, Venta:Venta.Condicion, Venta:CteEnviarA.Categoria)=<T>001<T>)<BR>                                                                                                    Entonces<BR>                                                                                                        ReporteImpresora(<T>FacturaMAVIMayoreo12Imp<T>,Venta:Venta.ID,3)<BR>                                                      <CONTINUA>
;Expresion067=<CONTINUA>                                                  EjecutarSQL(<T>spConsecutivoImpresion :nID, :ncom<T>, Info.ID, 1)<BR>                                                                                                Fin<BR>                                                                                        Fin<BR>                                                                                Fin<BR>                                                                        Fin<BR>                                                                Fin<BR>                                                        Fin<BR>                                                Fin<BR>                                            sino<BR>                                                Si (SQL(<T>exec SP_MaviDM011<CONTINUA>
;Expresion068=<CONTINUA>6BuscarCombinacion :nFas, :nId, :nSuc, :tMov, :tMovId, :tCond, :tCat<T>, 3, Venta:Venta.ID, Venta:Venta.SucursalDestino, Venta:Venta.Mov,  Venta:Venta.MovID, Venta:Venta.Condicion, Venta:CteEnviarA.Categoria)=<T>111<T>)<BR>                                                    Entonces<BR>                                                        si (sql(<T>select isnull(ContImpSimp,0) from venta where id=:nId<T>,Venta:Venta.ID)=0)<BR>                                                            entonces<BR>                                                                ReporteImpresora(<T>FacturaMAVIMayoreo12Imp<T>,Venta:Venta.ID,2)<BR>                                                                EjecutarSQL(<T>spConsecutivoImpresion :nID, :ncom<T>, Info.ID, 2)<BR>                              <CONTINUA>
;Expresion069=<CONTINUA>                              sino<BR>                                                                Informacion(<T>Este reporte <T>+ COMILLAS(<T>Copia<T>)+<T> ya fue impreso. Su perfil de usuario no cuenta con privilegios para poder hacer una reimpresión del mismo.<T>)<BR>                                                        Fin<BR>                                                        si (sql(<T>select isnull(ContImpCiego,0) from venta where id=:nId<T>,Venta:Venta.ID)=0)<BR>                                                            entonces<BR>                                                                ReporteImpresora(<T>FacturaMAVIMayoreo12Imp<T>,Venta:Venta.ID,3)<BR>                                                                EjecutarSQL(<T>spConsecutivoImpresion :nID, :nc<CONTINUA>
;Expresion070=<CONTINUA>om<T>, Info.ID, 1)<BR>                                                            sino<BR>                                                                Informacion(<T>Este reporte <T>+ COMILLAS(<T>Copia Embarque<T>)+<T> ya fue impreso. Su perfil de usuario no cuenta con privilegios para poder hacer una reimpresión del mismo.<T>)<BR>                                                        Fin<BR>                                                        si (sql(<T>select isnull(ContImpCFD,0) from venta where id=:nId<T>,Venta:Venta.ID)=0)<BR>                                                            entonces<BR>                                                                ReporteImpresora(<T>FacturaMAVIMayoreo12Imp<T>,Venta:Venta.ID,1)<BR>                                                    <CONTINUA>
;Expresion071=<CONTINUA>            EjecutarSQL(<T>spConsecutivoImpresion :nID, :ncom<T>, Info.ID, 3)<BR>                                                            sino<BR>                                                                Informacion(<T>Este reporte <T>+ COMILLAS(<T>CFD<T>)+<T> ya fue impreso. Su perfil de usuario no cuenta con privilegios para poder hacer una reimpresión del mismo.<T>)<BR>                                                        Fin<BR>                                                    Sino<BR>                                                        Si (SQL(<T>exec SP_MaviDM0116BuscarCombinacion :nFas, :nId, :nSuc, :tMov, :tMovId, :tCond, :tCat<T>, 3, Venta:Venta.ID, Venta:Venta.SucursalDestino, Venta:Venta.Mov,  Venta:Venta.MovID, Venta:Venta.Condicion, Venta:CteEnviarA.Categoria)=<CONTINUA>
;Expresion072=<CONTINUA><T>110<T>)<BR>                                                            Entonces<BR>                                                                si (sql(<T>select isnull(ContImpSimp,0) from venta where id=:nId<T>,Venta:Venta.ID)=0)<BR>                                                                    entonces<BR>                                                                        ReporteImpresora(<T>FacturaMAVIMayoreo12Imp<T>,Venta:Venta.ID,2)<BR>                                                                        EjecutarSQL(<T>spConsecutivoImpresion :nID, :ncom<T>, Info.ID, 2)<BR>                                                                    sino<BR>                                                                        Informacion(<T>Este reporte <T>+ COMILLAS(<T>Copia<<CONTINUA>
;Expresion073=<CONTINUA>T>)+<T> ya fue impreso. Su perfil de usuario no cuenta con privilegios para poder hacer una reimpresión del mismo.<T>)<BR>                                                                Fin<BR>                                                                si (sql(<T>select isnull(ContImpCFD,0) from venta where id=:nId<T>,Venta:Venta.ID)=0)<BR>                                                                    entonces<BR>                                                                        ReporteImpresora(<T>FacturaMAVIMayoreo12Imp<T>,Venta:Venta.ID,1)<BR>                                                                        EjecutarSQL(<T>spConsecutivoImpresion :nID, :ncom<T>, Info.ID, 3)<BR>                                                                    sino<BR>                 <CONTINUA>
;Expresion074=<CONTINUA>                                                       Informacion(<T>Este reporte <T>+ COMILLAS(<T>CFD<T>)+<T> ya fue impreso. Su perfil de usuario no cuenta con privilegios para poder hacer una reimpresión del mismo.<T>)<BR>                                                                Fin    <BR>                                                            Sino<BR>                                                                Si (SQL(<T>exec SP_MaviDM0116BuscarCombinacion :nFas, :nId, :nSuc, :tMov, :tMovId, :tCond, :tCat<T>, 3, Venta:Venta.ID, Venta:Venta.SucursalDestino, Venta:Venta.Mov,  Venta:Venta.MovID, Venta:Venta.Condicion, Venta:CteEnviarA.Categoria)=<T>101<T>)<BR>                                                                    Entonces<BR>                                    <CONTINUA>
;Expresion075=<CONTINUA>                                    si (sql(<T>select isnull(ContImpCiego,0) from venta where id=:nId<T>,Venta:Venta.ID)=0)<BR>                                                                            entonces<BR>                                                                                ReporteImpresora(<T>FacturaMAVIMayoreo12Imp<T>,Venta:Venta.ID,3)<BR>                                                                                EjecutarSQL(<T>spConsecutivoImpresion :nID, :ncom<T>, Info.ID, 1)<BR>                                                                            sino<BR>                                                                                Informacion(<T>Este reporte <T>+ COMILLAS(<T>Copia Embarque<T>)+<T> ya fue impreso. Su perfil de usuario no cuenta con privi<CONTINUA>
;Expresion076=<CONTINUA>legios para poder hacer una reimpresión del mismo.<T>)<BR>                                                                        Fin <BR>                                                                        si (sql(<T>select isnull(ContImpCFD,0) from venta where id=:nId<T>,Venta:Venta.ID)=0)<BR>                                                                            entonces<BR>                                                                                ReporteImpresora(<T>FacturaMAVIMayoreo12Imp<T>,Venta:Venta.ID,1)<BR>                                                                                EjecutarSQL(<T>spConsecutivoImpresion :nID, :ncom<T>, Info.ID, 3)<BR>                                                                            sino<BR>                                <CONTINUA>
;Expresion077=<CONTINUA>                                                Informacion(<T>Este reporte <T>+ COMILLAS(<T>CFD<T>)+<T> ya fue impreso. Su perfil de usuario no cuenta con privilegios para poder hacer una reimpresión del mismo.<T>)<BR>                                                                        Fin   <BR>                                                                    Sino<BR>                                                                        Si (SQL(<T>exec SP_MaviDM0116BuscarCombinacion :nFas, :nId, :nSuc, :tMov, :tMovId, :tCond, :tCat<T>, 3, Venta:Venta.ID, Venta:Venta.SucursalDestino, Venta:Venta.Mov,  Venta:Venta.MovID, Venta:Venta.Condicion, Venta:CteEnviarA.Categoria)=<T>100<T>)<BR>                                                                            Entonces<BR>            <CONTINUA>
;Expresion078=<CONTINUA>                                                                    si (sql(<T>select isnull(ContImpCFD,0) from venta where id=:nId<T>,Venta:Venta.ID)=0)<BR>                                                                                    entonces<BR>                                                                                        ReporteImpresora(<T>FacturaMAVIMayoreo12Imp<T>,Venta:Venta.ID,1)<BR>                                                                                        EjecutarSQL(<T>spConsecutivoImpresion :nID, :ncom<T>, Info.ID, 3)<BR>                                                                                    sino<BR>                                                                                        Informacion(<T>Este reporte <T>+ COMILLAS(<T>CFD<T>)+<<CONTINUA>
;Expresion079=<CONTINUA>T> ya fue impreso. Su perfil de usuario no cuenta con privilegios para poder hacer una reimpresión del mismo.<T>)<BR>                                                                                Fin<BR>                                                                            Sino<BR>                                                                                Si (SQL(<T>exec SP_MaviDM0116BuscarCombinacion :nFas, :nId, :nSuc, :tMov, :tMovId, :tCond, :tCat<T>, 3, Venta:Venta.ID, Venta:Venta.SucursalDestino, Venta:Venta.Mov,  Venta:Venta.MovID, Venta:Venta.Condicion, Venta:CteEnviarA.Categoria)=<T>011<T>)<BR>                                                                                    Entonces<BR>                                                                                     <CONTINUA>
;Expresion080=<CONTINUA>   si (sql(<T>select isnull(ContImpSimp,0) from venta where id=:nId<T>,Venta:Venta.ID)=0)<BR>                                                                                            entonces<BR>                                                                                                ReporteImpresora(<T>FacturaMAVIMayoreo12Imp<T>,Venta:Venta.ID,2)<BR>                                                                                                EjecutarSQL(<T>spConsecutivoImpresion :nID, :ncom<T>, Info.ID, 2)<BR>                                                                                            sino<BR>                                                                                                Informacion(<T>Este reporte <T>+ COMILLAS(<T>Copia<T>)+<T> ya fue impreso. Su <CONTINUA>
;Expresion081=<CONTINUA>perfil de usuario no cuenta con privilegios para poder hacer una reimpresión del mismo.<T>)<BR>                                                                                        Fin<BR>                                                                                        si (sql(<T>select isnull(ContImpCiego,0) from venta where id=:nId<T>,Venta:Venta.ID)=0)<BR>                                                                                            entonces<BR>                                                                                                ReporteImpresora(<T>FacturaMAVIMayoreo12Imp<T>,Venta:Venta.ID,3)<BR>                                                                                                EjecutarSQL(<T>spConsecutivoImpresion :nID, :ncom<T>, Info.ID, 1)<B<CONTINUA>
;Expresion082=<CONTINUA>R>                                                                                            sino<BR>                                                                                                Informacion(<T>Este reporte <T>+ COMILLAS(<T>Copia Embarque<T>)+<T> ya fue impreso. Su perfil de usuario no cuenta con privilegios para poder hacer una reimpresión del mismo.<T>)<BR>                                                                                        Fin<BR>                                                                                    Sino<BR>                                                                                        Si (SQL(<T>exec SP_MaviDM0116BuscarCombinacion :nFas, :nId, :nSuc, :tMov, :tMovId, :tCond, :tCat<T>, 3, Venta:Venta.ID, Venta:Venta.SucursalDesti<CONTINUA>
;Expresion083=<CONTINUA>no, Venta:Venta.Mov,  Venta:Venta.MovID, Venta:Venta.Condicion, Venta:CteEnviarA.Categoria)=<T>010<T>)<BR>                                                                                            Entonces<BR>                                                                                                si (sql(<T>select isnull(ContImpSimp,0) from venta where id=:nId<T>,Venta:Venta.ID)=0)<BR>                                                                                                    entonces<BR>                                                                                                        ReporteImpresora(<T>FacturaMAVIMayoreo12Imp<T>,Venta:Venta.ID,2)<BR>                                                                                                        EjecutarSQL(<T>s<CONTINUA>
;Expresion084=<CONTINUA>pConsecutivoImpresion :nID, :ncom<T>, Info.ID, 2)<BR>                                                                                                    sino<BR>                                                                                                        Informacion(<T>Este reporte <T>+ COMILLAS(<T>Copia<T>)+<T> ya fue impreso. Su perfil de usuario no cuenta con privilegios para poder hacer una reimpresión del mismo.<T>)<BR>                                                                                                Fin<BR>                                                                                            Sino<BR>                                                                                                Si (SQL(<T>exec SP_MaviDM0116BuscarCombinacion :nFas, :nId, :nS<CONTINUA>
;Expresion085=<CONTINUA>uc, :tMov, :tMovId, :tCond, :tCat<T>, 3, Venta:Venta.ID, Venta:Venta.SucursalDestino, Venta:Venta.Mov,  Venta:Venta.MovID, Venta:Venta.Condicion, Venta:CteEnviarA.Categoria)=<T>001<T>)<BR>                                                                                                    Entonces<BR>                                                                                                        si (sql(<T>select isnull(ContImpCiego,0) from venta where id=:nId<T>,Venta:Venta.ID)=0)<BR>                                                                                                            entonces<BR>                                                                                                                ReporteImpresora(<T>FacturaMAVIMayoreo12Imp<T>,Venta:Venta.ID,3)<BR>     <CONTINUA>
;Expresion086=<CONTINUA>                                                                                                           EjecutarSQL(<T>spConsecutivoImpresion :nID, :ncom<T>, Info.ID, 1)<BR>                                                                                                            sino<BR>                                                                                                                Informacion(<T>Este reporte <T>+ COMILLAS(<T>Copia Embarque<T>)+<T> ya fue impreso. Su perfil de usuario no cuenta con privilegios para poder hacer una reimpresión del mismo.<T>)<BR>                                                                                                        Fin<BR>                                                                                                Fin<BR><CONTINUA>
;Expresion087=<CONTINUA>                                                                                        Fin<BR>                                                                                Fin<BR>                                                                        Fin<BR>                                                                Fin<BR>                                                        Fin<BR>                                                Fin<BR>                                        Fin<BR>                                Fin<BR>                        Fin<BR>                Fin<BR>        Fin<BR>    SINO<BR>        Si Venta:Venta.Mov en(<T>Credilana<T>, <T>Prestamo Personal<T>, <T>Seguro Vida<T>, <T>Seguro Auto<T>)<BR>            Entonces<BR>                ReporteImpresora(ReporteMovImp<CONTINUA>
;Expresion088=<CONTINUA>resora(Info.SubModuloVenta, Venta:Venta.Mov, Venta:Venta.Estatus), Venta:Venta.ID)<BR>                ReporteImpresora(ReporteMovImpresora(Info.SubModuloVenta, Venta:Venta.Mov, Venta:Venta.Estatus), Venta:Venta.ID)<BR>            Sino<BR>                ReporteImpresora(ReporteMovImpresora(Info.SubModuloVenta, Venta:Venta.Mov, Venta:Venta.Estatus), Venta:Venta.ID)<BR>        Fin<BR>Fin<BR>Asigna(Info.SubModuloVenta,<T>VTAS<T>)
Expresion=Asigna(MAVI.DM0116FaseC,1)<BR>Actualizarforma<BR>Si (SQL(<T>Select count(Mov) From MovTipoCFDFlex Where Modulo = :tVta and Mov = :tMov<T>, <T>VTAS<T>, Venta:Venta.Mov))>0<BR>    Entonces<BR>        Si (SQL(<T>Select COUNT(*) From TablaStd where TablaSt=:tda and Nombre in (SELECT ACCESO FROM USUARIO WHERE Usuario =:tUsu)<T>,<T>CFD PERFILES P/IMPRESION<T>,Usuario)>0)<BR>            entonces<BR>                Si (SQL(<T>exec SP_MaviDM0116BuscarCombinacion :nFas, :nId, :nSuc, :tMov, :tMovId, :tCond, :tCat<T>, 4, Venta:Venta.ID, Venta:Venta.SucursalDestino, Venta:Venta.Mov,  Venta:Venta.MovID, Venta:Venta.Condicion, Venta:CteEnviarA.Categoria)=<T>TICKET<T>)<BR>                    entonces<BR>                        SI SQL(<T>SELECT COUNT(Numero) FROM dbo.TablaNumD WHERE TablaNum=:tTab AND CAST<CONTINUA>
Expresion002=<CONTINUA>(Numero AS INT)=:nSuc<T>, <T>SUCURSALES RDP<T>, Sucursal)=1<BR>                            Entonces<BR>                                Ejecutar(<T>PlugIns\RutaTicket.exe <T>+<T>VTAS<T>+<T> <T>+Venta:Venta.ID+<T> <T>+Usuario+<T> <T>+<T>1<T>+<T> <T>+Sucursal+<T> <T>+EstacionTrabajo)<BR>                            Sino<BR>                                Ejecutar(<T>C:\AppsMavi\Factura.exe <T>+Venta:Venta.ID+<T> <T>+Usuario+<T> 1 <T>+Sucursal)<BR>                        Fin<BR>                    Sino<BR>                        Si (SQL(<T>exec SP_MaviDM0116BuscarCombinacion :nFas, :nId, :nSuc, :tMov, :tMovId, :tCond, :tCat<T>, 4, Venta:Venta.ID, Venta:Venta.SucursalDestino, Venta:Venta.Mov,  Venta:Venta.MovID, Venta:Venta.Condicion, Venta:CteEnviarA.Categoria)=<T>CARTA<T>)<BR>                 <CONTINUA>
Expresion003=<CONTINUA>           entonces<BR>                                Si (SQL(<T>Select left(Valor,1) From TablaStd where TablaSt=:tda and Nombre in (SELECT ACCESO FROM USUARIO WHERE Usuario =:tUsu)<T>,<T>CFD PERFILES P/IMPRESION<T>,Usuario)=1)<BR>                                    entonces<BR>                                        Si (SQL(<T>Select right(Valor,1) From TablaStd where TablaSt=:tda and Nombre in (SELECT ACCESO FROM USUARIO WHERE Usuario =:tUsu)<T>,<T>CFD PERFILES P/IMPRESION<T>,Usuario)=1)<BR>                                            entonces<BR>                                                Si (SQL(<T>exec SP_MaviDM0116BuscarCombinacion :nFas, :nId, :nSuc, :tMov, :tMovId, :tCond, :tCat<T>, 3, Venta:Venta.ID, Venta:Venta.SucursalDestino, Venta:Venta.Mov,  Venta:Venta.MovID, Venta:Vent<CONTINUA>
Expresion004=<CONTINUA>a.Condicion, Venta:CteEnviarA.Categoria)=<T>111<T>)<BR>                                                    Entonces<BR>                                                        ReporteImpresora(<T>FacturaMAVIMayoreo12Imp<T>,Venta:Venta.ID,2)<BR>                                                        EjecutarSQL(<T>spConsecutivoImpresion :nID, :ncom<T>, Info.ID, 2)<BR>                                                        ReporteImpresora(<T>FacturaMAVIMayoreo12Imp<T>,Venta:Venta.ID,3)<BR>                                                        EjecutarSQL(<T>spConsecutivoImpresion :nID, :ncom<T>, Info.ID, 1)<BR>                                                        Si VentaD:Art.Linea = (SQL(<T>SELECT Nombre FROM TablaSTD WHERE TablaSt = :tConv AND Nombre = :tLinea<T>, <T>EXCEPCIONES DM0116<CONTINUA>
Expresion005=<CONTINUA> IMPRESION CO<T>, VentaD:Art.Linea))<BR>                                                            entonces<BR>                                                                ReporteImpresora(<T>FacturaMAVIMayoreo12Imp<T>,Venta:Venta.ID,1)<BR>                                                                EjecutarSQL(<T>spConsecutivoImpresion :nID, :ncom<T>, Info.ID, 3)<BR>                                                            sino<BR>                                                                Si (SQL(<T>exec SP_MaviDM0116BuscarCombinacion :nFas, :nId, :nSuc, :tMov, :tMovId, :tCond, :tCat<T>, 2, Venta:Venta.ID, Venta:Venta.SucursalDestino, Venta:Venta.Mov,  Venta:Venta.MovID, Venta:Venta.Condicion, Venta:CteEnviarA.Categoria)=0)<BR>                                                <CONTINUA>
Expresion006=<CONTINUA>                    Entonces<BR>                                                                        ReporteImpresora(<T>FacturaMAVIMayoreo12Imp<T>,Venta:Venta.ID,1)<BR>                                                                        EjecutarSQL(<T>spConsecutivoImpresion :nID, :ncom<T>, Info.ID, 3)<BR>                                                                    Sino<BR>                                                                        Si (SQL(<T>exec SP_MaviDM0116BuscarCombinacion :nFas, :nId, :nSuc, :tMov, :tMovId, :tCond, :tCat<T>, 2, Venta:Venta.ID, Venta:Venta.SucursalDestino, Venta:Venta.Mov,  Venta:Venta.MovID, Venta:Venta.Condicion, Venta:CteEnviarA.Categoria)>=<BR>                                                                            (SQL(<T>Select Sum(A.<CONTINUA>
Expresion007=<CONTINUA>Saldo) As Saldo From CxcPendiente A Where A.PadreMavi = :tMov and A.PadreIdMavi = :tMovId Group By A.PadreMavi, A.PadreIDMavi<T>, Venta:Venta.Mov,  Venta:Venta.MovID)))<BR>                                                                            Entonces<BR>                                                                                ReporteImpresora(<T>FacturaMAVIMayoreo12Imp<T>,Venta:Venta.ID,1)<BR>                                                                                EjecutarSQL(<T>spConsecutivoImpresion :nID, :ncom<T>, Info.ID, 3)<BR>                                                                        Fin<BR>                                                                Fin<BR>                                                        Fin<BR>                              <CONTINUA>
Expresion008=<CONTINUA>                      Sino<BR>                                                        Si (SQL(<T>exec SP_MaviDM0116BuscarCombinacion :nFas, :nId, :nSuc, :tMov, :tMovId, :tCond, :tCat<T>, 3, Venta:Venta.ID, Venta:Venta.SucursalDestino, Venta:Venta.Mov,  Venta:Venta.MovID, Venta:Venta.Condicion, Venta:CteEnviarA.Categoria)=<T>110<T>)<BR>                                                            Entonces<BR>                                                                ReporteImpresora(<T>FacturaMAVIMayoreo12Imp<T>,Venta:Venta.ID,2)<BR>                                                                EjecutarSQL(<T>spConsecutivoImpresion :nID, :ncom<T>, Info.ID, 2)<BR>                                                                Si VentaD:Art.Linea = (SQL(<T>SELECT Nombre FROM TablaSTD WHER<CONTINUA>
Expresion009=<CONTINUA>E TablaSt = :tConv AND Nombre = :tLinea<T>, <T>EXCEPCIONES DM0116 IMPRESION CO<T>, VentaD:Art.Linea))<BR>                                                                    entonces<BR>                                                                        ReporteImpresora(<T>FacturaMAVIMayoreo12Imp<T>,Venta:Venta.ID,1)<BR>                                                                        EjecutarSQL(<T>spConsecutivoImpresion :nID, :ncom<T>, Info.ID, 3)<BR>                                                                    sino<BR>                                                                        Si (SQL(<T>exec SP_MaviDM0116BuscarCombinacion :nFas, :nId, :nSuc, :tMov, :tMovId, :tCond, :tCat<T>, 2, Venta:Venta.ID, Venta:Venta.SucursalDestino, Venta:Venta.Mov,  Venta:Venta.MovID, <CONTINUA>
Expresion010=<CONTINUA>Venta:Venta.Condicion, Venta:CteEnviarA.Categoria)=0)<BR>                                                                            Entonces<BR>                                                                                ReporteImpresora(<T>FacturaMAVIMayoreo12Imp<T>,Venta:Venta.ID,1)<BR>                                                                                EjecutarSQL(<T>spConsecutivoImpresion :nID, :ncom<T>, Info.ID, 3)<BR>                                                                            Sino<BR>                                                                                Si (SQL(<T>exec SP_MaviDM0116BuscarCombinacion :nFas, :nId, :nSuc, :tMov, :tMovId, :tCond, :tCat<T>, 2, Venta:Venta.ID, Venta:Venta.SucursalDestino, Venta:Venta.Mov,  Venta:Venta.MovID, Venta:Ve<CONTINUA>
Expresion011=<CONTINUA>nta.Condicion, Venta:CteEnviarA.Categoria)>=<BR>                                                                                    (SQL(<T>Select Sum(A.Saldo) As Saldo From CxcPendiente A Where A.PadreMavi = :tMov and A.PadreIdMavi = :tMovId Group By A.PadreMavi, A.PadreIDMavi<T>, Venta:Venta.Mov,  Venta:Venta.MovID)))<BR>                                                                                    Entonces<BR>                                                                                        ReporteImpresora(<T>FacturaMAVIMayoreo12Imp<T>,Venta:Venta.ID,1)<BR>                                                                                        EjecutarSQL(<T>spConsecutivoImpresion :nID, :ncom<T>, Info.ID, 3)<BR>                                                                  <CONTINUA>
Expresion012=<CONTINUA>              Fin<BR>                                                                        Fin<BR>                                                                Fin<BR>                                                            Sino<BR>                                                                Si (SQL(<T>exec SP_MaviDM0116BuscarCombinacion :nFas, :nId, :nSuc, :tMov, :tMovId, :tCond, :tCat<T>, 3, Venta:Venta.ID, Venta:Venta.SucursalDestino, Venta:Venta.Mov,  Venta:Venta.MovID, Venta:Venta.Condicion, Venta:CteEnviarA.Categoria)=<T>101<T>)<BR>                                                                    Entonces<BR>                                                                        ReporteImpresora(<T>FacturaMAVIMayoreo12Imp<T>,Venta:Venta.ID,3)<BR>                          <CONTINUA>
Expresion013=<CONTINUA>                                              EjecutarSQL(<T>spConsecutivoImpresion :nID, :ncom<T>, Info.ID, 1)<BR>                                                                        Si VentaD:Art.Linea = (SQL(<T>SELECT Nombre FROM TablaSTD WHERE TablaSt = :tConv AND Nombre = :tLinea<T>, <T>EXCEPCIONES DM0116 IMPRESION CO<T>, VentaD:Art.Linea))<BR>                                                                            entonces<BR>                                                                                ReporteImpresora(<T>FacturaMAVIMayoreo12Imp<T>,Venta:Venta.ID,1)<BR>                                                                                EjecutarSQL(<T>spConsecutivoImpresion :nID, :ncom<T>, Info.ID, 3)<BR>                                                             <CONTINUA>
Expresion014=<CONTINUA>               sino<BR>                                                                                Si (SQL(<T>exec SP_MaviDM0116BuscarCombinacion :nFas, :nId, :nSuc, :tMov, :tMovId, :tCond, :tCat<T>, 2, Venta:Venta.ID, Venta:Venta.SucursalDestino, Venta:Venta.Mov,  Venta:Venta.MovID, Venta:Venta.Condicion, Venta:CteEnviarA.Categoria)=0)<BR>                                                                                    Entonces<BR>                                                                                        ReporteImpresora(<T>FacturaMAVIMayoreo12Imp<T>,Venta:Venta.ID,1)<BR>                                                                                        EjecutarSQL(<T>spConsecutivoImpresion :nID, :ncom<T>, Info.ID, 3)<BR>                                             <CONTINUA>
Expresion015=<CONTINUA>                                       Sino<BR>                                                                                        Si (SQL(<T>exec SP_MaviDM0116BuscarCombinacion :nFas, :nId, :nSuc, :tMov, :tMovId, :tCond, :tCat<T>, 2, Venta:Venta.ID, Venta:Venta.SucursalDestino, Venta:Venta.Mov,  Venta:Venta.MovID, Venta:Venta.Condicion, Venta:CteEnviarA.Categoria)>=<BR>                                                                                            (SQL(<T>Select Sum(A.Saldo) As Saldo From CxcPendiente A Where A.PadreMavi = :tMov and A.PadreIdMavi = :tMovId Group By A.PadreMavi, A.PadreIDMavi<T>, Venta:Venta.Mov,  Venta:Venta.MovID)))<BR>                                                                                            Entonces<BR>                                  <CONTINUA>
Expresion016=<CONTINUA>                                                              ReporteImpresora(<T>FacturaMAVIMayoreo12Imp<T>,Venta:Venta.ID,1)<BR>                                                                                                EjecutarSQL(<T>spConsecutivoImpresion :nID, :ncom<T>, Info.ID, 3)<BR>                                                                                        Fin<BR>                                                                                Fin<BR>                                                                        Fin<BR>                                                                    Sino<BR>                                                                        Si (SQL(<T>exec SP_MaviDM0116BuscarCombinacion :nFas, :nId, :nSuc, :tMov, :tMovId, :tCond, :tCat<CONTINUA>
Expresion017=<CONTINUA><T>, 3, Venta:Venta.ID, Venta:Venta.SucursalDestino, Venta:Venta.Mov,  Venta:Venta.MovID, Venta:Venta.Condicion, Venta:CteEnviarA.Categoria)=<T>100<T>)<BR>                                                                            Entonces<BR>                                                                                Si VentaD:Art.Linea = (SQL(<T>SELECT Nombre FROM TablaSTD WHERE TablaSt = :tConv AND Nombre = :tLinea<T>, <T>EXCEPCIONES DM0116 IMPRESION CO<T>, VentaD:Art.Linea))<BR>                                                                                    entonces<BR>                                                                                        ReporteImpresora(<T>FacturaMAVIMayoreo12Imp<T>,Venta:Venta.ID,1)<BR>                                                          <CONTINUA>
Expresion018=<CONTINUA>                              EjecutarSQL(<T>spConsecutivoImpresion :nID, :ncom<T>, Info.ID, 3)<BR>                                                                                    sino<BR>                                                                                        Si (SQL(<T>exec SP_MaviDM0116BuscarCombinacion :nFas, :nId, :nSuc, :tMov, :tMovId, :tCond, :tCat<T>, 2, Venta:Venta.ID, Venta:Venta.SucursalDestino, Venta:Venta.Mov,  Venta:Venta.MovID, Venta:Venta.Condicion, Venta:CteEnviarA.Categoria)=0)<BR>                                                                                            Entonces<BR>                                                                                                ReporteImpresora(<T>FacturaMAVIMayoreo12Imp<T>,Venta:Venta.ID,1)<BR>          <CONTINUA>
Expresion019=<CONTINUA>                                                                                      EjecutarSQL(<T>spConsecutivoImpresion :nID, :ncom<T>, Info.ID, 3)<BR>                                                                                            Sino<BR>                                                                                                Si (SQL(<T>exec SP_MaviDM0116BuscarCombinacion :nFas, :nId, :nSuc, :tMov, :tMovId, :tCond, :tCat<T>, 2, Venta:Venta.ID, Venta:Venta.SucursalDestino, Venta:Venta.Mov,  Venta:Venta.MovID, Venta:Venta.Condicion, Venta:CteEnviarA.Categoria)>=<BR>                                                                                                    (SQL(<T>Select Sum(A.Saldo) As Saldo From CxcPendiente A Where A.PadreMavi = :tMov and A.PadreIdMavi = :tMo<CONTINUA>
Expresion020=<CONTINUA>vId Group By A.PadreMavi, A.PadreIDMavi<T>, Venta:Venta.Mov,  Venta:Venta.MovID)))<BR>                                                                                                    Entonces<BR>                                                                                                        ReporteImpresora(<T>FacturaMAVIMayoreo12Imp<T>,Venta:Venta.ID,1)<BR>                                                                                                        EjecutarSQL(<T>spConsecutivoImpresion :nID, :ncom<T>, Info.ID, 3)<BR>                                                                                                Fin<BR>                                                                                        Fin<BR>                                                           <CONTINUA>
Expresion021=<CONTINUA>                     Fin<BR>                                                                            Sino<BR>                                                                                Si (SQL(<T>exec SP_MaviDM0116BuscarCombinacion :nFas, :nId, :nSuc, :tMov, :tMovId, :tCond, :tCat<T>, 3, Venta:Venta.ID, Venta:Venta.SucursalDestino, Venta:Venta.Mov,  Venta:Venta.MovID, Venta:Venta.Condicion, Venta:CteEnviarA.Categoria)=<T>011<T>)<BR>                                                                                    Entonces<BR>                                                                                        ReporteImpresora(<T>FacturaMAVIMayoreo12Imp<T>,Venta:Venta.ID,2)<BR>                                                                                        EjecutarSQL(<T>sp<CONTINUA>
Expresion022=<CONTINUA>ConsecutivoImpresion :nID, :ncom<T>, Info.ID, 2)<BR>                                                                                        ReporteImpresora(<T>FacturaMAVIMayoreo12Imp<T>,Venta:Venta.ID,3)<BR>                                                                                        EjecutarSQL(<T>spConsecutivoImpresion :nID, :ncom<T>, Info.ID, 1)<BR>                                                                                    Sino<BR>                                                                                        Si (SQL(<T>exec SP_MaviDM0116BuscarCombinacion :nFas, :nId, :nSuc, :tMov, :tMovId, :tCond, :tCat<T>, 3, Venta:Venta.ID, Venta:Venta.SucursalDestino, Venta:Venta.Mov,  Venta:Venta.MovID, Venta:Venta.Condicion, Venta:CteEnviarA.Categoria)=<T>010<T>)<BR>    <CONTINUA>
Expresion023=<CONTINUA>                                                                                        Entonces<BR>                                                                                                ReporteImpresora(<T>FacturaMAVIMayoreo12Imp<T>,Venta:Venta.ID,2)<BR>                                                                                                EjecutarSQL(<T>spConsecutivoImpresion :nID, :ncom<T>, Info.ID, 2)<BR>                                                                                            Sino<BR>                                                                                                Si (SQL(<T>exec SP_MaviDM0116BuscarCombinacion :nFas, :nId, :nSuc, :tMov, :tMovId, :tCond, :tCat<T>, 3, Venta:Venta.ID, Venta:Venta.SucursalDestino, Venta:Venta.Mov,  Venta:Ve<CONTINUA>
Expresion024=<CONTINUA>nta.MovID, Venta:Venta.Condicion, Venta:CteEnviarA.Categoria)=<T>001<T>)<BR>                                                                                                    Entonces<BR>                                                                                                        ReporteImpresora(<T>FacturaMAVIMayoreo12Imp<T>,Venta:Venta.ID,3)<BR>                                                                                                        EjecutarSQL(<T>spConsecutivoImpresion :nID, :ncom<T>, Info.ID, 1)<BR>                                                                                                Fin<BR>                                                                                        Fin<BR>                                                                     <CONTINUA>
Expresion025=<CONTINUA>           Fin<BR>                                                                        Fin<BR>                                                                Fin<BR>                                                        Fin<BR>                                                Fin<BR>                                            sino<BR>                                                Si (SQL(<T>exec SP_MaviDM0116BuscarCombinacion :nFas, :nId, :nSuc, :tMov, :tMovId, :tCond, :tCat<T>, 3, Venta:Venta.ID, Venta:Venta.SucursalDestino, Venta:Venta.Mov,  Venta:Venta.MovID, Venta:Venta.Condicion, Venta:CteEnviarA.Categoria)=<T>111<T>)<BR>                                                    Entonces<BR>                                                        si (sql(<T>select isnull(ContImpSimp,0) fro<CONTINUA>
Expresion026=<CONTINUA>m venta where id=:nId<T>,Venta:Venta.ID)=0)<BR>                                                            entonces<BR>                                                                ReporteImpresora(<T>FacturaMAVIMayoreo12Imp<T>,Venta:Venta.ID,2)<BR>                                                                EjecutarSQL(<T>spConsecutivoImpresion :nID, :ncom<T>, Info.ID, 2)<BR>                                                            sino<BR>                                                                Informacion(<T>Este reporte <T>+ COMILLAS(<T>Copia<T>)+<T> ya fue impreso. Su perfil de usuario no cuenta con privilegios para poder hacer una reimpresión del mismo.<T>)<BR>                                                        Fin<BR>                                                <CONTINUA>
Expresion027=<CONTINUA>        si (sql(<T>select isnull(ContImpCiego,0) from venta where id=:nId<T>,Venta:Venta.ID)=0)<BR>                                                            entonces<BR>                                                                ReporteImpresora(<T>FacturaMAVIMayoreo12Imp<T>,Venta:Venta.ID,3)<BR>                                                                EjecutarSQL(<T>spConsecutivoImpresion :nID, :ncom<T>, Info.ID, 1)<BR>                                                            sino<BR>                                                                Informacion(<T>Este reporte <T>+ COMILLAS(<T>Copia Embarque<T>)+<T> ya fue impreso. Su perfil de usuario no cuenta con privilegios para poder hacer una reimpresión del mismo.<T>)<BR>                                                  <CONTINUA>
Expresion028=<CONTINUA>      Fin<BR>                                                        si (sql(<T>select isnull(ContImpCFD,0) from venta where id=:nId<T>,Venta:Venta.ID)=0)<BR>                                                            entonces<BR>                                                                Si VentaD:Art.Linea = (SQL(<T>SELECT Nombre FROM TablaSTD WHERE TablaSt = :tConv AND Nombre = :tLinea<T>, <T>EXCEPCIONES DM0116 IMPRESION CO<T>, VentaD:Art.Linea))<BR>                                                                    entonces<BR>                                                                        ReporteImpresora(<T>FacturaMAVIMayoreo12Imp<T>,Venta:Venta.ID,1)<BR>                                                                        EjecutarSQL(<T>spConsecutivoImpresion :nID, :nc<CONTINUA>
Expresion029=<CONTINUA>om<T>, Info.ID, 3)<BR>                                                                    sino<BR>                                                                        Si (SQL(<T>exec SP_MaviDM0116BuscarCombinacion :nFas, :nId, :nSuc, :tMov, :tMovId, :tCond, :tCat<T>, 2, Venta:Venta.ID, Venta:Venta.SucursalDestino, Venta:Venta.Mov,  Venta:Venta.MovID, Venta:Venta.Condicion, Venta:CteEnviarA.Categoria)=0)<BR>                                                                            Entonces<BR>                                                                                ReporteImpresora(<T>FacturaMAVIMayoreo12Imp<T>,Venta:Venta.ID,1)<BR>                                                                                EjecutarSQL(<T>spConsecutivoImpresion :nID, :ncom<T>, Info.ID, 3)<BR>  <CONTINUA>
Expresion030=<CONTINUA>                                                                          Sino<BR>                                                                                Si (SQL(<T>exec SP_MaviDM0116BuscarCombinacion :nFas, :nId, :nSuc, :tMov, :tMovId, :tCond, :tCat<T>, 2, Venta:Venta.ID, Venta:Venta.SucursalDestino, Venta:Venta.Mov,  Venta:Venta.MovID, Venta:Venta.Condicion, Venta:CteEnviarA.Categoria)>=<BR>                                                                                    (SQL(<T>Select Sum(A.Saldo) As Saldo From CxcPendiente A Where A.PadreMavi = :tMov and A.PadreIdMavi = :tMovId Group By A.PadreMavi, A.PadreIDMavi<T>, Venta:Venta.Mov,  Venta:Venta.MovID)))<BR>                                                                                    Entonces<BR>                       <CONTINUA>
Expresion031=<CONTINUA>                                                                 ReporteImpresora(<T>FacturaMAVIMayoreo12Imp<T>,Venta:Venta.ID,1)<BR>                                                                                        EjecutarSQL(<T>spConsecutivoImpresion :nID, :ncom<T>, Info.ID, 3)<BR>                                                                                Fin<BR>                                                                        Fin<BR>                                                                Fin<BR>                                                            sino<BR>                                                                Informacion(<T>Este reporte <T>+ COMILLAS(<T>CFD<T>)+<T> ya fue impreso. Su perfil de usuario no cuenta con privilegios para poder hacer una <CONTINUA>
Expresion032=<CONTINUA>reimpresión del mismo.<T>)<BR>                                                        Fin<BR>                                                    Sino<BR>                                                        Si (SQL(<T>exec SP_MaviDM0116BuscarCombinacion :nFas, :nId, :nSuc, :tMov, :tMovId, :tCond, :tCat<T>, 3, Venta:Venta.ID, Venta:Venta.SucursalDestino, Venta:Venta.Mov,  Venta:Venta.MovID, Venta:Venta.Condicion, Venta:CteEnviarA.Categoria)=<T>110<T>)<BR>                                                            Entonces<BR>                                                                si (sql(<T>select isnull(ContImpSimp,0) from venta where id=:nId<T>,Venta:Venta.ID)=0)<BR>                                                                    entonces<BR>                                  <CONTINUA>
Expresion033=<CONTINUA>                                      ReporteImpresora(<T>FacturaMAVIMayoreo12Imp<T>,Venta:Venta.ID,2)<BR>                                                                        EjecutarSQL(<T>spConsecutivoImpresion :nID, :ncom<T>, Info.ID, 2)<BR>                                                                    sino<BR>                                                                        Informacion(<T>Este reporte <T>+ COMILLAS(<T>Copia<T>)+<T> ya fue impreso. Su perfil de usuario no cuenta con privilegios para poder hacer una reimpresión del mismo.<T>)<BR>                                                                Fin<BR>                                                                si (sql(<T>select isnull(ContImpCFD,0) from venta where id=:nId<T>,Venta:Venta.ID)=0)<BR>        <CONTINUA>
Expresion034=<CONTINUA>                                                            entonces<BR>                                                                        Si VentaD:Art.Linea = (SQL(<T>SELECT Nombre FROM TablaSTD WHERE TablaSt = :tConv AND Nombre = :tLinea<T>, <T>EXCEPCIONES DM0116 IMPRESION CO<T>, VentaD:Art.Linea))<BR>                                                                            entonces<BR>                                                                                ReporteImpresora(<T>FacturaMAVIMayoreo12Imp<T>,Venta:Venta.ID,1)<BR>                                                                                EjecutarSQL(<T>spConsecutivoImpresion :nID, :ncom<T>, Info.ID, 3)<BR>                                                                            sino<BR>                    <CONTINUA>
Expresion035=<CONTINUA>                                                            Si (SQL(<T>exec SP_MaviDM0116BuscarCombinacion :nFas, :nId, :nSuc, :tMov, :tMovId, :tCond, :tCat<T>, 2, Venta:Venta.ID, Venta:Venta.SucursalDestino, Venta:Venta.Mov,  Venta:Venta.MovID, Venta:Venta.Condicion, Venta:CteEnviarA.Categoria)=0)<BR>                                                                                    Entonces<BR>                                                                                        ReporteImpresora(<T>FacturaMAVIMayoreo12Imp<T>,Venta:Venta.ID,1)<BR>                                                                                        EjecutarSQL(<T>spConsecutivoImpresion :nID, :ncom<T>, Info.ID, 3)<BR>                                                                                    Sino<CONTINUA>
Expresion036=<CONTINUA><BR>                                                                                        Si (SQL(<T>exec SP_MaviDM0116BuscarCombinacion :nFas, :nId, :nSuc, :tMov, :tMovId, :tCond, :tCat<T>, 2, Venta:Venta.ID, Venta:Venta.SucursalDestino, Venta:Venta.Mov,  Venta:Venta.MovID, Venta:Venta.Condicion, Venta:CteEnviarA.Categoria)>=<BR>                                                                                            (SQL(<T>Select Sum(A.Saldo) As Saldo From CxcPendiente A Where A.PadreMavi = :tMov and A.PadreIdMavi = :tMovId Group By A.PadreMavi, A.PadreIDMavi<T>, Venta:Venta.Mov,  Venta:Venta.MovID)))<BR>                                                                                            Entonces<BR>                                                                             <CONTINUA>
Expresion037=<CONTINUA>                   ReporteImpresora(<T>FacturaMAVIMayoreo12Imp<T>,Venta:Venta.ID,1)<BR>                                                                                                EjecutarSQL(<T>spConsecutivoImpresion :nID, :ncom<T>, Info.ID, 3)<BR>                                                                                        Fin<BR>                                                                                Fin<BR>                                                                        Fin<BR>                                                                    sino<BR>                                                                        Informacion(<T>Este reporte <T>+ COMILLAS(<T>CFD<T>)+<T> ya fue impreso. Su perfil de usuario no cuenta con privilegios para poder hacer un<CONTINUA>
Expresion038=<CONTINUA>a reimpresión del mismo.<T>)<BR>                                                                Fin    <BR>                                                            Sino<BR>                                                                Si (SQL(<T>exec SP_MaviDM0116BuscarCombinacion :nFas, :nId, :nSuc, :tMov, :tMovId, :tCond, :tCat<T>, 3, Venta:Venta.ID, Venta:Venta.SucursalDestino, Venta:Venta.Mov,  Venta:Venta.MovID, Venta:Venta.Condicion, Venta:CteEnviarA.Categoria)=<T>101<T>)<BR>                                                                    Entonces<BR>                                                                        si (sql(<T>select isnull(ContImpCiego,0) from venta where id=:nId<T>,Venta:Venta.ID)=0)<BR>                                                                   <CONTINUA>
Expresion039=<CONTINUA>         entonces<BR>                                                                                ReporteImpresora(<T>FacturaMAVIMayoreo12Imp<T>,Venta:Venta.ID,3)<BR>                                                                                EjecutarSQL(<T>spConsecutivoImpresion :nID, :ncom<T>, Info.ID, 1)<BR>                                                                            sino<BR>                                                                                Informacion(<T>Este reporte <T>+ COMILLAS(<T>Copia Embarque<T>)+<T> ya fue impreso. Su perfil de usuario no cuenta con privilegios para poder hacer una reimpresión del mismo.<T>)<BR>                                                                        Fin <BR>                                                        <CONTINUA>
Expresion040=<CONTINUA>                si (sql(<T>select isnull(ContImpCFD,0) from venta where id=:nId<T>,Venta:Venta.ID)=0)<BR>                                                                            entonces<BR>                                                                                Si VentaD:Art.Linea = (SQL(<T>SELECT Nombre FROM TablaSTD WHERE TablaSt = :tConv AND Nombre = :tLinea<T>, <T>EXCEPCIONES DM0116 IMPRESION CO<T>, VentaD:Art.Linea))<BR>                                                                                    entonces<BR>                                                                                        ReporteImpresora(<T>FacturaMAVIMayoreo12Imp<T>,Venta:Venta.ID,1)<BR>                                                                                        EjecutarSQL(<T>spCon<CONTINUA>
Expresion041=<CONTINUA>secutivoImpresion :nID, :ncom<T>, Info.ID, 3)<BR>                                                                                    sino<BR>                                                                                        Si (SQL(<T>exec SP_MaviDM0116BuscarCombinacion :nFas, :nId, :nSuc, :tMov, :tMovId, :tCond, :tCat<T>, 2, Venta:Venta.ID, Venta:Venta.SucursalDestino, Venta:Venta.Mov,  Venta:Venta.MovID, Venta:Venta.Condicion, Venta:CteEnviarA.Categoria)=0)<BR>                                                                                            Entonces<BR>                                                                                                ReporteImpresora(<T>FacturaMAVIMayoreo12Imp<T>,Venta:Venta.ID,1)<BR>                                                            <CONTINUA>
Expresion042=<CONTINUA>                                    EjecutarSQL(<T>spConsecutivoImpresion :nID, :ncom<T>, Info.ID, 3)<BR>                                                                                            Sino<BR>                                                                                                Si (SQL(<T>exec SP_MaviDM0116BuscarCombinacion :nFas, :nId, :nSuc, :tMov, :tMovId, :tCond, :tCat<T>, 2, Venta:Venta.ID, Venta:Venta.SucursalDestino, Venta:Venta.Mov,  Venta:Venta.MovID, Venta:Venta.Condicion, Venta:CteEnviarA.Categoria)>=<BR>                                                                                                    (SQL(<T>Select Sum(A.Saldo) As Saldo From CxcPendiente A Where A.PadreMavi = :tMov and A.PadreIdMavi = :tMovId Group By A.PadreMavi, A.PadreIDMavi<T>, Venta:<CONTINUA>
Expresion043=<CONTINUA>Venta.Mov,  Venta:Venta.MovID)))<BR>                                                                                                    Entonces<BR>                                                                                                        ReporteImpresora(<T>FacturaMAVIMayoreo12Imp<T>,Venta:Venta.ID,1)<BR>                                                                                                        EjecutarSQL(<T>spConsecutivoImpresion :nID, :ncom<T>, Info.ID, 3)<BR>                                                                                                Fin<BR>                                                                                        Fin<BR>                                                                                Fin<BR>                      <CONTINUA>
Expresion044=<CONTINUA>                                                      sino<BR>                                                                                Informacion(<T>Este reporte <T>+ COMILLAS(<T>CFD<T>)+<T> ya fue impreso. Su perfil de usuario no cuenta con privilegios para poder hacer una reimpresión del mismo.<T>)<BR>                                                                        Fin   <BR>                                                                    Sino<BR>                                                                        Si (SQL(<T>exec SP_MaviDM0116BuscarCombinacion :nFas, :nId, :nSuc, :tMov, :tMovId, :tCond, :tCat<T>, 3, Venta:Venta.ID, Venta:Venta.SucursalDestino, Venta:Venta.Mov,  Venta:Venta.MovID, Venta:Venta.Condicion, Venta:CteEnviarA.Categoria)=<T>100<T>)<BR>      <CONTINUA>
Expresion045=<CONTINUA>                                                                      Entonces<BR>                                                                                si (sql(<T>select isnull(ContImpCFD,0) from venta where id=:nId<T>,Venta:Venta.ID)=0)<BR>                                                                                    entonces<BR>                                                                                        Si VentaD:Art.Linea = (SQL(<T>SELECT Nombre FROM TablaSTD WHERE TablaSt = :tConv AND Nombre = :tLinea<T>, <T>EXCEPCIONES DM0116 IMPRESION CO<T>, VentaD:Art.Linea))<BR>                                                                                            entonces<BR>                                                                                              <CONTINUA>
Expresion046=<CONTINUA>  ReporteImpresora(<T>FacturaMAVIMayoreo12Imp<T>,Venta:Venta.ID,1)<BR>                                                                                                EjecutarSQL(<T>spConsecutivoImpresion :nID, :ncom<T>, Info.ID, 3)<BR>                                                                                            sino<BR>                                                                                                Si (SQL(<T>exec SP_MaviDM0116BuscarCombinacion :nFas, :nId, :nSuc, :tMov, :tMovId, :tCond, :tCat<T>, 2, Venta:Venta.ID, Venta:Venta.SucursalDestino, Venta:Venta.Mov,  Venta:Venta.MovID, Venta:Venta.Condicion, Venta:CteEnviarA.Categoria)=0)<BR>                                                                                                    Entonces<BR>              <CONTINUA>
Expresion047=<CONTINUA>                                                                                          ReporteImpresora(<T>FacturaMAVIMayoreo12Imp<T>,Venta:Venta.ID,1)<BR>                                                                                                        EjecutarSQL(<T>spConsecutivoImpresion :nID, :ncom<T>, Info.ID, 3)<BR>                                                                                                    Sino<BR>                                                                                                        Si (SQL(<T>exec SP_MaviDM0116BuscarCombinacion :nFas, :nId, :nSuc, :tMov, :tMovId, :tCond, :tCat<T>, 2, Venta:Venta.ID, Venta:Venta.SucursalDestino, Venta:Venta.Mov,  Venta:Venta.MovID, Venta:Venta.Condicion, Venta:CteEnviarA.Categoria)>=<BR>               <CONTINUA>
Expresion048=<CONTINUA>                                                                                             (SQL(<T>Select Sum(A.Saldo) As Saldo From CxcPendiente A Where A.PadreMavi = :tMov and A.PadreIdMavi = :tMovId Group By A.PadreMavi, A.PadreIDMavi<T>, Venta:Venta.Mov,  Venta:Venta.MovID)))<BR>                                                                                                            Entonces<BR>                                                                                                                ReporteImpresora(<T>FacturaMAVIMayoreo12Imp<T>,Venta:Venta.ID,1)<BR>                                                                                                                EjecutarSQL(<T>spConsecutivoImpresion :nID, :ncom<T>, Info.ID, 3)<BR>                                 <CONTINUA>
Expresion049=<CONTINUA>                                                                       Fin<BR>                                                                                                Fin<BR>                                                                                        Fin<BR>                                                                                    sino<BR>                                                                                        Informacion(<T>Este reporte <T>+ COMILLAS(<T>CFD<T>)+<T> ya fue impreso. Su perfil de usuario no cuenta con privilegios para poder hacer una reimpresión del mismo.<T>)<BR>                                                                                Fin<BR>                                                                            Sino<BR>  <CONTINUA>
Expresion050=<CONTINUA>                                                                              Si (SQL(<T>exec SP_MaviDM0116BuscarCombinacion :nFas, :nId, :nSuc, :tMov, :tMovId, :tCond, :tCat<T>, 3, Venta:Venta.ID, Venta:Venta.SucursalDestino, Venta:Venta.Mov,  Venta:Venta.MovID, Venta:Venta.Condicion, Venta:CteEnviarA.Categoria)=<T>011<T>)<BR>                                                                                    Entonces<BR>                                                                                        si (sql(<T>select isnull(ContImpSimp,0) from venta where id=:nId<T>,Venta:Venta.ID)=0)<BR>                                                                                            entonces<BR>                                                                                             <CONTINUA>
Expresion051=<CONTINUA>   ReporteImpresora(<T>FacturaMAVIMayoreo12Imp<T>,Venta:Venta.ID,2)<BR>                                                                                                EjecutarSQL(<T>spConsecutivoImpresion :nID, :ncom<T>, Info.ID, 2)<BR>                                                                                            sino<BR>                                                                                                Informacion(<T>Este reporte <T>+ COMILLAS(<T>Copia<T>)+<T> ya fue impreso. Su perfil de usuario no cuenta con privilegios para poder hacer una reimpresión del mismo.<T>)<BR>                                                                                        Fin<BR>                                                                                        si (sql(<T>s<CONTINUA>
Expresion052=<CONTINUA>elect isnull(ContImpCiego,0) from venta where id=:nId<T>,Venta:Venta.ID)=0)<BR>                                                                                            entonces<BR>                                                                                                ReporteImpresora(<T>FacturaMAVIMayoreo12Imp<T>,Venta:Venta.ID,3)<BR>                                                                                                EjecutarSQL(<T>spConsecutivoImpresion :nID, :ncom<T>, Info.ID, 1)<BR>                                                                                            sino<BR>                                                                                                Informacion(<T>Este reporte <T>+ COMILLAS(<T>Copia Embarque<T>)+<T> ya fue impreso. Su perfi<CONTINUA>
Expresion053=<CONTINUA>l de usuario no cuenta con privilegios para poder hacer una reimpresión del mismo.<T>)<BR>                                                                                        Fin<BR>                                                                                    Sino<BR>                                                                                        Si (SQL(<T>exec SP_MaviDM0116BuscarCombinacion :nFas, :nId, :nSuc, :tMov, :tMovId, :tCond, :tCat<T>, 3, Venta:Venta.ID, Venta:Venta.SucursalDestino, Venta:Venta.Mov,  Venta:Venta.MovID, Venta:Venta.Condicion, Venta:CteEnviarA.Categoria)=<T>010<T>)<BR>                                                                                            Entonces<BR>                                                                                <CONTINUA>
Expresion054=<CONTINUA>                si (sql(<T>select isnull(ContImpSimp,0) from venta where id=:nId<T>,Venta:Venta.ID)=0)<BR>                                                                                                    entonces<BR>                                                                                                        ReporteImpresora(<T>FacturaMAVIMayoreo12Imp<T>,Venta:Venta.ID,2)<BR>                                                                                                        EjecutarSQL(<T>spConsecutivoImpresion :nID, :ncom<T>, Info.ID, 2)<BR>                                                                                                    sino<BR>                                                                                                        Informacion(<T>Este repor<CONTINUA>
Expresion055=<CONTINUA>te <T>+ COMILLAS(<T>Copia<T>)+<T> ya fue impreso. Su perfil de usuario no cuenta con privilegios para poder hacer una reimpresión del mismo.<T>)<BR>                                                                                                Fin<BR>                                                                                            Sino<BR>                                                                                                Si (SQL(<T>exec SP_MaviDM0116BuscarCombinacion :nFas, :nId, :nSuc, :tMov, :tMovId, :tCond, :tCat<T>, 3, Venta:Venta.ID, Venta:Venta.SucursalDestino, Venta:Venta.Mov,  Venta:Venta.MovID, Venta:Venta.Condicion, Venta:CteEnviarA.Categoria)=<T>001<T>)<BR>                                                                                                    En<CONTINUA>
Expresion056=<CONTINUA>tonces<BR>                                                                                                        si (sql(<T>select isnull(ContImpCiego,0) from venta where id=:nId<T>,Venta:Venta.ID)=0)<BR>                                                                                                            entonces<BR>                                                                                                                ReporteImpresora(<T>FacturaMAVIMayoreo12Imp<T>,Venta:Venta.ID,3)<BR>                                                                                                                EjecutarSQL(<T>spConsecutivoImpresion :nID, :ncom<T>, Info.ID, 1)<BR>                                                                                                            sino<B<CONTINUA>
Expresion057=<CONTINUA>R>                                                                                                                Informacion(<T>Este reporte <T>+ COMILLAS(<T>Copia Embarque<T>)+<T> ya fue impreso. Su perfil de usuario no cuenta con privilegios para poder hacer una reimpresión del mismo.<T>)<BR>                                                                                                        Fin<BR>                                                                                                Fin<BR>                                                                                        Fin<BR>                                                                                Fin<BR>                                                                        Fin<BR>                             <CONTINUA>
Expresion058=<CONTINUA>                                   Fin<BR>                                                        Fin<BR>                                                Fin<BR>                                        Fin<BR>                                    sino<BR>                                        Si (SQL(<T>Select right(Valor,1) From TablaStd where TablaSt=:tda and Nombre in (SELECT ACCESO FROM USUARIO WHERE Usuario =:tUsu)<T>,<T>CFD PERFILES P/IMPRESION<T>,Usuario)=1)<BR>                                            entonces<BR>                                                Si (SQL(<T>exec SP_MaviDM0116BuscarCombinacion :nFas, :nId, :nSuc, :tMov, :tMovId, :tCond, :tCat<T>, 3, Venta:Venta.ID, Venta:Venta.SucursalDestino, Venta:Venta.Mov,  Venta:Venta.MovID, Venta:Venta.Condicion, Venta:CteEnviarA.<CONTINUA>
Expresion059=<CONTINUA>Categoria)=<T>111<T>)<BR>                                                    Entonces<BR>                                                        ReporteImpresora(<T>FacturaMAVIMayoreo12Imp<T>,Venta:Venta.ID,2)<BR>                                                        EjecutarSQL(<T>spConsecutivoImpresion :nID, :ncom<T>, Info.ID, 2)<BR>                                                        ReporteImpresora(<T>FacturaMAVIMayoreo12Imp<T>,Venta:Venta.ID,3)<BR>                                                        EjecutarSQL(<T>spConsecutivoImpresion :nID, :ncom<T>, Info.ID, 1)<BR>                                                        ReporteImpresora(<T>FacturaMAVIMayoreo12Imp<T>,Venta:Venta.ID,1)<BR>                                                        EjecutarSQL(<T>spConsecutivoImpre<CONTINUA>
Expresion060=<CONTINUA>sion :nID, :ncom<T>, Info.ID, 3)<BR>                                                    Sino<BR>                                                        Si (SQL(<T>exec SP_MaviDM0116BuscarCombinacion :nFas, :nId, :nSuc, :tMov, :tMovId, :tCond, :tCat<T>, 3, Venta:Venta.ID, Venta:Venta.SucursalDestino, Venta:Venta.Mov,  Venta:Venta.MovID, Venta:Venta.Condicion, Venta:CteEnviarA.Categoria)=<T>110<T>)<BR>                                                            Entonces<BR>                                                                ReporteImpresora(<T>FacturaMAVIMayoreo12Imp<T>,Venta:Venta.ID,2)<BR>                                                                EjecutarSQL(<T>spConsecutivoImpresion :nID, :ncom<T>, Info.ID, 2)<BR>                                                            <CONTINUA>
Expresion061=<CONTINUA>    ReporteImpresora(<T>FacturaMAVIMayoreo12Imp<T>,Venta:Venta.ID,1)<BR>                                                                EjecutarSQL(<T>spConsecutivoImpresion :nID, :ncom<T>, Info.ID, 3)<BR>                                                            Sino<BR>                                                                Si (SQL(<T>exec SP_MaviDM0116BuscarCombinacion :nFas, :nId, :nSuc, :tMov, :tMovId, :tCond, :tCat<T>, 3, Venta:Venta.ID, Venta:Venta.SucursalDestino, Venta:Venta.Mov,  Venta:Venta.MovID, Venta:Venta.Condicion, Venta:CteEnviarA.Categoria)=<T>101<T>)<BR>                                                                    Entonces<BR>                                                                        ReporteImpresora(<T>FacturaMAVIMayoreo12Imp<T>,Venta:Venta.I<CONTINUA>
Expresion062=<CONTINUA>D,3)<BR>                                                                        EjecutarSQL(<T>spConsecutivoImpresion :nID, :ncom<T>, Info.ID, 1)<BR>                                                                        ReporteImpresora(<T>FacturaMAVIMayoreo12Imp<T>,Venta:Venta.ID,1)<BR>                                                                        EjecutarSQL(<T>spConsecutivoImpresion :nID, :ncom<T>, Info.ID, 3)<BR>                                                                    Sino<BR>                                                                        Si (SQL(<T>exec SP_MaviDM0116BuscarCombinacion :nFas, :nId, :nSuc, :tMov, :tMovId, :tCond, :tCat<T>, 3, Venta:Venta.ID, Venta:Venta.SucursalDestino, Venta:Venta.Mov,  Venta:Venta.MovID, Venta:Venta.Condicion, Venta:CteEnvi<CONTINUA>
Expresion063=<CONTINUA>arA.Categoria)=<T>100<T>)<BR>                                                                            Entonces<BR>                                                                                ReporteImpresora(<T>FacturaMAVIMayoreo12Imp<T>,Venta:Venta.ID,1)<BR>                                                                                EjecutarSQL(<T>spConsecutivoImpresion :nID, :ncom<T>, Info.ID, 3)<BR>                                                                            Sino<BR>                                                                                Si (SQL(<T>exec SP_MaviDM0116BuscarCombinacion :nFas, :nId, :nSuc, :tMov, :tMovId, :tCond, :tCat<T>, 3, Venta:Venta.ID, Venta:Venta.SucursalDestino, Venta:Venta.Mov,  Venta:Venta.MovID, Venta:Venta.Condicion, Venta:CteEnvi<CONTINUA>
Expresion064=<CONTINUA>arA.Categoria)=<T>011<T>)<BR>                                                                                    Entonces<BR>                                                                                        ReporteImpresora(<T>FacturaMAVIMayoreo12Imp<T>,Venta:Venta.ID,2)<BR>                                                                                        EjecutarSQL(<T>spConsecutivoImpresion :nID, :ncom<T>, Info.ID, 2)<BR>                                                                                        ReporteImpresora(<T>FacturaMAVIMayoreo12Imp<T>,Venta:Venta.ID,3)<BR>                                                                                        EjecutarSQL(<T>spConsecutivoImpresion :nID, :ncom<T>, Info.ID, 1)<BR>                                                 <CONTINUA>
Expresion065=<CONTINUA>                                   Sino<BR>                                                                                        Si (SQL(<T>exec SP_MaviDM0116BuscarCombinacion :nFas, :nId, :nSuc, :tMov, :tMovId, :tCond, :tCat<T>, 3, Venta:Venta.ID, Venta:Venta.SucursalDestino, Venta:Venta.Mov,  Venta:Venta.MovID, Venta:Venta.Condicion, Venta:CteEnviarA.Categoria)=<T>010<T>)<BR>                                                                                            Entonces<BR>                                                                                                ReporteImpresora(<T>FacturaMAVIMayoreo12Imp<T>,Venta:Venta.ID,2)<BR>                                                                                                EjecutarSQL(<T>spConsecutivoImpresion :nID, :ncom<T>, <CONTINUA>
Expresion066=<CONTINUA>Info.ID, 2)<BR>                                                                                            Sino<BR>                                                                                                Si (SQL(<T>exec SP_MaviDM0116BuscarCombinacion :nFas, :nId, :nSuc, :tMov, :tMovId, :tCond, :tCat<T>, 3, Venta:Venta.ID, Venta:Venta.SucursalDestino, Venta:Venta.Mov,  Venta:Venta.MovID, Venta:Venta.Condicion, Venta:CteEnviarA.Categoria)=<T>001<T>)<BR>                                                                                                    Entonces<BR>                                                                                                        ReporteImpresora(<T>FacturaMAVIMayoreo12Imp<T>,Venta:Venta.ID,3)<BR>                                                      <CONTINUA>
Expresion067=<CONTINUA>                                                  EjecutarSQL(<T>spConsecutivoImpresion :nID, :ncom<T>, Info.ID, 1)<BR>                                                                                                Fin<BR>                                                                                        Fin<BR>                                                                                Fin<BR>                                                                        Fin<BR>                                                                Fin<BR>                                                        Fin<BR>                                                Fin<BR>                                            sino<BR>                                                Si (SQL(<T>exec SP_MaviDM011<CONTINUA>
Expresion068=<CONTINUA>6BuscarCombinacion :nFas, :nId, :nSuc, :tMov, :tMovId, :tCond, :tCat<T>, 3, Venta:Venta.ID, Venta:Venta.SucursalDestino, Venta:Venta.Mov,  Venta:Venta.MovID, Venta:Venta.Condicion, Venta:CteEnviarA.Categoria)=<T>111<T>)<BR>                                                    Entonces<BR>                                                        si (sql(<T>select isnull(ContImpSimp,0) from venta where id=:nId<T>,Venta:Venta.ID)=0)<BR>                                                            entonces<BR>                                                                ReporteImpresora(<T>FacturaMAVIMayoreo12Imp<T>,Venta:Venta.ID,2)<BR>                                                                EjecutarSQL(<T>spConsecutivoImpresion :nID, :ncom<T>, Info.ID, 2)<BR>                              <CONTINUA>
Expresion069=<CONTINUA>                              sino<BR>                                                                Informacion(<T>Este reporte <T>+ COMILLAS(<T>Copia<T>)+<T> ya fue impreso. Su perfil de usuario no cuenta con privilegios para poder hacer una reimpresión del mismo.<T>)<BR>                                                        Fin<BR>                                                        si (sql(<T>select isnull(ContImpCiego,0) from venta where id=:nId<T>,Venta:Venta.ID)=0)<BR>                                                            entonces<BR>                                                                ReporteImpresora(<T>FacturaMAVIMayoreo12Imp<T>,Venta:Venta.ID,3)<BR>                                                                EjecutarSQL(<T>spConsecutivoImpresion :nID, :nc<CONTINUA>
Expresion070=<CONTINUA>om<T>, Info.ID, 1)<BR>                                                            sino<BR>                                                                Informacion(<T>Este reporte <T>+ COMILLAS(<T>Copia Embarque<T>)+<T> ya fue impreso. Su perfil de usuario no cuenta con privilegios para poder hacer una reimpresión del mismo.<T>)<BR>                                                        Fin<BR>                                                        si (sql(<T>select isnull(ContImpCFD,0) from venta where id=:nId<T>,Venta:Venta.ID)=0)<BR>                                                            entonces<BR>                                                                ReporteImpresora(<T>FacturaMAVIMayoreo12Imp<T>,Venta:Venta.ID,1)<BR>                                                    <CONTINUA>
Expresion071=<CONTINUA>            EjecutarSQL(<T>spConsecutivoImpresion :nID, :ncom<T>, Info.ID, 3)<BR>                                                            sino<BR>                                                                Informacion(<T>Este reporte <T>+ COMILLAS(<T>CFD<T>)+<T> ya fue impreso. Su perfil de usuario no cuenta con privilegios para poder hacer una reimpresión del mismo.<T>)<BR>                                                        Fin<BR>                                                    Sino<BR>                                                        Si (SQL(<T>exec SP_MaviDM0116BuscarCombinacion :nFas, :nId, :nSuc, :tMov, :tMovId, :tCond, :tCat<T>, 3, Venta:Venta.ID, Venta:Venta.SucursalDestino, Venta:Venta.Mov,  Venta:Venta.MovID, Venta:Venta.Condicion, Venta:CteEnviarA.Categoria)=<CONTINUA>
Expresion072=<CONTINUA><T>110<T>)<BR>                                                            Entonces<BR>                                                                si (sql(<T>select isnull(ContImpSimp,0) from venta where id=:nId<T>,Venta:Venta.ID)=0)<BR>                                                                    entonces<BR>                                                                        ReporteImpresora(<T>FacturaMAVIMayoreo12Imp<T>,Venta:Venta.ID,2)<BR>                                                                        EjecutarSQL(<T>spConsecutivoImpresion :nID, :ncom<T>, Info.ID, 2)<BR>                                                                    sino<BR>                                                                        Informacion(<T>Este reporte <T>+ COMILLAS(<T>Copia<<CONTINUA>
Expresion073=<CONTINUA>T>)+<T> ya fue impreso. Su perfil de usuario no cuenta con privilegios para poder hacer una reimpresión del mismo.<T>)<BR>                                                                Fin<BR>                                                                si (sql(<T>select isnull(ContImpCFD,0) from venta where id=:nId<T>,Venta:Venta.ID)=0)<BR>                                                                    entonces<BR>                                                                        ReporteImpresora(<T>FacturaMAVIMayoreo12Imp<T>,Venta:Venta.ID,1)<BR>                                                                        EjecutarSQL(<T>spConsecutivoImpresion :nID, :ncom<T>, Info.ID, 3)<BR>                                                                    sino<BR>                 <CONTINUA>
Expresion074=<CONTINUA>                                                       Informacion(<T>Este reporte <T>+ COMILLAS(<T>CFD<T>)+<T> ya fue impreso. Su perfil de usuario no cuenta con privilegios para poder hacer una reimpresión del mismo.<T>)<BR>                                                                Fin    <BR>                                                            Sino<BR>                                                                Si (SQL(<T>exec SP_MaviDM0116BuscarCombinacion :nFas, :nId, :nSuc, :tMov, :tMovId, :tCond, :tCat<T>, 3, Venta:Venta.ID, Venta:Venta.SucursalDestino, Venta:Venta.Mov,  Venta:Venta.MovID, Venta:Venta.Condicion, Venta:CteEnviarA.Categoria)=<T>101<T>)<BR>                                                                    Entonces<BR>                                    <CONTINUA>
Expresion075=<CONTINUA>                                    si (sql(<T>select isnull(ContImpCiego,0) from venta where id=:nId<T>,Venta:Venta.ID)=0)<BR>                                                                            entonces<BR>                                                                                ReporteImpresora(<T>FacturaMAVIMayoreo12Imp<T>,Venta:Venta.ID,3)<BR>                                                                                EjecutarSQL(<T>spConsecutivoImpresion :nID, :ncom<T>, Info.ID, 1)<BR>                                                                            sino<BR>                                                                                Informacion(<T>Este reporte <T>+ COMILLAS(<T>Copia Embarque<T>)+<T> ya fue impreso. Su perfil de usuario no cuenta con privi<CONTINUA>
Expresion076=<CONTINUA>legios para poder hacer una reimpresión del mismo.<T>)<BR>                                                                        Fin <BR>                                                                        si (sql(<T>select isnull(ContImpCFD,0) from venta where id=:nId<T>,Venta:Venta.ID)=0)<BR>                                                                            entonces<BR>                                                                                ReporteImpresora(<T>FacturaMAVIMayoreo12Imp<T>,Venta:Venta.ID,1)<BR>                                                                                EjecutarSQL(<T>spConsecutivoImpresion :nID, :ncom<T>, Info.ID, 3)<BR>                                                                            sino<BR>                                <CONTINUA>
Expresion077=<CONTINUA>                                                Informacion(<T>Este reporte <T>+ COMILLAS(<T>CFD<T>)+<T> ya fue impreso. Su perfil de usuario no cuenta con privilegios para poder hacer una reimpresión del mismo.<T>)<BR>                                                                        Fin   <BR>                                                                    Sino<BR>                                                                        Si (SQL(<T>exec SP_MaviDM0116BuscarCombinacion :nFas, :nId, :nSuc, :tMov, :tMovId, :tCond, :tCat<T>, 3, Venta:Venta.ID, Venta:Venta.SucursalDestino, Venta:Venta.Mov,  Venta:Venta.MovID, Venta:Venta.Condicion, Venta:CteEnviarA.Categoria)=<T>100<T>)<BR>                                                                            Entonces<BR>            <CONTINUA>
Expresion078=<CONTINUA>                                                                    si (sql(<T>select isnull(ContImpCFD,0) from venta where id=:nId<T>,Venta:Venta.ID)=0)<BR>                                                                                    entonces<BR>                                                                                        ReporteImpresora(<T>FacturaMAVIMayoreo12Imp<T>,Venta:Venta.ID,1)<BR>                                                                                        EjecutarSQL(<T>spConsecutivoImpresion :nID, :ncom<T>, Info.ID, 3)<BR>                                                                                    sino<BR>                                                                                        Informacion(<T>Este reporte <T>+ COMILLAS(<T>CFD<T>)+<<CONTINUA>
Expresion079=<CONTINUA>T> ya fue impreso. Su perfil de usuario no cuenta con privilegios para poder hacer una reimpresión del mismo.<T>)<BR>                                                                                Fin<BR>                                                                            Sino<BR>                                                                                Si (SQL(<T>exec SP_MaviDM0116BuscarCombinacion :nFas, :nId, :nSuc, :tMov, :tMovId, :tCond, :tCat<T>, 3, Venta:Venta.ID, Venta:Venta.SucursalDestino, Venta:Venta.Mov,  Venta:Venta.MovID, Venta:Venta.Condicion, Venta:CteEnviarA.Categoria)=<T>011<T>)<BR>                                                                                    Entonces<BR>                                                                                     <CONTINUA>
Expresion080=<CONTINUA>   si (sql(<T>select isnull(ContImpSimp,0) from venta where id=:nId<T>,Venta:Venta.ID)=0)<BR>                                                                                            entonces<BR>                                                                                                ReporteImpresora(<T>FacturaMAVIMayoreo12Imp<T>,Venta:Venta.ID,2)<BR>                                                                                                EjecutarSQL(<T>spConsecutivoImpresion :nID, :ncom<T>, Info.ID, 2)<BR>                                                                                            sino<BR>                                                                                                Informacion(<T>Este reporte <T>+ COMILLAS(<T>Copia<T>)+<T> ya fue impreso. Su <CONTINUA>
Expresion081=<CONTINUA>perfil de usuario no cuenta con privilegios para poder hacer una reimpresión del mismo.<T>)<BR>                                                                                        Fin<BR>                                                                                        si (sql(<T>select isnull(ContImpCiego,0) from venta where id=:nId<T>,Venta:Venta.ID)=0)<BR>                                                                                            entonces<BR>                                                                                                ReporteImpresora(<T>FacturaMAVIMayoreo12Imp<T>,Venta:Venta.ID,3)<BR>                                                                                                EjecutarSQL(<T>spConsecutivoImpresion :nID, :ncom<T>, Info.ID, 1)<B<CONTINUA>
Expresion082=<CONTINUA>R>                                                                                            sino<BR>                                                                                                Informacion(<T>Este reporte <T>+ COMILLAS(<T>Copia Embarque<T>)+<T> ya fue impreso. Su perfil de usuario no cuenta con privilegios para poder hacer una reimpresión del mismo.<T>)<BR>                                                                                        Fin<BR>                                                                                    Sino<BR>                                                                                        Si (SQL(<T>exec SP_MaviDM0116BuscarCombinacion :nFas, :nId, :nSuc, :tMov, :tMovId, :tCond, :tCat<T>, 3, Venta:Venta.ID, Venta:Venta.SucursalDesti<CONTINUA>
Expresion083=<CONTINUA>no, Venta:Venta.Mov,  Venta:Venta.MovID, Venta:Venta.Condicion, Venta:CteEnviarA.Categoria)=<T>010<T>)<BR>                                                                                            Entonces<BR>                                                                                                si (sql(<T>select isnull(ContImpSimp,0) from venta where id=:nId<T>,Venta:Venta.ID)=0)<BR>                                                                                                    entonces<BR>                                                                                                        ReporteImpresora(<T>FacturaMAVIMayoreo12Imp<T>,Venta:Venta.ID,2)<BR>                                                                                                        EjecutarSQL(<T>s<CONTINUA>
Expresion084=<CONTINUA>pConsecutivoImpresion :nID, :ncom<T>, Info.ID, 2)<BR>                                                                                                    sino<BR>                                                                                                        Informacion(<T>Este reporte <T>+ COMILLAS(<T>Copia<T>)+<T> ya fue impreso. Su perfil de usuario no cuenta con privilegios para poder hacer una reimpresión del mismo.<T>)<BR>                                                                                                Fin<BR>                                                                                            Sino<BR>                                                                                                Si (SQL(<T>exec SP_MaviDM0116BuscarCombinacion :nFas, :nId, :nS<CONTINUA>
Expresion085=<CONTINUA>uc, :tMov, :tMovId, :tCond, :tCat<T>, 3, Venta:Venta.ID, Venta:Venta.SucursalDestino, Venta:Venta.Mov,  Venta:Venta.MovID, Venta:Venta.Condicion, Venta:CteEnviarA.Categoria)=<T>001<T>)<BR>                                                                                                    Entonces<BR>                                                                                                        si (sql(<T>select isnull(ContImpCiego,0) from venta where id=:nId<T>,Venta:Venta.ID)=0)<BR>                                                                                                            entonces<BR>                                                                                                                ReporteImpresora(<T>FacturaMAVIMayoreo12Imp<T>,Venta:Venta.ID,3)<BR>     <CONTINUA>
Expresion086=<CONTINUA>                                                                                                           EjecutarSQL(<T>spConsecutivoImpresion :nID, :ncom<T>, Info.ID, 1)<BR>                                                                                                            sino<BR>                                                                                                                Informacion(<T>Este reporte <T>+ COMILLAS(<T>Copia Embarque<T>)+<T> ya fue impreso. Su perfil de usuario no cuenta con privilegios para poder hacer una reimpresión del mismo.<T>)<BR>                                                                                                        Fin<BR>                                                                                                Fin<BR><CONTINUA>
Expresion087=<CONTINUA>                                                                                        Fin<BR>                                                                                Fin<BR>                                                                        Fin<BR>                                                                Fin<BR>                                                        Fin<BR>                                                Fin<BR>                                        Fin<BR>                                Fin<BR>                        Fin<BR>                Fin<BR>        Fin<BR>    SINO<BR>        Si Venta:Venta.Mov en(<T>Credilana<T>, <T>Prestamo Personal<T>, <T>Seguro Vida<T>, <T>Seguro Auto<T>)<BR>            Entonces<BR>                ReporteImpresora(ReporteMovImp<CONTINUA>
Expresion088=<CONTINUA>resora(Info.SubModuloVenta, Venta:Venta.Mov, Venta:Venta.Estatus), Venta:Venta.ID)<BR>                ReporteImpresora(ReporteMovImpresora(Info.SubModuloVenta, Venta:Venta.Mov, Venta:Venta.Estatus), Venta:Venta.ID)<BR>            Sino<BR>                    si Mavi.RM0847Cont = 0<BR>                    entonces                <BR>                            ReporteImpresora(ReporteMovImpresora(Info.SubModuloVenta, Venta:Venta.Mov, Venta:Venta.Estatus), Venta:Venta.ID)<BR>                    fin<BR>        Fin<BR>Fin                                                          <BR>Asigna(Info.SubModuloVenta,<T>VTAS<T>)
AntesExpresiones=SI((Venta:Venta.Mov en(<T>Factura<T>,<T>Credilana<T>,<T>Seguro Vida<T>,<T>Factura VIU<T>,<T>Prestamo Personal<T>)) y (SQL(<T>Select Count(Aval) from AsignacionAvalesClientesJob Where Aval=:tcli<T>,Venta:Venta.Cliente) > 0 ),Ejecutar(<T>PlugIns\Inte602.exe <T>+Venta:Venta.Cliente+<T> <T>+ Usuario +<T> N 0 S <T>+Venta:Venta.UEN,Verdadero),Falso)<BR>Caso SQL(<T> SET ANSI_WARNINGS ON SET ANSI_NULLS ON Select * from  dbo.FN_DM0275ImprimePedido (<T>+Comillas(Venta:Venta.ID)+<T>)<T>)<BR>  Es <T>NO<T> Entonces Asigna(Info.Numero,0)<BR>  SINO<BR>    Asigna(Info.Numero,1)<BR>Fin<BR>Caso SQL(<T> Select dbo.FN_ValidaImpresionPedido (<T>+Comillas(Venta:Venta.ID)+<T>)<T>)<BR>  Es <T>0<T> Entonces Asigna(Mavi.DM0275ValidaImpresion,1)<BR>  SINO<BR>    Asigna(Mavi.DM0275ValidaImpresion,0)<BR>Fin<BR><BR>SI <CONTINUA>
AntesExpresiones002=<CONTINUA>(Mavi.DM0275ValidaImpresion = 0) y (Venta:Venta.Mov <> <T>Factura<T>) y (Info.Numero = 0)<BR>Entonces<BR>  si(Precaucion(<T>NO ES NECESARIO IMPRIMIR EL PEDIDO ¿DESEA IMPRIMIR?<T>, BotonAceptar , BotonCancelar )=  BotonCancelar,AbortarOperacion)<BR><BR>FIN<BR>SI (Info.Numero = 1) y (Venta:Venta.Mov <> <T>Factura<T>) Y (Mavi.DM0275ValidaImpresion = 0)<BR>Entonces<BR>si(Precaucion(<T>NO ES NECESARIO IMPRIMIR EL PEDIDO ¿DESEA IMPRIMIR?<T>, BotonAceptar , BotonCancelar )=  BotonCancelar,AbortarOperacion)<BR>FIN<BR>//SI Info.Numero = 1 Y Mavi.DM0275ValidaImpresion = 1<BR>//ENTONCES<BR>SI (Venta:Venta.Mov en (<T>Solicitud Credito<T>,<T>Analisis Credito<T>,<T>Solicitud Mayoreo<T>,<T>Analisis Mayoreo<T>)) o ((Venta:Venta.Mov en(<T>Pedido<T>,<T>Pedido Mayoreo<T>)) y (Venta:Venta.Estatus <> <T>CANCEL<CONTINUA>
AntesExpresiones003=<CONTINUA>ADO<T>))<BR>   ENTONCES<BR>       SI<BR>        SQL(<T>SELECT CATEGORIA FROM VentasCanalMavi WHERE ID=:nId<T>,Venta:Venta.EnviarA)=<T>INSTITUCIONES<T> y  (Venta:Venta.Mov en(<T>Solicitud Credito<T>,<T>Analisis Credito<T>))<BR>           ENTONCES<BR>                ASIGNA(Info.Fecha,Venta:Venta.FechaEmision)<BR>                ASIGNA(Mavi.ListaPedidosNew,Venta:Venta.ID)<BR>                ReportePantalla(<T>RM0847BSolCreditoInsPisoRep<T>)<BR>                asigna(Mavi.RM0847Cont,1)<BR>            SINO<BR>                    SI  SQL(<T>SELECT CATEGORIA FROM VentasCanalMavi WHERE ID=:nId<T>,Venta:Venta.EnviarA)=<T>CREDITO MENUDEO<T><BR>                        ENTONCES<BR>                               SI<BR>                                   SQL(<T>SELECT dbo.FN_DM0169ValidarPagares (<T>+com<CONTINUA>
AntesExpresiones004=<CONTINUA>illas(Venta:Venta.Cliente)+<T>)<T>)=1<BR>                               ENTONCES<BR>                                   ASIGNA(Info.SubModuloVenta,<T>RM0847MaviCredRelPedXClienteRepImp<T>)<BR>                                   ASIGNA(Info.Fecha,Venta:Venta.FechaEmision)<BR>                                   ASIGNA(Mavi.ListaPedidosNew,Venta:Venta.ID)<BR>                                   asigna(Mavi.RM0847Cont,0)<BR>                               SINO<BR>                                   SI<BR>                                       Precaucion(<T>NO ES NECESARIO IMPRIMIR EL PEDIDO ¿DESEA IMPRIMIR?<T>, BotonAceptar , BotonCancelar )=  BotonAceptar<BR>                                   ENTONCES<BR>                                       ASIGNA(Info.SubModuloVenta,<T>RM0847MaviCredRelPedXClient<CONTINUA>
AntesExpresiones005=<CONTINUA>eRepImp<T>)<BR>                                       ASIGNA(Info.Fecha,Venta:Venta.FechaEmision)<BR>                                       ASIGNA(Mavi.ListaPedidosNew,Venta:Venta.ID)<BR>                                       asigna(Mavi.RM0847Cont,0)<BR>                                   SINO<BR>                                       ASIGNA(Info.SubModuloVenta,<T>RM0847MaviCredRelPedXClienteRepImp<T>)<BR>                                       asigna(Mavi.RM0847Cont,1)<BR>                                   FIN<BR>                               FIN<BR>                   SINO<BR>                            ASIGNA(Info.SubModuloVenta,<T>RM0847MaviCredRelPedXClienteMayRepImp<T>)<BR>                            ASIGNA(Info.Fecha,Venta:Venta.FechaEmision)<BR>                            ASIGNA(Mav<CONTINUA>
AntesExpresiones006=<CONTINUA>i.ListaPedidosNew,Venta:Venta.ID)<BR>                            asigna(Mavi.RM0847Cont,0)<BR>                    FIN<BR>       FIN<BR>       SI  SQL(<T>SELECT Cadena FROM VentasCanalMavi WHERE ID=:nId<T>,Venta:Venta.EnviarA)=<T>VENTA VALE<T> y  (Venta:Venta.Mov en(<T>Solicitud Credito<T>,<T>Analisis Credito<T>,<T>Pedido<T>))<BR>           ENTONCES<BR>                ASIGNA(Info.Fecha,Venta:Venta.FechaEmision)<BR>                ASIGNA(Mavi.ListaPedidosNew,Venta:Venta.ID)<BR>                ReportePantalla(<T>RM0847FSolCredVntValeREP<T>)<BR>                asigna(Mavi.RM0847Cont,1)<BR>      FIN<BR>FIN<BR>//FIN<BR>Si Venta:Venta.Mov en(<T>Credilana<T>,<T>Prestamo Personal<T>,<T>Seguro Vida<T>,<T>Seguro Auto<T>)<BR>        Entonces<BR>            SI SQL(<T>SELECT COUNT(Numero) FROM dbo.Tabla<CONTINUA>
AntesExpresiones007=<CONTINUA>NumD WHERE TablaNum=:tTab AND CAST(Numero AS INT)=:nSuc<T>, <T>SUCURSALES RDP<T>, Sucursal)=1<BR>             Entonces<BR>                 Asigna(Info.SubModuloVenta,<T><T>)<BR>                 Ejecutar(<T>PlugIns\RutaTicket.exe <T>+<T>VTAS<T>+<T> <T>+Venta:Venta.ID+<T> <T>+Usuario+<T> <T>+<T>1<T>+<T> <T>+Sucursal+<T> <T>+EstacionTrabajo)<BR>             Sino<BR>                 Asigna(Info.SubModuloVenta,<T><T>)<BR>                 Ejecutar(<T>C:\AppsMavi\Factura.exe <T>+Venta:Venta.ID+<T> <T>+Usuario+<T> 1 <T>+Sucursal)<BR>             Fin<BR> Fin<BR>Si<BR>  (SQL(<T>Select Count(*) from AsignacionAvalesClientesJob With(NoLock) where Aval =:tCte<T>,Venta:Venta.Cliente) > 0 ) y (Venta:Venta.Mov en(<T>Factura<T>,<T>Credilana<T>,<T>Seguro Vida<T>,<T>Factura VIU<T>,<T>Prestamo Personal<T>))<B<CONTINUA>
AntesExpresiones008=<CONTINUA>R>Entonces<BR>Precaucion(<T>Informar al cliente que su limite de crédito ha sido disminuido.<BR> Es aval de clientes con cuentas vencidas... Ver detalles en el recibo,<BR> parte inferior<T>)<BR>Sino<BR>  Verdadero<BR>Fin

;*** Integracion de validaciones nuevas visible condicion y activo condicion BVF 14092011 paquete DM0116_14092011
;*** Integracion validaciones en expresion en accion impresion de CFD BVF 08082011 paquete DM0116_08082011 
;*** Integracion validaciones en expresion para impresion de CFD paqeute DM0116_23062011 BVF 23062011
;Modificacion victor 25082010 se modifico la accion para que funcionara llamando los reportes correspondientes segun el movimiento
;Modificacion andres 11/10/2010 SE AÑADIO CONDICIONANTE PARA PODER ENVIAR EL REPORTE RM0847 CUANDO EL MOV DE LA FACTURA SEA SOLICITUD CREDITO
;Adecuacion para CFD muestra el reporte acorde a la condicion y tipo de condicion de la factura BVF 01122010
;**** Se modificaron las expresiones al Cerrar paquete Servicasa / Servicred BVF 11/03/2011
; ***** Integracion validaciones en expresion para el desarrollo de CFD dentro del paquete DM_CFD_12052011. Se agrega la configuracion para imprimir los formatos de factura... tanto de CFD como el embarque y la copia TEG 12052011. JR 12-May-2011. *****
; ***** Integracion validaciones en expresion para reporte en pantalla  Factura Mayoreo CFD,Simplificado y Ciego BVF 17052011
; **** Modificacion de Expresion para desarrollo DM0116 Impresiones por Sucursal dentro del paquete DM0116_08062012. JR 08-Jun-2012.****
; **** Modificacion de Visisble, VisibleCondicion, expresion y antesexpresiones para desarrollo DM0116 CFD dentro del paquete DM0116_06072012. JR 06-Jul-2012. **** 
;***** 14/07/2012 Carmen Quintana Ramírez,Se modificaron las acciones para que se impriman Solicitudes y Análisis tanto de Credito como de Mayoreo. Integra BVF 16072012
;**** Modificacion a antesexpresiones y expresiones dentro del paquete DM0116_18072012. JR 18-Jul-2012. ****

[Venta.frm/Acciones.RepPantalla]
ActivoCondicion=1=0
Antes=S
Visible=S
Expresion=Si (SQL(<T>Select count(Mov) From MovTipoCFDFlex Where Modulo = :tVta and Mov = :tMov<T>, <T>VTAS<T>, Venta:Venta.Mov))>0<BR>    Entonces<BR>        Si (SQL(<T>Select COUNT(*) From TablaStd where TablaSt=:tda and Nombre in (SELECT ACCESO FROM USUARIO WHERE Usuario =:tUsu)<T>,<T>CFD PERFILES P/IMPRESION<T>,Usuario)>0)<BR>            entonces<BR>                Si (SQL(<T>exec SP_MaviDM0116BuscarCombinacion :nFas, :nId, :nSuc, :tMov, :tMovId, :tCond, :tCat<T>, 4, Venta:Venta.ID, Venta:Venta.SucursalDestino, Venta:Venta.Mov,  Venta:Venta.MovID, Venta:Venta.Condicion, Venta:CteEnviarA.Categoria)=<T>TICKET<T>)<BR>                    entonces<BR>                        SI SQL(<T>SELECT COUNT(Numero) FROM dbo.TablaNumD WHERE TablaNum=:tTab AND CAST(Numero AS INT)=:nSuc<T>, <T>SUCURSALES RDP<T>, S<CONTINUA>
Expresion002=<CONTINUA>ucursal)=1<BR>                            Entonces<BR>                                Ejecutar(<T>PlugIns\RutaTicket.exe <T>+<T>VTAS<T>+<T> <T>+Venta:Venta.ID+<T> <T>+Usuario+<T> <T>+<T>0<T>+<T> <T>+Sucursal+<T> <T>+EstacionTrabajo)<BR>                            Sino<BR>                                Ejecutar(<T>C:\AppsMavi\Factura.exe <T>+Venta:Venta.ID+<T> <T>+Usuario+<T> 0 <T>+Sucursal)<BR>                        Fin<BR>                    Sino<BR>                        Si (SQL(<T>exec SP_MaviDM0116BuscarCombinacion :nFas, :nId, :nSuc, :tMov, :tMovId, :tCond, :tCat<T>, 4, Venta:Venta.ID, Venta:Venta.SucursalDestino, Venta:Venta.Mov,  Venta:Venta.MovID, Venta:Venta.Condicion, Venta:CteEnviarA.Categoria)=<T>CARTA<T>)<BR>                            entonces<BR>                          <CONTINUA>
Expresion003=<CONTINUA>      Si (SQL(<T>Select left(Valor,1) From TablaStd where TablaSt=:tda and Nombre in (SELECT ACCESO FROM USUARIO WHERE Usuario =:tUsu)<T>,<T>CFD PERFILES P/IMPRESION<T>,Usuario)=1)<BR>                                    entonces                                      <BR>                                        Si (SQL(<T>Select right(Valor,1) From TablaStd where TablaSt=:tda and Nombre in (SELECT ACCESO FROM USUARIO WHERE Usuario =:tUsu)<T>,<T>CFD PERFILES P/IMPRESION<T>,Usuario)=1)<BR>                                            entonces                           <BR>                                                Si (SQL(<T>exec SP_MaviDM0116BuscarCombinacion :nFas, :nId, :nSuc, :tMov, :tMovId, :tCond, :tCat<T>, 3, Venta:Venta.ID, Venta:Venta.SucursalDestino, Venta:Venta.Mov,  Venta:Venta.M<CONTINUA>
Expresion004=<CONTINUA>ovID, Venta:Venta.Condicion, Venta:CteEnviarA.Categoria)=<T>111<T>)<BR>                                                    Entonces<BR>                                                        ReportePantalla(<T>FacturaMAVIMayoreo<T>,Venta:Venta.ID,2)<BR>                                                        ReportePantalla(<T>FacturaMAVIMayoreo<T>,Venta:Venta.ID,3)<BR>                                                        Si VentaD:Art.Linea en (SQL(<T>SELECT Nombre FROM TablaSTD WHERE TablaSt = :tConv<T>, <T>EXCEPCIONES DM0116 IMPRESION CO<T>))<BR>                                                            Entonces<BR>                                                                ReportePantalla(<T>FacturaMAVIMayoreo<T>,Venta:Venta.ID,1)<BR>                                              <CONTINUA>
Expresion005=<CONTINUA>              sino<BR>                                                                Si (SQL(<T>exec SP_MaviDM0116BuscarCombinacion :nFas, :nId, :nSuc, :tMov, :tMovId, :tCond, :tCat<T>, 2, Venta:Venta.ID, Venta:Venta.SucursalDestino, Venta:Venta.Mov,  Venta:Venta.MovID, Venta:Venta.Condicion, Venta:CteEnviarA.Categoria)=0)<BR>                                                                    Entonces<BR>                                                                        ReportePantalla(<T>FacturaMAVIMayoreo<T>,Venta:Venta.ID,1)<BR>                                                                    Sino<BR>                                                                        Si (SQL(<T>exec SP_MaviDM0116BuscarCombinacion :nFas, :nId, :nSuc, :tMov, :tMovId, :tCond, :tCat<T>, 2, Venta<CONTINUA>
Expresion006=<CONTINUA>:Venta.ID, Venta:Venta.SucursalDestino, Venta:Venta.Mov,  Venta:Venta.MovID, Venta:Venta.Condicion, Venta:CteEnviarA.Categoria)>=<BR>                                                                            (SQL(<T>Select Sum(A.Saldo) As Saldo From CxcPendiente A Where A.PadreMavi = :tMov and A.PadreIdMavi = :tMovId Group By A.PadreMavi, A.PadreIDMavi<T>, Venta:Venta.Mov,  Venta:Venta.MovID)))<BR>                                                                            Entonces<BR>                                                                                ReportePantalla(<T>FacturaMAVIMayoreo<T>,Venta:Venta.ID,1)<BR>                                                                        Fin<BR>                                                                Fin<BR>                  <CONTINUA>
Expresion007=<CONTINUA>                                      Fin<BR>                                                    Sino<BR>                                                        Si (SQL(<T>exec SP_MaviDM0116BuscarCombinacion :nFas, :nId, :nSuc, :tMov, :tMovId, :tCond, :tCat<T>, 3, Venta:Venta.ID, Venta:Venta.SucursalDestino, Venta:Venta.Mov,  Venta:Venta.MovID, Venta:Venta.Condicion, Venta:CteEnviarA.Categoria)=<T>110<T>)<BR>                                                            Entonces<BR>                                                                ReportePantalla(<T>FacturaMAVIMayoreo<T>,Venta:Venta.ID,2)<BR>                                                                Si VentaD:Art.Linea en (SQL(<T>SELECT Nombre FROM TablaSTD WHERE TablaSt = :tConv<T>, <T>EXCEPCIONES DM0116 IMPRESION CO<T>))<<CONTINUA>
Expresion008=<CONTINUA>BR>                                                                    Entonces<BR>                                                                        ReportePantalla(<T>FacturaMAVIMayoreo<T>,Venta:Venta.ID,1)<BR>                                                                    sino<BR>                                                                        Si (SQL(<T>exec SP_MaviDM0116BuscarCombinacion :nFas, :nId, :nSuc, :tMov, :tMovId, :tCond, :tCat<T>, 2, Venta:Venta.ID, Venta:Venta.SucursalDestino, Venta:Venta.Mov,  Venta:Venta.MovID, Venta:Venta.Condicion, Venta:CteEnviarA.Categoria)=0)<BR>                                                                            Entonces<BR>                                                                                ReportePantalla(<T>Factu<CONTINUA>
Expresion009=<CONTINUA>raMAVIMayoreo<T>,Venta:Venta.ID,1)<BR>                                                                            Sino<BR>                                                                                Si (SQL(<T>exec SP_MaviDM0116BuscarCombinacion :nFas, :nId, :nSuc, :tMov, :tMovId, :tCond, :tCat<T>, 2, Venta:Venta.ID, Venta:Venta.SucursalDestino, Venta:Venta.Mov,  Venta:Venta.MovID, Venta:Venta.Condicion, Venta:CteEnviarA.Categoria)>=<BR>                                                                                    (SQL(<T>Select Sum(A.Saldo) As Saldo From CxcPendiente A Where A.PadreMavi = :tMov and A.PadreIdMavi = :tMovId Group By A.PadreMavi, A.PadreIDMavi<T>, Venta:Venta.Mov,  Venta:Venta.MovID)))<BR>                                                                               <CONTINUA>
Expresion010=<CONTINUA>     Entonces<BR>                                                                                        ReportePantalla(<T>FacturaMAVIMayoreo<T>,Venta:Venta.ID,1)<BR>                                                                                Fin<BR>                                                                        Fin<BR>                                                                Fin<BR>                                                            Sino<BR>                                                                Si (SQL(<T>exec SP_MaviDM0116BuscarCombinacion :nFas, :nId, :nSuc, :tMov, :tMovId, :tCond, :tCat<T>, 3, Venta:Venta.ID, Venta:Venta.SucursalDestino, Venta:Venta.Mov,  Venta:Venta.MovID, Venta:Venta.Condicion, Venta:CteEnviarA.Categoria)=<T>101<T>)<BR>             <CONTINUA>
Expresion011=<CONTINUA>                                                       Entonces<BR>                                                                        ReportePantalla(<T>FacturaMAVIMayoreo<T>,Venta:Venta.ID,3)<BR>                                                                        Si VentaD:Art.Linea en (SQL(<T>SELECT Nombre FROM TablaSTD WHERE TablaSt = :tConv<T>, <T>EXCEPCIONES DM0116 IMPRESION CO<T>))<BR>                                                                            Entonces<BR>                                                                                ReportePantalla(<T>FacturaMAVIMayoreo<T>,Venta:Venta.ID,1)<BR>                                                                            sino<BR>                                                                                Si (<CONTINUA>
Expresion012=<CONTINUA>SQL(<T>exec SP_MaviDM0116BuscarCombinacion :nFas, :nId, :nSuc, :tMov, :tMovId, :tCond, :tCat<T>, 2, Venta:Venta.ID, Venta:Venta.SucursalDestino, Venta:Venta.Mov,  Venta:Venta.MovID, Venta:Venta.Condicion, Venta:CteEnviarA.Categoria)=0)<BR>                                                                                    Entonces<BR>                                                                                        ReportePantalla(<T>FacturaMAVIMayoreo<T>,Venta:Venta.ID,1)<BR>                                                                                    Sino<BR>                                                                                        Si (SQL(<T>exec SP_MaviDM0116BuscarCombinacion :nFas, :nId, :nSuc, :tMov, :tMovId, :tCond, :tCat<T>, 2, Venta:Venta.ID, Venta:Venta.Suc<CONTINUA>
Expresion013=<CONTINUA>ursalDestino, Venta:Venta.Mov,  Venta:Venta.MovID, Venta:Venta.Condicion, Venta:CteEnviarA.Categoria)>=<BR>                                                                                            (SQL(<T>Select Sum(A.Saldo) As Saldo From CxcPendiente A Where A.PadreMavi = :tMov and A.PadreIdMavi = :tMovId Group By A.PadreMavi, A.PadreIDMavi<T>, Venta:Venta.Mov,  Venta:Venta.MovID)))<BR>                                                                                            Entonces<BR>                                                                                                ReportePantalla(<T>FacturaMAVIMayoreo<T>,Venta:Venta.ID,1)<BR>                                                                                        Fin<BR>                                                   <CONTINUA>
Expresion014=<CONTINUA>                             Fin<BR>                                                                        Fin<BR>                                                                    Sino<BR>                                                                        Si (SQL(<T>exec SP_MaviDM0116BuscarCombinacion :nFas, :nId, :nSuc, :tMov, :tMovId, :tCond, :tCat<T>, 3, Venta:Venta.ID, Venta:Venta.SucursalDestino, Venta:Venta.Mov,  Venta:Venta.MovID, Venta:Venta.Condicion, Venta:CteEnviarA.Categoria)=<T>100<T>)<BR>                                                                            Entonces<BR>                                                                                Si VentaD:Art.Linea en (SQL(<T>SELECT Nombre FROM TablaSTD WHERE TablaSt = :tConv<T>, <T>EXCEPCIONES DM0116 IMPRESION <CONTINUA>
Expresion015=<CONTINUA>CO<T>))<BR>                                                                                    Entonces<BR>                                                                                        ReportePantalla(<T>FacturaMAVIMayoreo<T>,Venta:Venta.ID,1)<BR>                                                                                    sino<BR>                                                                                        Si (SQL(<T>exec SP_MaviDM0116BuscarCombinacion :nFas, :nId, :nSuc, :tMov, :tMovId, :tCond, :tCat<T>, 2, Venta:Venta.ID, Venta:Venta.SucursalDestino, Venta:Venta.Mov,  Venta:Venta.MovID, Venta:Venta.Condicion, Venta:CteEnviarA.Categoria)=0)<BR>                                                                                            Entonces<BR>                <CONTINUA>
Expresion016=<CONTINUA>                                                                                ReportePantalla(<T>FacturaMAVIMayoreo<T>,Venta:Venta.ID,1)<BR>                                                                                            Sino<BR>                                                                                                Si (SQL(<T>exec SP_MaviDM0116BuscarCombinacion :nFas, :nId, :nSuc, :tMov, :tMovId, :tCond, :tCat<T>, 2, Venta:Venta.ID, Venta:Venta.SucursalDestino, Venta:Venta.Mov,  Venta:Venta.MovID, Venta:Venta.Condicion, Venta:CteEnviarA.Categoria)>=<BR>                                                                                                    (SQL(<T>Select Sum(A.Saldo) As Saldo From CxcPendiente A Where A.PadreMavi = :tMov and A.PadreIdMavi = :tMovId Group By <CONTINUA>
Expresion017=<CONTINUA>A.PadreMavi, A.PadreIDMavi<T>, Venta:Venta.Mov,  Venta:Venta.MovID)))<BR>                                                                                                    Entonces<BR>                                                                                                        ReportePantalla(<T>FacturaMAVIMayoreo<T>,Venta:Venta.ID,1)<BR>                                                                                                Fin<BR>                                                                                        Fin<BR>                                                                                Fin<BR>                                                                            Sino<BR>                                                                                <CONTINUA>
Expresion018=<CONTINUA>Si (SQL(<T>exec SP_MaviDM0116BuscarCombinacion :nFas, :nId, :nSuc, :tMov, :tMovId, :tCond, :tCat<T>, 3, Venta:Venta.ID, Venta:Venta.SucursalDestino, Venta:Venta.Mov,  Venta:Venta.MovID, Venta:Venta.Condicion, Venta:CteEnviarA.Categoria)=<T>011<T>)<BR>                                                                                    Entonces<BR>                                                                                        ReportePantalla(<T>FacturaMAVIMayoreo<T>,Venta:Venta.ID,2)<BR>                                                                                        ReportePantalla(<T>FacturaMAVIMayoreo<T>,Venta:Venta.ID,3)<BR>                                                                                    Sino<BR>                                                             <CONTINUA>
Expresion019=<CONTINUA>                           Si (SQL(<T>exec SP_MaviDM0116BuscarCombinacion :nFas, :nId, :nSuc, :tMov, :tMovId, :tCond, :tCat<T>, 3, Venta:Venta.ID, Venta:Venta.SucursalDestino, Venta:Venta.Mov,  Venta:Venta.MovID, Venta:Venta.Condicion, Venta:CteEnviarA.Categoria)=<T>010<T>)<BR>                                                                                            Entonces<BR>                                                                                                ReportePantalla(<T>FacturaMAVIMayoreo<T>,Venta:Venta.ID,2)<BR>                                                                                            Sino<BR>                                                                                                Si (SQL(<T>exec SP_MaviDM0116BuscarCombinacion :nFas, :nId, :nSu<CONTINUA>
Expresion020=<CONTINUA>c, :tMov, :tMovId, :tCond, :tCat<T>, 3, Venta:Venta.ID, Venta:Venta.SucursalDestino, Venta:Venta.Mov,  Venta:Venta.MovID, Venta:Venta.Condicion, Venta:CteEnviarA.Categoria)=<T>001<T>)<BR>                                                                                                    Entonces<BR>                                                                                                        ReportePantalla(<T>FacturaMAVIMayoreo<T>,Venta:Venta.ID,3)<BR>                                                                                                Fin<BR>                                                                                        Fin<BR>                                                                                Fin<BR>                                                  <CONTINUA>
Expresion021=<CONTINUA>                      Fin<BR>                                                                Fin<BR>                                                        Fin<BR>                                                Fin<BR>                                            sino<BR>                                                Si (SQL(<T>exec SP_MaviDM0116BuscarCombinacion :nFas, :nId, :nSuc, :tMov, :tMovId, :tCond, :tCat<T>, 3, Venta:Venta.ID, Venta:Venta.SucursalDestino, Venta:Venta.Mov,  Venta:Venta.MovID, Venta:Venta.Condicion, Venta:CteEnviarA.Categoria)=<T>111<T>)<BR>                                                    Entonces<BR>                                                        si (sql(<T>select isnull(ContImpSimp,0) from venta where id=:nId<T>,Venta:Venta.ID)=0)<BR>                     <CONTINUA>
Expresion022=<CONTINUA>                                       entonces<BR>                                                                ReportePantalla(<T>FacturaMAVIMayoreo<T>,Venta:Venta.ID,2)<BR>                                                            sino<BR>                                                                Informacion(<T>Este reporte <T>+ COMILLAS(<T>Copia<T>)+<T> ya fue impreso. Su perfil de usuario no cuenta con privilegios para poder visualizarlo nuevamente.<T>)<BR>                                                        Fin<BR>                                                        si (sql(<T>select isnull(ContImpCiego,0) from venta where id=:nId<T>,Venta:Venta.ID)=0)<BR>                                                            entonces<BR>                                            <CONTINUA>
Expresion023=<CONTINUA>                    ReportePantalla(<T>FacturaMAVIMayoreo<T>,Venta:Venta.ID,3)<BR>                                                            sino<BR>                                                                Informacion(<T>Este reporte <T>+ COMILLAS(<T>Copia Embarque<T>)+<T> ya fue impreso. Su perfil de usuario no cuenta con privilegios para poder visualizarlo nuevamente.<T>)<BR>                                                        Fin<BR>                                                        si (sql(<T>select isnull(ContImpCFD,0) from venta where id=:nId<T>,Venta:Venta.ID)=0)<BR>                                                            entonces<BR>                                                                Si VentaD:Art.Linea en (SQL(<T>SELECT Nombre FROM TablaSTD WHERE Tab<CONTINUA>
Expresion024=<CONTINUA>laSt = :tConv<T>, <T>EXCEPCIONES DM0116 IMPRESION CO<T>))<BR>                                                                    Entonces<BR>                                                                        ReportePantalla(<T>FacturaMAVIMayoreo<T>,Venta:Venta.ID,1)<BR>                                                                    sino<BR>                                                                        Si (SQL(<T>exec SP_MaviDM0116BuscarCombinacion :nFas, :nId, :nSuc, :tMov, :tMovId, :tCond, :tCat<T>, 2, Venta:Venta.ID, Venta:Venta.SucursalDestino, Venta:Venta.Mov,  Venta:Venta.MovID, Venta:Venta.Condicion, Venta:CteEnviarA.Categoria)=0)<BR>                                                                            Entonces<BR>                                              <CONTINUA>
Expresion025=<CONTINUA>                                  ReportePantalla(<T>FacturaMAVIMayoreo<T>,Venta:Venta.ID,1)<BR>                                                                            Sino<BR>                                                                                Si (SQL(<T>exec SP_MaviDM0116BuscarCombinacion :nFas, :nId, :nSuc, :tMov, :tMovId, :tCond, :tCat<T>, 2, Venta:Venta.ID, Venta:Venta.SucursalDestino, Venta:Venta.Mov,  Venta:Venta.MovID, Venta:Venta.Condicion, Venta:CteEnviarA.Categoria)>=<BR>                                                                                    (SQL(<T>Select Sum(A.Saldo) As Saldo From CxcPendiente A Where A.PadreMavi = :tMov and A.PadreIdMavi = :tMovId Group By A.PadreMavi, A.PadreIDMavi<T>, Venta:Venta.Mov,  Venta:Venta.MovID)))<BR>                     <CONTINUA>
Expresion026=<CONTINUA>                                                               Entonces<BR>                                                                                        ReportePantalla(<T>FacturaMAVIMayoreo<T>,Venta:Venta.ID,1)<BR>                                                                                Fin<BR>                                                                        Fin<BR>                                                                Fin<BR>                                                            sino<BR>                                                                Informacion(<T>Este reporte <T>+ COMILLAS(<T>CFD<T>)+<T> ya fue impreso. Su perfil de usuario no cuenta con privilegios para poder visualizarlo nuevamente.<T>)<BR>                                           <CONTINUA>
Expresion027=<CONTINUA>             Fin<BR>                                                    Sino<BR>                                                        Si (SQL(<T>exec SP_MaviDM0116BuscarCombinacion :nFas, :nId, :nSuc, :tMov, :tMovId, :tCond, :tCat<T>, 3, Venta:Venta.ID, Venta:Venta.SucursalDestino, Venta:Venta.Mov,  Venta:Venta.MovID, Venta:Venta.Condicion, Venta:CteEnviarA.Categoria)=<T>110<T>)<BR>                                                            Entonces<BR>                                                                si (sql(<T>select isnull(ContImpSimp,0) from venta where id=:nId<T>,Venta:Venta.ID)=0)<BR>                                                                    entonces<BR>                                                                        ReportePantalla(<T>FacturaMAVIMayor<CONTINUA>
Expresion028=<CONTINUA>eo<T>,Venta:Venta.ID,2)<BR>                                                                    sino<BR>                                                                        Informacion(<T>Este reporte <T>+ COMILLAS(<T>Copia<T>)+<T> ya fue impreso. Su perfil de usuario no cuenta con privilegios para poder visualizarlo nuevamente.<T>)<BR>                                                                Fin<BR>                                                                si (sql(<T>select isnull(ContImpCFD,0) from venta where id=:nId<T>,Venta:Venta.ID)=0)<BR>                                                                    entonces<BR>                                                                        Si VentaD:Art.Linea en (SQL(<T>SELECT Nombre FROM TablaSTD WHERE TablaSt = :tConv<T><CONTINUA>
Expresion029=<CONTINUA>, <T>EXCEPCIONES DM0116 IMPRESION CO<T>))<BR>                                                                            Entonces<BR>                                                                                ReportePantalla(<T>FacturaMAVIMayoreo<T>,Venta:Venta.ID,1)<BR>                                                                            sino<BR>                                                                                Si (SQL(<T>exec SP_MaviDM0116BuscarCombinacion :nFas, :nId, :nSuc, :tMov, :tMovId, :tCond, :tCat<T>, 2, Venta:Venta.ID, Venta:Venta.SucursalDestino, Venta:Venta.Mov,  Venta:Venta.MovID, Venta:Venta.Condicion, Venta:CteEnviarA.Categoria)=0)<BR>                                                                                    Entonces<BR>                      <CONTINUA>
Expresion030=<CONTINUA>                                                                  ReportePantalla(<T>FacturaMAVIMayoreo<T>,Venta:Venta.ID,1)<BR>                                                                                    Sino<BR>                                                                                        Si (SQL(<T>exec SP_MaviDM0116BuscarCombinacion :nFas, :nId, :nSuc, :tMov, :tMovId, :tCond, :tCat<T>, 2, Venta:Venta.ID, Venta:Venta.SucursalDestino, Venta:Venta.Mov,  Venta:Venta.MovID, Venta:Venta.Condicion, Venta:CteEnviarA.Categoria)>=<BR>                                                                                            (SQL(<T>Select Sum(A.Saldo) As Saldo From CxcPendiente A Where A.PadreMavi = :tMov and A.PadreIdMavi = :tMovId Group By A.PadreMavi, A.PadreIDMavi<T>, Venta:V<CONTINUA>
Expresion031=<CONTINUA>enta.Mov,  Venta:Venta.MovID)))<BR>                                                                                            Entonces<BR>                                                                                                ReportePantalla(<T>FacturaMAVIMayoreo<T>,Venta:Venta.ID,1)<BR>                                                                                        Fin<BR>                                                                                Fin<BR>                                                                        Fin<BR>                                                                    sino<BR>                                                                        Informacion(<T>Este reporte <T>+ COMILLAS(<T>CFD<T>)+<T> ya fue impreso. Su perfil de usuario <CONTINUA>
Expresion032=<CONTINUA>no cuenta con privilegios para poder visualizarlo nuevamente.<T>)<BR>                                                                Fin    <BR>                                                            Sino<BR>                                                                Si (SQL(<T>exec SP_MaviDM0116BuscarCombinacion :nFas, :nId, :nSuc, :tMov, :tMovId, :tCond, :tCat<T>, 3, Venta:Venta.ID, Venta:Venta.SucursalDestino, Venta:Venta.Mov,  Venta:Venta.MovID, Venta:Venta.Condicion, Venta:CteEnviarA.Categoria)=<T>101<T>)<BR>                                                                    Entonces<BR>                                                                        si (sql(<T>select isnull(ContImpCiego,0) from venta where id=:nId<T>,Venta:Venta.ID)=0)<BR>                              <CONTINUA>
Expresion033=<CONTINUA>                                              entonces<BR>                                                                                ReportePantalla(<T>FacturaMAVIMayoreo<T>,Venta:Venta.ID,3)<BR>                                                                            sino<BR>                                                                                Informacion(<T>Este reporte <T>+ COMILLAS(<T>Copia Embarque<T>)+<T> ya fue impreso. Su perfil de usuario no cuenta con privilegios para poder visualizarlo nuevamente.<T>)<BR>                                                                        Fin <BR>                                                                        si (sql(<T>select isnull(ContImpCFD,0) from venta where id=:nId<T>,Venta:Venta.ID)=0)<BR>                     <CONTINUA>
Expresion034=<CONTINUA>                                                       entonces<BR>                                                                                Si VentaD:Art.Linea en (SQL(<T>SELECT Nombre FROM TablaSTD WHERE TablaSt = :tConv<T>, <T>EXCEPCIONES DM0116 IMPRESION CO<T>))<BR>                                                                                    Entonces<BR>                                                                                        ReportePantalla(<T>FacturaMAVIMayoreo<T>,Venta:Venta.ID,1)<BR>                                                                                    sino<BR>                                                                                        Si (SQL(<T>exec SP_MaviDM0116BuscarCombinacion :nFas, :nId, :nSuc, :tMov, :tMovId, :tCond, :tCat<T<CONTINUA>
Expresion035=<CONTINUA>>, 2, Venta:Venta.ID, Venta:Venta.SucursalDestino, Venta:Venta.Mov,  Venta:Venta.MovID, Venta:Venta.Condicion, Venta:CteEnviarA.Categoria)=0)<BR>                                                                                            Entonces<BR>                                                                                                ReportePantalla(<T>FacturaMAVIMayoreo<T>,Venta:Venta.ID,1)<BR>                                                                                            Sino<BR>                                                                                                Si (SQL(<T>exec SP_MaviDM0116BuscarCombinacion :nFas, :nId, :nSuc, :tMov, :tMovId, :tCond, :tCat<T>, 2, Venta:Venta.ID, Venta:Venta.SucursalDestino, Venta:Venta.Mov,  Venta:Venta.MovID, Venta:Venta<CONTINUA>
Expresion036=<CONTINUA>.Condicion, Venta:CteEnviarA.Categoria)>=<BR>                                                                                                    (SQL(<T>Select Sum(A.Saldo) As Saldo From CxcPendiente A Where A.PadreMavi = :tMov and A.PadreIdMavi = :tMovId Group By A.PadreMavi, A.PadreIDMavi<T>, Venta:Venta.Mov,  Venta:Venta.MovID)))<BR>                                                                                                    Entonces<BR>                                                                                                        ReportePantalla(<T>FacturaMAVIMayoreo<T>,Venta:Venta.ID,1)<BR>                                                                                                Fin<BR>                                                                                 <CONTINUA>
Expresion037=<CONTINUA>       Fin<BR>                                                                                Fin<BR>                                                                            sino<BR>                                                                                Informacion(<T>Este reporte <T>+ COMILLAS(<T>CFD<T>)+<T> ya fue impreso. Su perfil de usuario no cuenta con privilegios para poder visualizarlo nuevamente.<T>)<BR>                                                                        Fin   <BR>                                                                    Sino<BR>                                                                        Si (SQL(<T>exec SP_MaviDM0116BuscarCombinacion :nFas, :nId, :nSuc, :tMov, :tMovId, :tCond, :tCat<T>, 3, Venta:Venta.ID, Venta:Venta.SucursalDe<CONTINUA>
Expresion038=<CONTINUA>stino, Venta:Venta.Mov,  Venta:Venta.MovID, Venta:Venta.Condicion, Venta:CteEnviarA.Categoria)=<T>100<T>)<BR>                                                                            Entonces<BR>                                                                                si (sql(<T>select isnull(ContImpCFD,0) from venta where id=:nId<T>,Venta:Venta.ID)=0)<BR>                                                                                    entonces<BR>                                                                                        Si VentaD:Art.Linea en (SQL(<T>SELECT Nombre FROM TablaSTD WHERE TablaSt = :tConv<T>, <T>EXCEPCIONES DM0116 IMPRESION CO<T>))<BR>                                                                                            Entonces<BR>                 <CONTINUA>
Expresion039=<CONTINUA>                                                                               ReportePantalla(<T>FacturaMAVIMayoreo<T>,Venta:Venta.ID,1)<BR>                                                                                            sino<BR>                                                                                                Si (SQL(<T>exec SP_MaviDM0116BuscarCombinacion :nFas, :nId, :nSuc, :tMov, :tMovId, :tCond, :tCat<T>, 2, Venta:Venta.ID, Venta:Venta.SucursalDestino, Venta:Venta.Mov,  Venta:Venta.MovID, Venta:Venta.Condicion, Venta:CteEnviarA.Categoria)=0)<BR>                                                                                                    Entonces<BR>                                                                                                        Repo<CONTINUA>
Expresion040=<CONTINUA>rtePantalla(<T>FacturaMAVIMayoreo<T>,Venta:Venta.ID,1)<BR>                                                                                                    Sino<BR>                                                                                                        Si (SQL(<T>exec SP_MaviDM0116BuscarCombinacion :nFas, :nId, :nSuc, :tMov, :tMovId, :tCond, :tCat<T>, 2, Venta:Venta.ID, Venta:Venta.SucursalDestino, Venta:Venta.Mov,  Venta:Venta.MovID, Venta:Venta.Condicion, Venta:CteEnviarA.Categoria)>=<BR>                                                                                                            (SQL(<T>Select Sum(A.Saldo) As Saldo From CxcPendiente A Where A.PadreMavi = :tMov and A.PadreIdMavi = :tMovId Group By A.PadreMavi, A.PadreIDMavi<T>, Venta:Venta.Mov,  Venta:Venta<CONTINUA>
Expresion041=<CONTINUA>.MovID)))<BR>                                                                                                            Entonces<BR>                                                                                                                ReportePantalla(<T>FacturaMAVIMayoreo<T>,Venta:Venta.ID,1)<BR>                                                                                                        Fin<BR>                                                                                                Fin<BR>                                                                                        Fin<BR>                                                                                    sino<BR>                                                                                        Info<CONTINUA>
Expresion042=<CONTINUA>rmacion(<T>Este reporte <T>+ COMILLAS(<T>CFD<T>)+<T> ya fue impreso. Su perfil de usuario no cuenta con privilegios para poder visualizarlo nuevamente.<T>)<BR>                                                                                Fin<BR>                                                                            Sino<BR>                                                                                Si (SQL(<T>exec SP_MaviDM0116BuscarCombinacion :nFas, :nId, :nSuc, :tMov, :tMovId, :tCond, :tCat<T>, 3, Venta:Venta.ID, Venta:Venta.SucursalDestino, Venta:Venta.Mov,  Venta:Venta.MovID, Venta:Venta.Condicion, Venta:CteEnviarA.Categoria)=<T>011<T>)<BR>                                                                                    Entonces<BR>                                           <CONTINUA>
Expresion043=<CONTINUA>                                             si (sql(<T>select isnull(ContImpSimp,0) from venta where id=:nId<T>,Venta:Venta.ID)=0)<BR>                                                                                            entonces<BR>                                                                                                ReportePantalla(<T>FacturaMAVIMayoreo<T>,Venta:Venta.ID,2)<BR>                                                                                            sino<BR>                                                                                                Informacion(<T>Este reporte <T>+ COMILLAS(<T>Copia<T>)+<T> ya fue impreso. Su perfil de usuario no cuenta con privilegios para poder visualizarlo nuevamente.<T>)<BR>                                          <CONTINUA>
Expresion044=<CONTINUA>                                              Fin<BR>                                                                                        si (sql(<T>select isnull(ContImpCiego,0) from venta where id=:nId<T>,Venta:Venta.ID)=0)<BR>                                                                                            entonces<BR>                                                                                                ReportePantalla(<T>FacturaMAVIMayoreo<T>,Venta:Venta.ID,3)<BR>                                                                                            sino<BR>                                                                                                Informacion(<T>Este reporte <T>+ COMILLAS(<T>Copia Embarque<T>)+<T> ya fue impreso. Su perfil de usuario no cu<CONTINUA>
Expresion045=<CONTINUA>enta con privilegios para poder visualizarlo nuevamente.<T>)<BR>                                                                                        Fin<BR>                                                                                    Sino<BR>                                                                                        Si (SQL(<T>exec SP_MaviDM0116BuscarCombinacion :nFas, :nId, :nSuc, :tMov, :tMovId, :tCond, :tCat<T>, 3, Venta:Venta.ID, Venta:Venta.SucursalDestino, Venta:Venta.Mov,  Venta:Venta.MovID, Venta:Venta.Condicion, Venta:CteEnviarA.Categoria)=<T>010<T>)<BR>                                                                                            Entonces<BR>                                                                                                si (sql(<T<CONTINUA>
Expresion046=<CONTINUA>>select isnull(ContImpSimp,0) from venta where id=:nId<T>,Venta:Venta.ID)=0)<BR>                                                                                                    entonces<BR>                                                                                                        ReportePantalla(<T>FacturaMAVIMayoreo<T>,Venta:Venta.ID,2)<BR>                                                                                                    sino<BR>                                                                                                        Informacion(<T>Este reporte <T>+ COMILLAS(<T>Copia<T>)+<T> ya fue impreso. Su perfil de usuario no cuenta con privilegios para poder visualizarlo nuevamente.<T>)<BR>                                                                 <CONTINUA>
Expresion047=<CONTINUA>                               Fin<BR>                                                                                            Sino<BR>                                                                                                Si (SQL(<T>exec SP_MaviDM0116BuscarCombinacion :nFas, :nId, :nSuc, :tMov, :tMovId, :tCond, :tCat<T>, 3, Venta:Venta.ID, Venta:Venta.SucursalDestino, Venta:Venta.Mov,  Venta:Venta.MovID, Venta:Venta.Condicion, Venta:CteEnviarA.Categoria)=<T>001<T>)<BR>                                                                                                    Entonces<BR>                                                                                                        si (sql(<T>select isnull(ContImpCiego,0) from venta where id=:nId<T>,Venta:Venta.ID)=0)<BR>        <CONTINUA>
Expresion048=<CONTINUA>                                                                                                    entonces<BR>                                                                                                                ReportePantalla(<T>FacturaMAVIMayoreo<T>,Venta:Venta.ID,3)<BR>                                                                                                            sino<BR>                                                                                                                Informacion(<T>Este reporte <T>+ COMILLAS(<T>Copia Embarque<T>)+<T> ya fue impreso. Su perfil de usuario no cuenta con privilegios para poder visualizarlo nuevamente.<T>)<BR>                                                                                                        Fin<BR> <CONTINUA>
Expresion049=<CONTINUA>                                                                                               Fin<BR>                                                                                        Fin<BR>                                                                                Fin<BR>                                                                        Fin<BR>                                                                Fin<BR>                                                        Fin<BR>                                                Fin<BR>                                        Fin<BR>                                    sino<BR>                                        Si (SQL(<T>Select right(Valor,1) From TablaStd where TablaSt=:tda and Nombre in (SELECT ACCESO FROM USUARIO WHERE Usu<CONTINUA>
Expresion050=<CONTINUA>ario =:tUsu)<T>,<T>CFD PERFILES P/IMPRESION<T>,Usuario)=1)<BR>                                            entonces<BR>                                                Si (SQL(<T>exec SP_MaviDM0116BuscarCombinacion :nFas, :nId, :nSuc, :tMov, :tMovId, :tCond, :tCat<T>, 3, Venta:Venta.ID, Venta:Venta.SucursalDestino, Venta:Venta.Mov,  Venta:Venta.MovID, Venta:Venta.Condicion, Venta:CteEnviarA.Categoria)=<T>111<T>)<BR>                                                    Entonces<BR>                                                        ReportePantalla(<T>FacturaMAVIMayoreo<T>,Venta:Venta.ID,1)<BR>                                                        ReportePantalla(<T>FacturaMAVIMayoreo<T>,Venta:Venta.ID,2)<BR>                                                        ReportePantalla(<T>FacturaM<CONTINUA>
Expresion051=<CONTINUA>AVIMayoreo<T>,Venta:Venta.ID,3)<BR>                                                    Sino<BR>                                                        Si (SQL(<T>exec SP_MaviDM0116BuscarCombinacion :nFas, :nId, :nSuc, :tMov, :tMovId, :tCond, :tCat<T>, 3, Venta:Venta.ID, Venta:Venta.SucursalDestino, Venta:Venta.Mov,  Venta:Venta.MovID, Venta:Venta.Condicion, Venta:CteEnviarA.Categoria)=<T>110<T>)<BR>                                                            Entonces<BR>                                                                ReportePantalla(<T>FacturaMAVIMayoreo<T>,Venta:Venta.ID,1)<BR>                                                                ReportePantalla(<T>FacturaMAVIMayoreo<T>,Venta:Venta.ID,2)<BR>                                                            Sino<BR>      <CONTINUA>
Expresion052=<CONTINUA>                                                          Si (SQL(<T>exec SP_MaviDM0116BuscarCombinacion :nFas, :nId, :nSuc, :tMov, :tMovId, :tCond, :tCat<T>, 3, Venta:Venta.ID, Venta:Venta.SucursalDestino, Venta:Venta.Mov,  Venta:Venta.MovID, Venta:Venta.Condicion, Venta:CteEnviarA.Categoria)=<T>101<T>)<BR>                                                                    Entonces<BR>                                                                        ReportePantalla(<T>FacturaMAVIMayoreo<T>,Venta:Venta.ID,1)<BR>                                                                        ReportePantalla(<T>FacturaMAVIMayoreo<T>,Venta:Venta.ID,3)<BR>                                                                    Sino<BR>                                                                   <CONTINUA>
Expresion053=<CONTINUA>     Si (SQL(<T>exec SP_MaviDM0116BuscarCombinacion :nFas, :nId, :nSuc, :tMov, :tMovId, :tCond, :tCat<T>, 3, Venta:Venta.ID, Venta:Venta.SucursalDestino, Venta:Venta.Mov,  Venta:Venta.MovID, Venta:Venta.Condicion, Venta:CteEnviarA.Categoria)=<T>100<T>)<BR>                                                                            Entonces<BR>                                                                                ReportePantalla(<T>FacturaMAVIMayoreo<T>,Venta:Venta.ID,1)<BR>                                                                            Sino<BR>                                                                                Si (SQL(<T>exec SP_MaviDM0116BuscarCombinacion :nFas, :nId, :nSuc, :tMov, :tMovId, :tCond, :tCat<T>, 3, Venta:Venta.ID, Venta:Venta.SucursalDestino, V<CONTINUA>
Expresion054=<CONTINUA>enta:Venta.Mov,  Venta:Venta.MovID, Venta:Venta.Condicion, Venta:CteEnviarA.Categoria)=<T>011<T>)<BR>                                                                                    Entonces<BR>                                                                                        ReportePantalla(<T>FacturaMAVIMayoreo<T>,Venta:Venta.ID,2)<BR>                                                                                        ReportePantalla(<T>FacturaMAVIMayoreo<T>,Venta:Venta.ID,3)<BR>                                                                                    Sino<BR>                                                                                        Si (SQL(<T>exec SP_MaviDM0116BuscarCombinacion :nFas, :nId, :nSuc, :tMov, :tMovId, :tCond, :tCat<T>, 3, Venta:Venta.ID, Ven<CONTINUA>
Expresion055=<CONTINUA>ta:Venta.SucursalDestino, Venta:Venta.Mov,  Venta:Venta.MovID, Venta:Venta.Condicion, Venta:CteEnviarA.Categoria)=<T>010<T>)<BR>                                                                                            Entonces<BR>                                                                                                ReportePantalla(<T>FacturaMAVIMayoreo<T>,Venta:Venta.ID,2)<BR>                                                                                            Sino<BR>                                                                                                Si (SQL(<T>exec SP_MaviDM0116BuscarCombinacion :nFas, :nId, :nSuc, :tMov, :tMovId, :tCond, :tCat<T>, 3, Venta:Venta.ID, Venta:Venta.SucursalDestino, Venta:Venta.Mov,  Venta:Venta.MovID, Venta:Venta.Condicion, Venta<CONTINUA>
Expresion056=<CONTINUA>:CteEnviarA.Categoria)=<T>001<T>)<BR>                                                                                                    Entonces<BR>                                                                                                        ReportePantalla(<T>FacturaMAVIMayoreo<T>,Venta:Venta.ID,3)<BR>                                                                                                Fin<BR>                                                                                        Fin<BR>                                                                                Fin<BR>                                                                        Fin<BR>                                                                Fin<BR>                                                  <CONTINUA>
Expresion057=<CONTINUA>      Fin<BR>                                                Fin<BR>                                            sino<BR>                                                Si (SQL(<T>exec SP_MaviDM0116BuscarCombinacion :nFas, :nId, :nSuc, :tMov, :tMovId, :tCond, :tCat<T>, 3, Venta:Venta.ID, Venta:Venta.SucursalDestino, Venta:Venta.Mov,  Venta:Venta.MovID, Venta:Venta.Condicion, Venta:CteEnviarA.Categoria)=<T>111<T>)<BR>                                                    Entonces<BR>                                                        si (sql(<T>select isnull(ContImpSimp,0) from venta where id=:nId<T>,Venta:Venta.ID)=0)<BR>                                                            entonces<BR>                                                                ReportePantalla(<T>FacturaMAVIMayor<CONTINUA>
Expresion058=<CONTINUA>eo<T>,Venta:Venta.ID,2)<BR>                                                            sino<BR>                                                                Informacion(<T>Este reporte <T>+ COMILLAS(<T>Copia<T>)+<T> ya fue impreso. Su perfil de usuario no cuenta con privilegios para poder visualizarlo nuevamente.<T>)<BR>                                                        Fin<BR>                                                        si (sql(<T>select isnull(ContImpCiego,0) from venta where id=:nId<T>,Venta:Venta.ID)=0)<BR>                                                            entonces<BR>                                                                ReportePantalla(<T>FacturaMAVIMayoreo<T>,Venta:Venta.ID,3)<BR>                                                            sino<BR><CONTINUA>
Expresion059=<CONTINUA>                                                                Informacion(<T>Este reporte <T>+ COMILLAS(<T>Copia Embarque<T>)+<T> ya fue impreso. Su perfil de usuario no cuenta con privilegios para poder visualizarlo nuevamente.<T>)<BR>                                                        Fin<BR>                                                        si (sql(<T>select isnull(ContImpCFD,0) from venta where id=:nId<T>,Venta:Venta.ID)=0)<BR>                                                            entonces<BR>                                                                ReportePantalla(<T>FacturaMAVIMayoreo<T>,Venta:Venta.ID,1)<BR>                                                            sino<BR>                                                                Informacion(<T>Este repo<CONTINUA>
Expresion060=<CONTINUA>rte <T>+ COMILLAS(<T>CFD<T>)+<T> ya fue impreso. Su perfil de usuario no cuenta con privilegios para poder visualizarlo nuevamente.<T>)<BR>                                                        Fin<BR>                                                    Sino<BR>                                                        Si (SQL(<T>exec SP_MaviDM0116BuscarCombinacion :nFas, :nId, :nSuc, :tMov, :tMovId, :tCond, :tCat<T>, 3, Venta:Venta.ID, Venta:Venta.SucursalDestino, Venta:Venta.Mov,  Venta:Venta.MovID, Venta:Venta.Condicion, Venta:CteEnviarA.Categoria)=<T>110<T>)<BR>                                                            Entonces<BR>                                                                si (sql(<T>select isnull(ContImpSimp,0) from venta where id=:nId<T>,Venta:Venta.ID)=0)<BR>     <CONTINUA>
Expresion061=<CONTINUA>                                                               entonces<BR>                                                                        ReportePantalla(<T>FacturaMAVIMayoreo<T>,Venta:Venta.ID,2)<BR>                                                                    sino<BR>                                                                        Informacion(<T>Este reporte <T>+ COMILLAS(<T>Copia<T>)+<T> ya fue impreso. Su perfil de usuario no cuenta con privilegios para poder visualizarlo nuevamente.<T>)<BR>                                                                Fin<BR>                                                                si (sql(<T>select isnull(ContImpCFD,0) from venta where id=:nId<T>,Venta:Venta.ID)=0)<BR>                                                      <CONTINUA>
Expresion062=<CONTINUA>              entonces<BR>                                                                        ReportePantalla(<T>FacturaMAVIMayoreo<T>,Venta:Venta.ID,1)<BR>                                                                    sino<BR>                                                                        Informacion(<T>Este reporte <T>+ COMILLAS(<T>CFD<T>)+<T> ya fue impreso. Su perfil de usuario no cuenta con privilegios para poder visualizarlo nuevamente.<T>)<BR>                                                                Fin    <BR>                                                            Sino<BR>                                                                Si (SQL(<T>exec SP_MaviDM0116BuscarCombinacion :nFas, :nId, :nSuc, :tMov, :tMovId, :tCond, :tCat<T>, 3, Venta:Venta.ID, Ve<CONTINUA>
Expresion063=<CONTINUA>nta:Venta.SucursalDestino, Venta:Venta.Mov,  Venta:Venta.MovID, Venta:Venta.Condicion, Venta:CteEnviarA.Categoria)=<T>101<T>)<BR>                                                                    Entonces<BR>                                                                        si (sql(<T>select isnull(ContImpCiego,0) from venta where id=:nId<T>,Venta:Venta.ID)=0)<BR>                                                                            entonces<BR>                                                                                ReportePantalla(<T>FacturaMAVIMayoreo<T>,Venta:Venta.ID,3)<BR>                                                                            sino<BR>                                                                                Informacion(<T>Este reporte <T>+ C<CONTINUA>
Expresion064=<CONTINUA>OMILLAS(<T>Copia Embarque<T>)+<T> ya fue impreso. Su perfil de usuario no cuenta con privilegios para poder visualizarlo nuevamente.<T>)<BR>                                                                        Fin <BR>                                                                        si (sql(<T>select isnull(ContImpCFD,0) from venta where id=:nId<T>,Venta:Venta.ID)=0)<BR>                                                                            entonces<BR>                                                                                ReportePantalla(<T>FacturaMAVIMayoreo<T>,Venta:Venta.ID,1)<BR>                                                                            sino<BR>                                                                                Informacion(<T>Este repor<CONTINUA>
Expresion065=<CONTINUA>te <T>+ COMILLAS(<T>CFD<T>)+<T> ya fue impreso. Su perfil de usuario no cuenta con privilegios para poder visualizarlo nuevamente.<T>)<BR>                                                                        Fin   <BR>                                                                    Sino<BR>                                                                        Si (SQL(<T>exec SP_MaviDM0116BuscarCombinacion :nFas, :nId, :nSuc, :tMov, :tMovId, :tCond, :tCat<T>, 3, Venta:Venta.ID, Venta:Venta.SucursalDestino, Venta:Venta.Mov,  Venta:Venta.MovID, Venta:Venta.Condicion, Venta:CteEnviarA.Categoria)=<T>100<T>)<BR>                                                                            Entonces<BR>                                                                                si (sql(<T>se<CONTINUA>
Expresion066=<CONTINUA>lect isnull(ContImpCFD,0) from venta where id=:nId<T>,Venta:Venta.ID)=0)<BR>                                                                                    entonces<BR>                                                                                        ReportePantalla(<T>FacturaMAVIMayoreo<T>,Venta:Venta.ID,1)<BR>                                                                                    sino<BR>                                                                                        Informacion(<T>Este reporte <T>+ COMILLAS(<T>CFD<T>)+<T> ya fue impreso. Su perfil de usuario no cuenta con privilegios para poder visualizarlo nuevamente.<T>)<BR>                                                                                Fin<BR>                                                <CONTINUA>
Expresion067=<CONTINUA>                            Sino<BR>                                                                                Si (SQL(<T>exec SP_MaviDM0116BuscarCombinacion :nFas, :nId, :nSuc, :tMov, :tMovId, :tCond, :tCat<T>, 3, Venta:Venta.ID, Venta:Venta.SucursalDestino, Venta:Venta.Mov,  Venta:Venta.MovID, Venta:Venta.Condicion, Venta:CteEnviarA.Categoria)=<T>011<T>)<BR>                                                                                    Entonces<BR>                                                                                        si (sql(<T>select isnull(ContImpSimp,0) from venta where id=:nId<T>,Venta:Venta.ID)=0)<BR>                                                                                            entonces<BR>                                                       <CONTINUA>
Expresion068=<CONTINUA>                                         ReportePantalla(<T>FacturaMAVIMayoreo<T>,Venta:Venta.ID,2)<BR>                                                                                            sino<BR>                                                                                                Informacion(<T>Este reporte <T>+ COMILLAS(<T>Copia<T>)+<T> ya fue impreso. Su perfil de usuario no cuenta con privilegios para poder visualizarlo nuevamente.<T>)<BR>                                                                                        Fin<BR>                                                                                        si (sql(<T>select isnull(ContImpCiego,0) from venta where id=:nId<T>,Venta:Venta.ID)=0)<BR>                                                              <CONTINUA>
Expresion069=<CONTINUA>                              entonces<BR>                                                                                                ReportePantalla(<T>FacturaMAVIMayoreo<T>,Venta:Venta.ID,3)<BR>                                                                                            sino<BR>                                                                                                Informacion(<T>Este reporte <T>+ COMILLAS(<T>Copia Embarque<T>)+<T> ya fue impreso. Su perfil de usuario no cuenta con privilegios para poder visualizarlo nuevamente.<T>)<BR>                                                                                        Fin<BR>                                                                                    Sino<BR>                                           <CONTINUA>
Expresion070=<CONTINUA>                                             Si (SQL(<T>exec SP_MaviDM0116BuscarCombinacion :nFas, :nId, :nSuc, :tMov, :tMovId, :tCond, :tCat<T>, 3, Venta:Venta.ID, Venta:Venta.SucursalDestino, Venta:Venta.Mov,  Venta:Venta.MovID, Venta:Venta.Condicion, Venta:CteEnviarA.Categoria)=<T>010<T>)<BR>                                                                                            Entonces<BR>                                                                                                si (sql(<T>select isnull(ContImpSimp,0) from venta where id=:nId<T>,Venta:Venta.ID)=0)<BR>                                                                                                    entonces<BR>                                                                                                      <CONTINUA>
Expresion071=<CONTINUA>  ReportePantalla(<T>FacturaMAVIMayoreo<T>,Venta:Venta.ID,2)<BR>                                                                                                    sino<BR>                                                                                                        Informacion(<T>Este reporte <T>+ COMILLAS(<T>Copia<T>)+<T> ya fue impreso. Su perfil de usuario no cuenta con privilegios para poder visualizarlo nuevamente.<T>)<BR>                                                                                                Fin<BR>                                                                                            Sino<BR>                                                                                                Si (SQL(<T>exec SP_MaviDM0116BuscarCombinacion :nFas, :nId, <CONTINUA>
Expresion072=<CONTINUA>:nSuc, :tMov, :tMovId, :tCond, :tCat<T>, 3, Venta:Venta.ID, Venta:Venta.SucursalDestino, Venta:Venta.Mov,  Venta:Venta.MovID, Venta:Venta.Condicion, Venta:CteEnviarA.Categoria)=<T>001<T>)<BR>                                                                                                    Entonces<BR>                                                                                                        si (sql(<T>select isnull(ContImpCiego,0) from venta where id=:nId<T>,Venta:Venta.ID)=0)<BR>                                                                                                            entonces<BR>                                                                                                                ReportePantalla(<T>FacturaMAVIMayoreo<T>,Venta:Venta.ID,3)<BR>        <CONTINUA>
Expresion073=<CONTINUA>                                                                                                    sino<BR>                                                                                                                Informacion(<T>Este reporte <T>+ COMILLAS(<T>Copia Embarque<T>)+<T> ya fue impreso. Su perfil de usuario no cuenta con privilegios para poder visualizarlo nuevamente.<T>)<BR>                                                                                                        Fin<BR>                                                                                                Fin<BR>                                                                                        Fin<BR>                                                                                Fin<BR>          <CONTINUA>
Expresion074=<CONTINUA>                                                              Fin<BR>                                                                Fin<BR>                                                        Fin<BR>                                                Fin<BR>                                        Fin<BR>                                Fin    <BR>                        Fin<BR>                Fin<BR>        Fin<BR>    SINO<BR>       ReportePantalla(ReporteMovImpresora(Info.SubModuloVenta, Venta:Venta.Mov, Venta:Venta.Estatus), Venta:Venta.ID)<BR>Fin<BR>Asigna(Info.SubModuloVenta,<T>VTAS<T>)
;AntesExpresiones=SI Venta:Venta.Mov en ( <T>Solicitud Credito<T>, <T>Analisis Credito<T>, <T>Solicitud Mayoreo<T>, <T>Analisis Mayoreo<T>)<BR>    ENTONCES<BR>        ASIGNA(Info.SubModuloVenta,<T>RM0847MaviCredRelPedXClienteRep<T>)<BR>        ASIGNA(Info.Fecha,Venta:Venta.FechaEmision)<BR>        ASIGNA(Mavi.ListaPedidosNew,Venta:Venta.ID)<BR>FIN<BR><BR>Si Venta:Venta.Mov en(<T>Credilana<T>, <T>Prestamo Personal<T>, <T>Seguro Vida<T>, <T>Seguro Auto<T>)<BR>    Entonces<BR>        SI SQL(<T>SELECT COUNT(Numero) FROM dbo.TablaNumD WHERE TablaNum=:tTab AND CAST(Numero AS INT)=:nSuc<T>, <T>SUCURSALES RDP<T>, Sucursal)=1<BR>            Entonces<BR>                Asigna(Info.SubModuloVenta,<T><T>)<BR>                Ejecutar(<T>PlugIns\RutaTicket.exe <T>+<T>VTAS<T>+<T> <T>+Venta:Venta.ID+<T> <T>+Usuario+<T> <T><CONTINUA>
;AntesExpresiones002=<CONTINUA>+<T>0<T>+<T> <T>+Sucursal+<T> <T>+EstacionTrabajo)<BR>            Sino<BR>                Asigna(Info.SubModuloVenta,<T><T>)<BR>                Ejecutar(<T>C:\AppsMavi\Factura.exe <T>+Venta:Venta.ID+<T> <T>+Usuario+<T> 0 <T>+Sucursal)<BR>        Fin<BR>Fin
;se modifica para clientes instituciones e imprima el formato RM0847B y RM0847c EFMARTINEZ 
;AntesExpresiones=SI Venta:Venta.Mov en ( <T>Solicitud Credito<T>, <T>Analisis Credito<T>, <T>Solicitud Mayoreo<T>, <T>Analisis Mayoreo<T>)<BR>    ENTONCES<BR>         SI SQL(<T>SELECT CATEGORIA FROM VentasCanalMavi WHERE ID=:nId<T>,Venta:Venta.EnviarA)=<T>INSTITUCIONES<T> y  (Venta:Venta.Mov = <T>Solicitud Credito<T>)<BR>        ENTONCES<BR>            ASIGNA(Info.SubModuloVenta,<T>RM0847BSolCreditoInsPisoRep<T>)<BR>            ASIGNA(Info.Fecha,Venta:Venta.FechaEmision)<BR>            ASIGNA(Mavi.ListaPedidosNew,Venta:Venta.ID)<BR>        SINO<BR>            ASIGNA(Info.SubModuloVenta,<T>RM0847MaviCredRelPedXClienteRep<T>)                         <BR>            ASIGNA(Info.Fecha,Venta:Venta.FechaEmision)<BR>            ASIGNA(Mavi.ListaPedidosNew,Venta:Venta.ID)<BR>       FIN<BR>FIN<BR><BR>Si Venta:Venta.Mo<CONTINUA>
;AntesExpresiones002=<CONTINUA>v en(<T>Credilana<T>, <T>Prestamo Personal<T>, <T>Seguro Vida<T>, <T>Seguro Auto<T>)<BR>    Entonces<BR>        SI SQL(<T>SELECT COUNT(Numero) FROM dbo.TablaNumD WHERE TablaNum=:tTab AND CAST(Numero AS INT)=:nSuc<T>, <T>SUCURSALES RDP<T>, Sucursal)=1<BR>            Entonces<BR>                Asigna(Info.SubModuloVenta,<T><T>)<BR>                Ejecutar(<T>PlugIns\RutaTicket.exe <T>+<T>VTAS<T>+<T> <T>+Venta:Venta.ID+<T> <T>+Usuario+<T> <T>+<T>0<T>+<T> <T>+Sucursal+<T> <T>+EstacionTrabajo)<BR>            Sino<BR>                Asigna(Info.SubModuloVenta,<T><T>)<BR>                Ejecutar(<T>C:\AppsMavi\Factura.exe <T>+Venta:Venta.ID+<T> <T>+Usuario+<T> 0 <T>+Sucursal)<BR>        Fin<BR>Fin
AntesExpresiones=SI Venta:Venta.Mov en (<T>Solicitud Credito<T>,<T>Analisis Credito<T>,<T>Solicitud Mayoreo<T>,<T>Analisis Mayoreo<T>) o ((Venta:Venta.Mov en(<T>Pedido<T>,<T>Pedido Mayoreo<T>)) y (Venta:Venta.Estatus <> <T>CANCELADO<T>))<BR>   ENTONCES<BR><BR>       SI  SQL(<T>SELECT CATEGORIA FROM VentasCanalMavi WHERE ID=:nId<T>,Venta:Venta.EnviarA)=<T>INSTITUCIONES<T> y  (Venta:Venta.Mov en(<T>Solicitud Credito<T>,<T>Analisis Credito<T>))<BR>           ENTONCES<BR>               ASIGNA(Info.SubModuloVenta,<T>RM0847BSolCreditoInsPisoRep<T>)<BR>               ASIGNA(Info.Fecha,Venta:Venta.FechaEmision)<BR>               ASIGNA(Mavi.ListaPedidosNew,Venta:Venta.ID)<BR>               SINO<BR>               ASIGNA(Info.SubModuloVenta,<T>RM0847MaviCredRelPedXClienteRep<T>)<BR>               ASIGNA(Info.Fecha,V<CONTINUA>
AntesExpresiones002=<CONTINUA>enta:Venta.FechaEmision)<BR>               ASIGNA(Mavi.ListaPedidosNew,Venta:Venta.ID)<BR>                                                               <BR>      FIN<BR>FIN<BR><BR> Si Venta:Venta.Mov en(<T>Credilana<T>,<T>Prestamo Personal<T>,<T>Seguro Vida<T>,<T>Seguro Auto<T>)<BR>        Entonces<BR>            SI SQL(<T>SELECT COUNT(Numero) FROM dbo.TablaNumD WHERE TablaNum=:tTab AND CAST(Numero AS INT)=:nSuc<T>, <T>SUCURSALES RDP<T>, Sucursal)=1<BR>             Entonces                                                                                  <BR>             Asigna(Info.SubModuloVenta,<T><T>)<BR>             Ejecutar(<T>PlugIns\RutaTicket.exe <T>+<T>VTAS<T>+<T> <T>+Venta:Venta.ID+<T> <T>+Usuario+<T> <T>+<T>0<T>+<T> <T>+Sucursal+<T> <T>+EstacionTrabajo)<BR>             Sino<BR><CONTINUA>
AntesExpresiones003=<CONTINUA>             Asigna(Info.SubModuloVenta,<T><T>)<BR>             Ejecutar(<T>C:\AppsMavi\Factura.exe <T>+Venta:Venta.ID+<T> <T>+Usuario+<T> 0 <T>+Sucursal)<BR>             Fin<BR>    Fin


;**** PENDIENTEINTEGRACIONMOISES Se modifico la impresion y vista preliminar desde ventas. MOISES MAVI 17/JUNIO/2009
;[Venta.frm/Acciones.Imprimir.AsignarValID]
;Nombre=AsignarValID
;Boton=0
;TipoAccion=Expresion
;Expresion=Asigna(Info.ID,Venta:Venta.ID)
;Activo=S
;Visible=S


;;**** PENDIENTEINTEGRACIONMOISES Se modifico la impresion y vista preliminar desde ventas. MOISES MAVI 17/JUNIO/2009
;[Venta.frm/Acciones.Imprimir.LlamaReporte]
;Nombre=LlamaReporte
;Boton=0
;TipoAccion=Reportes Impresora
;ClaveAccion=MaviSolCredDirectoVentasRep
;Activo=S
;ConCondicion=S
;Visible=S
;ListaParametros=S




;**** PENDIENTEINTEGRACIONMOISES Se modifico la impresion y vista preliminar desde ventas. MOISES MAVI 17/JUNIO/2009
;[Venta.frm/Acciones.RepPantalla.AsignaIDRepPantalla]
;Nombre=AsignaIDRepPantalla
;Boton=0
;TipoAccion=Expresion
;Expresion=Asigna(Info.ID,Venta:Venta.ID)
;Activo=S
;Visible=S


;*** Desarrollo de IVAFIscal ***
[Venta.frm/(Carpeta Totalizadores)]
;Totalizadores2=Si Venta:Venta.Mov en (<T>Credilana<T>,<T>Prestamo Personal<T>) Entonces Suma(VentaD:Importe)-(Suma(VentaD:VentaD.Financiamiento)-(Suma(VentaD:VentaD.Financiamiento)/((SQL(<T>SELECT DefImpuesto FROM EmpresaGral WHERE Empresa = :tEmp<T>,{Empresa})/100) + 1))) Sino Suma(VentaD:Importe) Fin<BR>-Suma(VentaD:DescGlobal)<BR>Si Venta:Venta.Mov en (<T>Credilana<T>,<T>Prestamo Personal<T>) Entonces (Suma(VentaD:Importe)-(Suma(VentaD:VentaD.Financiamiento)-(Suma(VentaD:VentaD.Financiamiento)/((SQL(<T>SELECT DefImpuesto FROM EmpresaGral WHERE Empresa = :tEmp<T>,{Empresa})/100) + 1))))-VentaD:DescGlobal Sino Suma(VentaD:Subtotal) Fin<BR>Si Venta:Venta.Mov en (<T>Credilana<T>,<T>Prestamo Personal<T>) Entonces Suma(VentaD:VentaD.Financiamiento)-(Suma(VentaD:VentaD.Financiamiento)/((SQL(<T>SELECT DefImpuesto FROM EmpresaGral WHERE Empresa = :tEmp<T>,{Empresa})/100) + 1)-Suma(VentaD:DescGlobal)) Sino Suma(VentaD:Impuesto) Fin<BR>Redondea(Suma(VentaD:ImporteTotal), Config.VentaCobroRedondeoDecimales)-Venta:Ven;ta.AnticiposFacturados-Venta:Venta.Retencion<BR>Conteo(VentaD:VentaD.Articulo)<BR>Suma(VentaD:ImporteSobrePrecio)
Totalizadores2=Si Venta:Venta.Mov en (<T>Credilana<T>,<T>Prestamo Personal<T>,<T>Cancela Credilana<T>,<T>Cancela Prestamo<T>) Entonces Suma(VentaD:Importe)-(Suma(VentaD:VentaD.Financiamiento)-(Suma(VentaD:VentaD.Financiamiento)/((SQL(<T>SELECT DefImpuesto FROM EmpresaGral WHERE Empresa = :tEmp<T>,{Empresa})/100) + 1))) Sino Suma(VentaD:Importe) Fin<BR>-Suma(VentaD:DescGlobal)<BR>Si Venta:Venta.Mov en (<T>Credilana<T>,<T>Prestamo Personal<T>,<T>Cancela Credilana<T>,<T>Cancela Prestamo<T>) Entonces (Suma(VentaD:Importe)-(Suma(VentaD:VentaD.Financiamiento)-(Suma(VentaD:VentaD.Financiamiento)/((SQL(<T>SELECT DefImpuesto FROM EmpresaGral WHERE Empresa = :tEmp<T>,{Empresa})/100) + 1))))-VentaD:DescGlobal Sino Suma(VentaD:Subtotal) Fin<BR>Si Venta:Venta.Mov en (<T>Credilana<T>,<T>Prestamo Personal<T>,<T>Cancela<CONTINUA>
Totalizadores2002=<CONTINUA> Credilana<T>,<T>Cancela Prestamo<T>) Entonces Suma(VentaD:VentaD.Financiamiento)-(Suma(VentaD:VentaD.Financiamiento)/((SQL(<T>SELECT DefImpuesto FROM EmpresaGral WHERE Empresa = :tEmp<T>,{Empresa})/100) + 1)-Suma(VentaD:DescGlobal)) Sino Suma(VentaD:Impuesto) Fin<BR>Redondea(Suma(VentaD:ImporteTotal), Config.VentaCobroRedondeoDecimales)-Venta:Venta.AnticiposFacturados-Venta:Venta.Retencion<BR>Conteo(VentaD:VentaD.Articulo)<BR>Suma(VentaD:ImporteSobrePrecio)

;*** Desarrollo de Servicasa ***
[Venta.frm/Acciones.GuardadoAutomatico]
Nombre=GuardadoAutomatico
Boton=0
EnBarraHerramientas=S
TipoAccion=Expresion
Activo=S
ConCondicion=S
Visible=S
Antes=S
RefrescarDespues=S
Multiple=S
ListaAccionesMultiples=SalvaC
EjecucionCondicion=(ConDatos(Venta:Venta.Mov) y ConDatos(Venta:Venta.FechaRequerida) y ConDatos(Venta:Venta.Cliente) y ConDatos(Venta:Venta.EnviarA) y ConDatos(Venta:Venta.FormaPagoTipo) y ConDatos(Venta:Venta.Agente) y ConDatos(Venta:Venta.Almacen) y ConDatos(Venta:Venta.Condicion) y (Mavi.ServicasaCapDetallVentas=0) y Vacio(Venta:Venta.ID))
AntesExpresiones=Asigna(Venta:Venta.Importe, Suma(VentaD:Importe))<BR>Asigna(Venta:Venta.Impuestos, Suma(VentaD:Impuesto))
ConAutoEjecutar=S
AutoEjecutarExpresion=1

;***** INTEGRACIONMAVI-15042010-MOISES GARCIA ROSALES-EXPRESIONES AL MOSTRAR-INSERT VENTAS-NUEVA ACCION AGREGADA "GUARDADO AUTOMATICO"
[Venta.frm/Acciones.GuardadoAutomatico.SalvaC]
Nombre=SalvaC
Boton=0
TipoAccion=Expresion
Activo=S
Visible=S
Expresion=GuardarCambios<BR>Asigna(Mavi.ServicasaCapDetallVentas,1)
;SI(Mavi.ServicasaCapDetallVentas=0,GuardarCambios,<T><T>)
;<BR>Asigna(Mavi.ServicasaCapDetallVentas,1)<BR>ActualizarForma
ConCondicion=S
EjecucionCondicion=(ConDatos(Venta:Venta.Mov) y ConDatos(Venta:Venta.FechaRequerida) y ConDatos(Venta:Venta.Cliente) y ConDatos(Venta:Venta.EnviarA) y ConDatos(Venta:Venta.FormaPagoTipo) y ConDatos(Venta:Venta.Agente) y ConDatos(Venta:Venta.Almacen) y ConDatos(Venta:Venta.Condicion))

;Se modifica codigo para tomar tabla historica, odcampos, 13-04-2012, Paquete RM0182_19042012 Intregra BVF
;***** INTEGRACIONMAVI-15042010-MOISES GARCIA ROSALES-EXPRESIONES AL MOSTRAR-INSERT VENTAS-BOTON ALEIMINAR SE HACE A ACCION MULTIPLE: ELIMINA Y REFRESCA
[Venta.frm/Acciones.Eliminar]
RefrescarDespues=S
Multiple=S
ListaAccionesMultiples=Elimina<BR>RefrescaFrm
Antes=S
AntesExpresiones=SI(SQL(<T>Select Count(ID) From VentasCanalMAVI Where Cadena=<T>+Comillas(<T>VENTA VALE<T>)+<T> and ID=:nID<T>,Venta:Venta.EnviarA) > 0,EjecutarSQL(<T>SP_DM0244NipValesVta :tid, :tvale,:testatus<T>, Venta:Venta.ID, Mavi.DM0244Vale, <T>cancelar<T>),Falso)
ActivoCondicion=SI<BR>   SQL(<T>SELECT COUNT(Nombre) FROM VerMovTiempo V<BR>          INNER JOIN TablaStD T ON T.Nombre=V.Situacion<BR>        WHERE TablaSt=<T>+Comillas(<T>ACCESO ELIMINACION PARA ADJ.<T>)+<T><BR>            AND v.Modulo=:tMod<BR>            AND v.ID=:nID<T>,Venta:Venta.SubModulo,Venta:Venta.ID)>0<BR>   y (Venta:Venta.Mov = <T>Sol Dev Unicaja<T>)<BR>ENTONCES<BR>      SQL(<T>SELECT Acceso FROM Usuario WHERE Usuario =:tUsu<T>,Usuario)=<T>ADMIN_MAVI<T>)<BR>SINO<BR>    1=1<BR>FIN

;***** INTEGRACIONMAVI-15042010-MOISES GARCIA ROSALES-EXPRESIONES AL MOSTRAR-INSERT VENTAS-ACCION DE ELIMINAR
[Venta.frm/Acciones.Eliminar.Elimina]
Nombre=Elimina
Boton=0
TipoAccion=Controles Captura
ClaveAccion=Documento Eliminar
Activo=S
Visible=S

;***** INTEGRACIONMAVI-15042010-MOISES GARCIA ROSALES-EXPRESIONES AL MOSTRAR-INSERT VENTAS-ACCION DE REFRESCAR DESPUES DE ELIMINAR
[Venta.frm/Acciones.Eliminar.RefrescaFrm]
Nombre=RefrescaFrm
Boton=0
TipoAccion=Expresion
Expresion=Asigna(Mavi.ServicasaCapDetallVentas,0)
Activo=S
Visible=S

;Se actualizo para qeu solo aparezca en las solicitudes de credito mayoreo/menudeo y pedido BVF10032011
[Venta.frm/Acciones.UsuarioIncremento]
Nombre=UsuarioIncremento
Boton=0
NombreDesplegar=Usuario Incremento
EnMenu=S
Visible=S
GuardarAntes=S
TipoAccion=Expresion
Antes=S
DespuesGuardar=S
;Expresion=Forma(<T>UsuarioIncremento<T>)<BR>Forma.ActualizarVista(<T>Detalle<T>)
;Expresion=Asigna(Mavi.DM0313Canal, Venta:Venta.EnviarA)<BR>Asigna(Mavi.DM0313Art, VentaD:VentaD.Articulo)<BR>Asigna(Mavi.DM0313Mov, Venta:Venta.mov)<BR>Forma(<T>UsuarioIncremento<T>)<BR>Asigna(Mavi.DM0313ID, Venta:Venta.ID)<BR>Forma.ActualizarVista(<T>Detalle<T>)
Expresion=Asigna(Mavi.DM0313Canal, Venta:Venta.EnviarA)<BR>Asigna(Mavi.DM0313Art, VentaD:VentaD.Articulo)<BR>Asigna(Mavi.DM0313Mov, Venta:Venta.mov)<BR>Asigna(Mavi.DM0313ID, Venta:Venta.ID)<BR>Forma(<T>UsuarioIncremento<T>)<BR>Forma.ActualizarVista(<T>Detalle<T>)
AntesExpresiones=Asigna(Info.ID,Venta:Venta.ID)<BR>Asigna(Info.Modulo,<T>VTAS<T>)<BR>Asigna(Info.Renglon,VentaD:VentaD.Renglon)<BR>Asigna(Info.Articulo,VentaD:VentaD.Articulo)<BR>Asigna(Info.Precio,VentaD:VentaD.Precio)
;ActivoCondicion=(Venta:Venta.Estatus = <T>SINAFECTAR<T>) y (vacio(Venta:Venta.Origen)) y (vacio(Venta:Venta.OrigenID)) y (Venta:Venta.Mov en(<T>Solicitud Credito<T>,<T>Solicitud Mayoreo<T>)) o ((Venta:Venta.Mov en(<T>Pedido<T>)) y (Venta:Venta.FormaPagoTipo en(<T>CONTADO<T>,<T>Contado<T>)) y (Venta:Venta.Estatus = <T>SINAFECTAR<T>))
;Se agrega condicion por grupo de trabajo
ActivoCondicion=(Venta:Venta.Estatus = <T>SINAFECTAR<T>) y (vacio(Venta:Venta.Origen)) y (vacio(Venta:Venta.OrigenID)) y (Venta:Venta.Mov en(<T>Solicitud Credito<T>,<T>Solicitud Mayoreo<T>,<T>Pedido Mayoreo<T>)) o ((Venta:Venta.Mov en(<T>Pedido<T>)) y (Venta:Venta.FormaPagoTipo en(<T>CONTADO<T>,<T>Contado<T>)) y (Venta:Venta.Estatus = <T>SINAFECTAR<T>)) y (SQL(<T>SELECT COUNT(1)N FROM TablaStD WITH(NOLOCK) WHERE TablaST=:tA AND Valor=:tB and Nombre=:tAcc<T>,<T>GRUPO TRABAJO USR INCREMENTO<T>,Mayusculas(Usuario.GrupoTrabajo),Usuario.Acceso)=0)


;***** Integracion de accion Actualizar Precio mod por Jesus Del Toro Andrade 04-Oct-2011 para desarrollo DM0148 Actualizar Precios para Ventas Instituciones dentro del paquete DM0148_04102011. JR 04-Oct-2011 *****

[Venta.frm/Acciones.Actualizar Precio]
Nombre=Actualizar Precio
Boton=0
NombreDesplegar=Actualizar Precio a Instituciones
EnMenu=S
EspacioPrevio=S
TipoAccion=Controles Captura
ClaveAccion=Actualizar Vista
Visible=S
Multiple=S
ListaAccionesMultiples=Expresion<BR>Actualizar Vista
RefrescarDespues=S
GuardarAntes=S
Activo=S

[Venta.frm/Acciones.Actualizar Precio.Expresion]
Nombre=Expresion
Boton=0
TipoAccion=Expresion
Activo=S
Visible=S
ConCondicion=S
Expresion=EjecutarSQL(<T>exec SP_MAVIDM0148ActualizarPreciosVtasInstituciones :nCanal, :tCondicion, :tArt, :nSuc<T>,<BR>Venta:Venta.EnviarA, Venta:Venta.Condicion, VentaD:VentaD.Articulo, Venta:Venta.Sucursal)
EjecucionCondicion=SI<BR>     (Venta:Venta.Mov=<T>Solicitud Credito<T>) Y (Venta:Venta.Estatus=<T>SINAFECTAR<T>)<BR>ENTONCES<BR>    1=1<BR>SINO<BR>    1=0<BR>    ERROR(<T>No se puede realizar la actualización<T>)<BR>FIN

[Venta.frm/Acciones.Actualizar Precio.Actualizar Vista]
Nombre=Actualizar Vista
Boton=0
TipoAccion=Expresion
Activo=S
Visible=S
ConCondicion=S
Expresion=ProcesarSQL(<T>spPropreActualizarPrecios :nid,:tEstatus<T>,Venta:Venta.ID,Venta:Venta.Estatus)<BR>ActualizarVista
EjecucionCondicion=SI<BR>    SQL(<T>Select count(p1.Precio) from proprelistadfinal p1<BR>    join Condicion c on c.PropreGrupo=p1.Condicion<BR>    join Sucursal s on S.Sucursal = p1.Sucursal <BR>    where p1.Canal=:nCanal and p1.Articulo=:tArt and c.Condicion=:tCondicion and p1.Sucursal=:nSuc<T>,<BR>Venta:Venta.EnviarA, VentaD:VentaD.Articulo,Venta:Venta.Condicion,Venta:Venta.Sucursal)=1<BR>ENTONCES<BR>     1=1<BR>SINO<BR>    SI<BR>        SQL(<T>Select count(p1.Precio) from proprelistadfinal p1<BR>        join Condicion c on c.PropreGrupo=p1.Condicion<BR>        join Sucursal s on S.Sucursal = p1.Sucursal AND Tipo=:tTipo<BR>        where  p1.Canal=:nCanal and p1.Articulo=:tArt and c.Condicion=:tCondicion<BR>        and p1.Sucursal in (Select MIN(Sucursal) From Sucursal where Tipo=:tTipoDos)<T>,<BR>        <T>INSTITUCIONES<T>,Venta<CONTINUA>
EjecucionCondicion002=<CONTINUA>:Venta.EnviarA, VentaD:VentaD.Articulo,Venta:Venta.Condicion,<T>INSTITUCIONES<T>)=1<BR>    ENTONCES<BR>        1=1<BR>    SINO<BR>        1=0<BR>        Error(<T>No existe Precio definido<T>)<BR>    FIN<BR>FIN


[Venta.frm/Acciones.escaneo]
Nombre=escaneo
Boton=0
NombreDesplegar=Escaneo Zapatos
Multiple=S
EnMenu=S
EspacioPrevio=S
ListaAccionesMultiples=asign<BR>guarda<BR>cerr<BR>forma
Activo=S
Visible=S

[Venta.frm/Acciones.escaneo.asign]
Nombre=asign
Boton=0
TipoAccion=Expresion
Activo=S
Visible=S
Expresion=Asigna(Info.ID, Venta:Venta.ID)<BR>Asigna(Info.Renglon,VentaD:VentaD.Renglon)<BR>Asigna(Info.RenglonID,VentaD:VentaD.RenglonID)<BR>Asigna(Info.RenglonSub,VentaD:VentaD.RenglonSub )<BR>Asigna(Info.Almacen,Venta:Venta.Almacen)
[Venta.frm/Acciones.escaneo.cerr]
Nombre=cerr
Boton=0
TipoAccion=Ventana
ClaveAccion=Cerrar
Activo=S
Visible=S
[Venta.frm/Acciones.escaneo.forma]
Nombre=forma
Boton=0
TipoAccion=Formas
ClaveAccion=DM0169Escaneo1Frm
Activo=S
Visible=S
[Venta.frm/Acciones.escaneo.guarda]
Nombre=guarda
Boton=0
TipoAccion=Controles Captura
ClaveAccion=Guardar Cambios
Activo=S
Visible=S




; **** Integracion de modificacion de accion Situacion para Pedido Mayoreo TEG 24 Oct 2011. Para desarrollo DM0158 Costeo de Fletes dentro del paquete DM0158_24112011. JR 25-Nov-2011. **** 
[Venta.frm/Acciones.Situacion]
ConCondicion=S
EjecucionCondicion=si Venta:Venta.Mov=<T>Pedido Mayoreo<T><BR>entonces<BR>   sql(<T> exec SP_MAVIDM0158ValidaSituacion :NId<T>,Venta:Venta.ID)>0<BR>Fin
EjecucionMensaje=<T>Para Pasar esta Situación, Es necesario la Herramienta Costeo Fletes (Usuarios: REPAR_GERA,GEROP_GERA)<T>
EjecucionConError=S
;ActivoCondicion=(ConfigModulo(<T>VTAS<T>,<T>Situaciones<T>)=<T>Si<T>) y Usuario.ModificarSituacion y<BR>PuedeAvanzarSituacion(<T>VTAS<T>, Venta:Venta.Mov, Venta:Venta.Estatus, FormaSituacion)<BR>y (no((Venta:Venta.Mov = <T>Analisis Credito<T>) y (SQL(<T>SELECT COUNT(ID) FROM CteEnviarA WHERE Categoria =:tCat AND Cliente =:tId<T>, <T>INSTITUCIONES<T>, Venta:Venta.Cliente) > 0) y (Mavi.DM0138ValidaCond = <T>Falso<T>)) o (Venta:Venta.Situacion = <T>Aceptado<T>))
ActivoCondicion=(ConfigModulo(<T>VTAS<T>,<T>Situaciones<T>)=<T>Si<T>) y Usuario.ModificarSituacion y<BR>PuedeAvanzarSituacion(<T>VTAS<T>, Venta:Venta.Mov, Venta:Venta.Estatus, FormaSituacion)<BR>y (no((Venta:Venta.Mov = <T>Analisis Credito<T>) y (SQL(<T>SELECT COUNT(ID) FROM CteEnviarA WHERE Categoria =:tCat AND ID =:tId AND Cliente =:tCt and ID <> 34<T>, <T>INSTITUCIONES<T>, Venta:Venta.EnviarA, Venta:Venta.Cliente) > 0) y (Mavi.DM0138ValidaCond = <T>Falso<T>)) o (Venta:Venta.Situacion = <T>Aceptado<T>))

AntesExpresiones=Si(Vacio(Venta:Venta.ID),GuardarCambios)
Multiple=S
ListaAccionesMultiples=Expresion2<BR>Cambiar Situacion<BR>ExpresionValidacion<BR>Expresion

[Venta.frm/Acciones.Situacion.Expresion2]
Nombre=Expresion2
Boton=0
TipoAccion=Expresion
Activo=S
Visible=S
Expresion=ASIGNA(Mavi.DM0192situacion,Venta:Venta.Situacion)

[Venta.frm/Acciones.Situacion.Cambiar Situacion]
Nombre=l
Boton=0
TipoAccion=Controles Captura
ClaveAccion=Cambiar Situacion
Activo=S
Visible=S

[Venta.frm/Acciones.Situacion.ExpresionValidacion]
Nombre=ExpresionValidacion
Boton=0
TipoAccion=Expresion
Activo=S
Visible=S
Expresion=Asigna(Info.Dialogo,<T><T>)<BR>Asigna(Info.Dialogo,SQL(<T>SPIDM0318_ReanalisisCanal76 :nID, :tOpc<T>,Venta:Venta.ID,<T>BUS<T>))<BR>Si<BR>  Info.Dialogo = <T>SIVALIDAR<T><BR>Entonces<BR>    Si<BR>       SQL(<T>Select dbo.fn_MaviDM0244ValidaSituacion (:nID, :nEnviar, :tSit)<T>,Venta:Venta.ID,Venta:Venta.EnviarA,Venta:Venta.Situacion) <> <T>S<T><BR>    Entonces<BR>       Error(<T>ASIGNAR CUENTA AL BENEFICIARIO FINAL<T>)<BR>       EjecutarSQL(<T>SPIDM0318_ReanalisisCanal76 :nID, :tOpc<T>,Venta:Venta.ID,<T>CMB<T>)<BR>       AbortarOperacion<BR>    Sino<BR>       Verdadero<BR>    Fin<BR>Sino<BR> Verdadero<BR>Fin

[Venta.frm/Acciones.Situacion.Expresion]
Nombre=Expresion
Boton=0
TipoAccion=Expresion
Activo=S
Visible=S
Expresion=actualizarvista<BR>SI (Mavi.DM0192situacion<>Venta:Venta.Situacion)ENTONCES<BR>asigna(Mavi.DM0192CERRAR2,verdadero)<BR>si ((((Venta:Venta.Situacion en (<T>Aceptado<T>,<T>Aceptado Condicionado<T>,<T>Rechazado<T>,<T>Condicionado<T>))y(Venta:Venta.MaviTipoVenta en (<T>Casa<T>)))o<BR>((Venta:Venta.Situacion en (<T>Aceptado<T>,<T>Aceptado Condicionado<T>))y(Venta:Venta.MaviTipoVenta en (<T>Nuevo<T>))y (medio(Venta:Cte.Cliente,1,1)<><T>P<T>)))<BR>y (vacio(sql(<T>select CRMImporte from Cte where cliente =:t<T>,Venta:Cte.Cliente))) y (Venta:Venta.EnviarA en (3,7)))<BR>entonces<BR>asigna(Mavi.DM0192ProspACliente,Venta:Cte.Cliente)<BR>forma(<T>DM0192CapturaLinCreditoFrm<T>)<BR>fin<BR>FIn

;*** Integracion paquete DM0165_15122011 BVF 16122011
;Victor Enrique Murillo Torres  15/Diciembre/2011 DM0165
;Se bloqueo la opcion de localizar ya que funciona en la sucursal que sea y puede ver de otras sucursales.
; **** Modificacion de ActivoCondicion por modificacion de la tablaSTD, Victor Enrique Murillo Torres 21-Dic-2011 DM0165, para desarrollo DM0165 Bloquear Localizar dentro del paquete DM0165_22122011. JR 23-Dic-2011. ****
; **** Modificacion de ActivoCondicion para desarrollo DM0165 Bloquear Localizar dentro del paquete DM0165_26122011. JR 26-Dic-2011. ****
[Venta.frm/Acciones.Localizar]
Activo=
ActivoCondicion=SQL(<T>select count(*) from usuario where Acceso in (select Nombre from TablastD where tablast=:tespecial and substring(valor,1,1)=1) and Usuario=:tusado<T>,<T>CFG ACCESOS ESPECIALES<T>,usuario)
Antes=S
AntesExpresiones=SI(((Venta:Venta.Estatus <> <T>CONCLUIDO<T>)y (Venta:Venta.Mov en (<T>Factura<T>,<T>Credilana<T>,<T>Factura VIU<T>)) y (Vacio(Venta:Venta.MovID,Nulo) <> Nulo)), (EjecutarSQL('SPCancelaFolioVTASMAVI :n',Venta:Venta.ID )))

;****** Integracion paquete DM0165_27122011A BVF 27122011
; **** Integracion de Activo y ActivoCondicion por modificacion de la tablaSTD, Victor Enrique Murillo Torres 21-Dic-2011 DM0165, para desarrollo DM0165 Bloquear Localizar dentro del paquete DM0165_22122011. JR 23-Dic-2011. ****
;[Venta.frm/Acciones.DatosEntrega]
;Activo=
;ActivoCondicion=SQL(<T>select count(*) from usuario where Acceso in (select Nombre from TablastD where tablast=:tespecial and substring(valor,3,1)=1) and Usuario=:tusado<T>,<T>CFG ACCESOS ESPECIALES<T>,usuario)
AntesExpresiones=Asigna(Info.ID, Venta:Venta.ID)<BR>Asigna(Info.Mov, Venta:Venta.Mov)<BR>Asigna(Info.MovID, Venta:Venta.MovID)<BR>Asigna(Info.Cliente, Venta:Venta.Cliente)<BR>Asigna(Mavi.RM1131ClienteSeleccionado, Venta:Venta.Cliente )


; Integracion de accion modificada Consecutivo para evitar su uso, Jesus Del Toro Andrade 27-12-2011, para desarrollo DM0165 Bloquear Localizar dentro del paquete DM0165_27122011. JR 27-Dic-2011. ****
[Venta.Frm/Acciones.Consecutivo]
ActivoCondicion=//Vacio(Venta:Venta.MovID)<BR>1=0
VisibleCondicion=//Venta:Venta.Estatus en (EstatusSinAfectar, EstatusPorConfirmar, EstatusBorrador)<BR>1=1


;***** 08/05/2012 Carmen Quintana Se agregó la ejecución de un SP antes de cerrar la forma por medio de las Teclas Alt+F4, integra BVF 10052012 paq DM0112_10052012

[Venta.frm/Acciones.Cerrar]
Antes=S
AntesExpresiones=sql(<T>Exec sp_MaviDM0112BUSC :tUsuario <T>,Usuario)


; **** Integracion de cambio para no considerar el cfd por hacer corto con el dfdflex
[Venta.frm/Acciones.Cancelar]
;Expresion=Asigna(Afectar.Modulo, <T>VTAS<T>)<BR>Asigna(Afectar.ID, Venta:Venta.ID)<BR>Asigna(Afectar.Mov, Venta:Venta.Mov) <BR>Asigna(Afectar.MovID, Venta:Venta.MovID)<BR>Asigna(Afectar.FormaCaptura, <T>Venta<T>)<BR>Asigna(Info.MovTipo, MovTipo(<T>VTAS<T>, Venta:Venta.Mov))<BR>Asigna(Info.Estatus, Venta:Venta.Estatus)<BR>Si <BR>  (Info.MovTipo en (VTAS.N,VTAS.FM)) y (Info.Estatus noen (EstatusSinAfectar, EstatusBorrador, EstatusPorConfirmar))<BR>Entonces<BR>  Asigna(Info.TituloDialogo, <T>Cancelar: <T>+Afectar.Mov+<T> <T>+Afectar.MovID)<BR>  Dialogo(<T>CancelarNota<T>)<BR>Sino<BR>  Si <BR>    (Info.Estatus=EstatusPendiente) y (Info.MovTipo en (VTAS.P,VTAS.S))<BR>  Entonces<BR>    Asigna(Info.TituloDialogo, <T>Cancelar: <T>+Afectar.Mov+<T> <T>+Afectar.MovID)<BR>    Dialogo(<T>CancelarVentaPendiente<T<CONTINUA>
;Expresion002=<CONTINUA>>)<BR>  Sino<BR>    Si<BR>      Asigna(Temp.Texto, <T><T>)<BR>      Si <BR>        (Config.CancelarFactura<><T>No<T>) y Vacio(Venta:Venta.AnticiposFacturados) y (Info.Estatus noen (EstatusSinAfectar, EstatusBorrador, EstatusPorConfirmar))<BR>      Entonces<BR>        Asigna(Temp.Fecha, SQL(<T>SELECT GETDATE()<T>))<BR>        Si<BR>          Info.MovTipo en (VTAS.F, VTAS.FAR)<BR>        Entonces<BR>          Si             <BR>            (Mes(Temp.Fecha) > Mes(Venta:Venta.FechaEmision)) o (Año(Temp.Fecha) > Año(Venta:Venta.FechaEmision)) o ((Config.CancelarFactura=<T>Cambio Dia<T>) y (Dia(Temp.Fecha) > Dia(Venta:Venta.FechaEmision)))<BR>          Entonces<BR>            Asigna(Temp.Texto, <T>Nota: Esta Cancelación va a Generar un Movimiento Contrario.<T>+NuevaLinea+NuevaLinea+NuevaLinea+Nu<CONTINUA>
;Expresion003=<CONTINUA>evaLinea+NuevaLinea+NuevaLinea)<BR>          Fin<BR>        Fin<BR>      Fin<BR>      Precaucion(Temp.Texto+<T>¿ Esta seguro que desea cancelar el movimiento ?<T>+NuevaLinea+NuevaLinea+Afectar.Mov+<T> <T>+Afectar.MovID, BotonSi, BotonNo ) = BotonSi<BR>   Entonces<BR>      Cancelar(<T>VTAS<T>, Venta:Venta.ID, Afectar.Mov, Afectar.MovID, <T>Todo<T>, <T><T>, Afectar.FormaCaptura)<BR><BR>      /*Si<BR>        Empresa.CFD y SQL(<T>spVerMovTipoCFD :tEmpresa, :tModulo, :tMov<T>, Empresa, Afectar.Modulo, Afectar.Mov)<BR>      Entonces<BR>        Si(no CFD.Generar(Afectar.Modulo, Afectar.ID), AbortarOperacion)<BR>        Si(SQL(<T>SELECT EnviarAlAfectar FROM EmpresaCFD WHERE Empresa=:tEmpresa<T>, Empresa), CFD.Enviar(Afectar.Modulo, Afectar.ID))<BR>      Fin*/<BR><BR>    Fin<BR>  Fin<BR>Fin<BR><BR><CONTINUA>
;Expresion004=<CONTINUA>Asigna(Mavi.MonederoRedimeMensaje,SQL(<T>EXEC dbo.SP_MensajeDevMonedero :tFac,:tFacId,:nOp<T>,Venta:Venta.Mov,Venta:Venta.MovID,2))<BR>Si ConDatos(Mavi.MonederoRedimeMensaje)<BR>Entonces<BR>    Precaucion(Mavi.MonederoRedimeMensaje)<BR>Sino<BR>    1=1<BR>Fin<BR>si(SQL(<T>Select Count(*) From VentasCanalMAVI Where ID=:nID and cadena=:tCad<T>,Venta:Venta.EnviarA,<T>VENTA VALE<T>)> 0, EjecutarSQL(<T>SP_DM0244NipValesVta :tid, :tvale, :testatus<T>, Venta:Venta.ID, Mavi.DM0244Vale, <T>cancelar<T>),Falso)<BR>  SI((Venta:Venta.Mov=<T>Pedido<T>)  y (Venta:Venta.SucursalVenta en (41,90)),Ejecutar(<T>PlugIns\ActualizaEcommers.exe<T>+<T> <T>+<T>VTASPEDIDO<T>+<T> <T>+Venta:Venta.IDEcommerce+<T> <T>+<T>CANCELADO<T>))


Expresion=Asigna(Afectar.Modulo, <T>VTAS<T>)<BR>Asigna(Afectar.ID, Venta:Venta.ID)<BR>Asigna(Afectar.Mov, Venta:Venta.Mov) <BR>Asigna(Afectar.MovID, Venta:Venta.MovID)<BR>Asigna(Afectar.FormaCaptura, <T>Venta<T>)<BR>Asigna(Info.MovTipo, MovTipo(<T>VTAS<T>, Venta:Venta.Mov))<BR>Asigna(Info.Estatus, Venta:Venta.Estatus)<BR>Si <BR>  (Info.MovTipo en (VTAS.N,VTAS.FM)) y (Info.Estatus noen (EstatusSinAfectar, EstatusBorrador, EstatusPorConfirmar))<BR>Entonces<BR>  Asigna(Info.TituloDialogo, <T>Cancelar: <T>+Afectar.Mov+<T> <T>+Afectar.MovID)<BR>  Dialogo(<T>CancelarNota<T>)<BR>Sino<BR>  Si<BR>    (Info.Estatus=EstatusPendiente) y (Info.MovTipo en (VTAS.P,VTAS.S))<BR>  Entonces<BR>    Asigna(Info.TituloDialogo, <T>Cancelar: <T>+Afectar.Mov+<T> <T>+Afectar.MovID)<BR>    Dialogo(<T>CancelarVentaPendiente<T>)<BR>  Sino<BR>    Si<BR>      Asigna(Temp.Texto, <T><T>)<BR>      Si <BR>        (Config.CancelarFactura<><T>No<T>) y Vacio(Venta:Venta.AnticiposFacturados) y (Info.Estatus noen (EstatusSinAfectar, EstatusBorrador, EstatusPorConfirmar))<BR>      Entonces<BR>        Asigna(Temp.Fecha, SQL(<T>SELECT GETDATE()<T>))<BR>        Si<BR>          Info.MovTipo en (VTAS.F, VTAS.FAR)<BR>        Entonces<BR>          Si             <BR>            (Mes(Temp.Fecha) > Mes(Venta:Venta.FechaEmision)) o (Año(Temp.Fecha) > Año(Venta:Venta.FechaEmision)) o ((Config.CancelarFactura=<T>Cambio Dia<T>) y (Dia(Temp.Fecha) > Dia(Venta:Venta.FechaEmision)))<BR>          Entonces<BR>            Asigna(Temp.Texto, <T>Nota: Esta Cancelación va a Generar un Movimiento Contrario.<T>+NuevaLinea+NuevaLinea+NuevaLinea+NuevaLinea+NuevaLinea+NuevaLinea)<BR>          Fin<BR>        Fin<BR>      Fin<BR>      Precaucion(Temp.Texto+<T>¿ Esta seguro que desea cancelar el movimiento ?<T>+NuevaLinea+NuevaLinea+Afectar.Mov+<T> <T>+Afectar.MovID, BotonSi, BotonNo ) = BotonSi<BR>   Entonces<BR>      Cancelar(<T>VTAS<T>, Venta:Venta.ID, Afectar.Mov, Afectar.MovID, <T>Todo<T>, <T><T>, Afectar.FormaCaptura)<BR><BR>      /*Si<BR>        Empresa.CFD y SQL(<T>spVerMovTipoCFD :tEmpresa, :tModulo, :tMov<T>, Empresa, Afectar.Modulo, Afectar.Mov)<BR>      Entonces<BR>        Si(no CFD.Generar(Afectar.Modulo, Afectar.ID), AbortarOperacion)<BR>        Si(SQL(<T>SELECT EnviarAlAfectar FROM EmpresaCFD WHERE Empresa=:tEmpresa<T>, Empresa), CFD.Enviar(Afectar.Modulo, Afectar.ID))<BR>      Fin*/<BR><BR>    Fin<BR>  Fin<BR>Fin<BR><BR>Asigna(Mavi.MonederoRedimeMensaje,SQL(<T>EXEC dbo.SP_MensajeDevMonedero :tFac,:tFacId,:nOp<T>,Venta:Venta.Mov,Venta:Venta.MovID,2))<BR>Si ConDatos(Mavi.MonederoRedimeMensaje)<BR>Entonces<BR>    Precaucion(Mavi.MonederoRedimeMensaje)<BR>Sino<BR>    1=1<BR>Fin<BR>si(SQL(<T>Select Count(*) From VentasCanalMAVI Where ID=:nID and cadena=:tCad<T>,Venta:Venta.EnviarA,<T>VENTA VALE<T>)> 0, EjecutarSQL(<T>SP_DM0244NipValesVta :tid, :tvale, :testatus<T>, Venta:Venta.ID, Mavi.DM0244Vale, <T>cancelar<T>),Falso)<BR>  SI((Venta:Venta.Mov=<T>Pedido<T>)  y (Venta:Venta.SucursalVenta en (41,90)),Ejecutar(<T>PlugIns\ActualizaEcommers.exe<T>+<T> <T>+<T>VTASPEDIDO<T>+<T> <T>+Venta:Venta.IDEcommerce+<T> <T>+<T>CANCELADO<T>))<BR>Si (Venta:Venta.Mov=<T>Factura<T>) o (Venta:Venta.Mov = <T>Factura VIU<T>)<BR>Entonces<BR>   EjecutarSQL(<T>EXEC dbo.SP_RM1161AfectacionRepServicio :tId,:tIdSop,:nOp<T>,Venta:Venta.Id,Venta:Venta.Sucursal,3)<BR>Fin<BR>Si (Venta:Venta.Mov en (<T>Factura<T>, <T>Credilana<T>)) Y (Venta:Venta.EnviarA = 76)<BR>Entonces<BR>    EjecutarSQL(<T>EXEC SpIDM0264_DevMonederoDima :nID<T>,Venta:Venta.ID)<BR>Fin

;Expresion=Asigna(Afectar.Modulo, <T>VTAS<T>)<BR>Asigna(Afectar.ID, Venta:Venta.ID)<BR>Asigna(Afectar.Mov, Venta:Venta.Mov) <BR>Asigna(Afectar.MovID, Venta:Venta.MovID)<BR>Asigna(Afectar.FormaCaptura, <T>Venta<T>)<BR>Asigna(Info.MovTipo, MovTipo(<T>VTAS<T>, Venta:Venta.Mov))<BR>Asigna(Info.Estatus, Venta:Venta.Estatus)<BR>Si <BR>  (Info.MovTipo en (VTAS.N,VTAS.FM)) y (Info.Estatus noen (EstatusSinAfectar, EstatusBorrador, EstatusPorConfirmar))<BR>Entonces<BR>  Asigna(Info.TituloDialogo, <T>Cancelar: <T>+Afectar.Mov+<T> <T>+Afectar.MovID)<BR>  Dialogo(<T>CancelarNota<T>)<BR>Sino<BR>  Si <BR>    (Info.Estatus=EstatusPendiente) y (Info.MovTipo en (VTAS.P,VTAS.S))<BR>  Entonces<BR>    Asigna(Info.TituloDialogo, <T>Cancelar: <T>+Afectar.Mov+<T> <T>+Afectar.MovID)<BR>    Dialogo(<T>CancelarVentaPendiente<T<CONTINUA>
;Expresion002=<CONTINUA>>)<BR>  Sino<BR>    Si<BR>      Asigna(Temp.Texto, <T><T>)<BR>      Si <BR>        (Config.CancelarFactura<><T>No<T>) y Vacio(Venta:Venta.AnticiposFacturados) y (Info.Estatus noen (EstatusSinAfectar, EstatusBorrador, EstatusPorConfirmar))<BR>      Entonces<BR>        Asigna(Temp.Fecha, SQL(<T>SELECT GETDATE()<T>))<BR>        Si<BR>          Info.MovTipo en (VTAS.F, VTAS.FAR)<BR>        Entonces<BR>          Si             <BR>            (Mes(Temp.Fecha) > Mes(Venta:Venta.FechaEmision)) o (Año(Temp.Fecha) > Año(Venta:Venta.FechaEmision)) o ((Config.CancelarFactura=<T>Cambio Dia<T>) y (Dia(Temp.Fecha) > Dia(Venta:Venta.FechaEmision)))<BR>          Entonces<BR>            Asigna(Temp.Texto, <T>Nota: Esta Cancelación va a Generar un Movimiento Contrario.<T>+NuevaLinea+NuevaLinea+NuevaLinea+Nu<CONTINUA>
;Expresion003=<CONTINUA>evaLinea+NuevaLinea+NuevaLinea)<BR>          Fin<BR>        Fin<BR>      Fin<BR>      Precaucion(Temp.Texto+<T>¿ Esta seguro que desea cancelar el movimiento ?<T>+NuevaLinea+NuevaLinea+Afectar.Mov+<T> <T>+Afectar.MovID, BotonSi, BotonNo ) = BotonSi<BR>   Entonces<BR>      Cancelar(<T>VTAS<T>, Venta:Venta.ID, Afectar.Mov, Afectar.MovID, <T>Todo<T>, <T><T>, Afectar.FormaCaptura)<BR><BR>      /*Si<BR>        Empresa.CFD y SQL(<T>spVerMovTipoCFD :tEmpresa, :tModulo, :tMov<T>, Empresa, Afectar.Modulo, Afectar.Mov)<BR>      Entonces<BR>        Si(no CFD.Generar(Afectar.Modulo, Afectar.ID), AbortarOperacion)<BR>        Si(SQL(<T>SELECT EnviarAlAfectar FROM EmpresaCFD WHERE Empresa=:tEmpresa<T>, Empresa), CFD.Enviar(Afectar.Modulo, Afectar.ID))<BR>      Fin*/<BR><BR>    Fin<BR>  Fin<BR>Fin
ConCondicion=S
EjecucionCondicion=SI Venta:Venta.Mov en(<T>Factura<T>,<T>Factura VIU<T>) y (USUARIO.SUCURSAL <> Venta:Venta.Sucursal)<BR>ENTONCES<BR>    ERROR(<T>No se puede cancelar Movimientos generados en otra sucursal <T>+NuevaLinea+Venta:Venta.Sucursal)<BR> FALSO <BR>SINO<BR>    VERDADERO<BR>FIN

[Venta.frm/Acciones.CopiarMeses]
Antes=S
AntesExpresiones=Asigna(Info.Modulo, <T>VTAS<T>)<BR>Asigna(Info.ID, Venta:Venta.ID)<BR>Asigna(Info.Mov, Venta:Venta.Mov)<BR>Asigna(Info.MovID, Venta:Venta.MovID)<BR>Si(no Forma(<T>MovCopiarMeses<T>),  AbortarOperacion)<BR>SI(((Venta:Venta.Estatus <> <T>CONCLUIDO<T>)y (Venta:Venta.Mov en (<T>Factura<T>,<T>Credilana<T>,<T>Factura VIU<T>)) y (Vacio(Venta:Venta.MovID,Nulo) <> Nulo)), (EjecutarSQL('SPCancelaFolioVTASMAVI :n',Venta:Venta.ID )))<BR>


;**** Nueva accion para Monedero Electronico. JR 11-Oct-2012.****
[Venta.frm/Acciones.LiberarMonedero]
Nombre=LiberarMonedero
Boton=0
Menu=&Edición
NombreDesplegar=Eliminar Monedero Electrónico
GuardarAntes=S
EnMenu=S
ConfirmarAntes=S
DialogoMensaje=EstaSeguro
TipoAccion=Expresion
Activo=s
Expresion=SQL(<T>EXEC spBorrarMonederoMovMavi :nid<T>,Venta:Venta.ID)
VisibleCondicion=(MovTipo(<T>VTAS<T>, Venta:Venta.Mov) en (VTAS.F) y (Venta:Venta.Estatus=EstatusSinAfectar))

;Nueva Accion para Llamar la forma de captura de correo
[Venta.frm/Acciones.DM0138CapturaCorreo]
Nombre=DM0138CapturaCorreo
Boton=84
NombreDesplegar=Capturar Correo
EnBarraHerramientas=S
EnMenu=S
TipoAccion=Formas
ClaveAccion=DM0138CapturaCorreo
ActivoCondicion=(SQL(<T>Select COUNT(Usuario) From Usuario U With(Nolock) Inner Join TablaStD St With(NoLock) ON U.Acceso=St.Nombre and St.Tablast=<T>+Comillas(<T>EXCLUIRPERFILESDM0138<T>)+<T> Where U.Usuario=:tUsr<T>, Usuario) =0 ) y (MovTipoEn(<T>VTAS<T>, Venta:Venta.Mov, (VTAS.P, VTAS.F)))
Visible=S
Menu=&Otros
Antes=S
ConCondicion=S
EjecucionConError=S
EjecucionCondicion=ConDatos(Venta:Venta.Cliente)
EjecucionMensaje=<T>No Existe Cliente...<T>
;******** Se Modifico para que se asigne a una variable un dato especifico *****************************************
AntesExpresiones=Asigna(Info.Cliente, Venta:Venta.Cliente)<BR> ASIGNA(Mavi.DM0138Bandera,0)
;AntesExpresiones=Asigna(Info.Cliente,Venta:Venta.Cliente)

[Venta.frm/Acciones.ActualizaPrecio empleado.expresionEmpleado]
Nombre=expresionEmpleado
Boton=0
TipoAccion=expresion
Activo=S
Visible=S
Expresion=EjecutarSQL(<T>exec spMAVIDM0148ActualizarPreciosEmpleados :nCanal, :tCondicion, :tArt, :nSuc, :nId, :laplica<T>,Venta:Venta.EnviarA, Venta:Venta.Condicion, VentaD:VentaD.Articulo, Venta:Venta.Sucursal,Venta:Venta.Id,Venta:Venta.RedimePtos)
ConCondicion=S
EjecucionCondicion=SI<BR>     (Venta:Venta.Mov=<T>Solicitud Credito<T>) Y (Venta:Venta.Estatus=<T>SINAFECTAR<T>)<BR>ENTONCES<BR>    1=1<BR>SINO<BR>    1=0<BR>    ERROR(<T>No se puede realizar la actualización<T>)<BR>FIN

[Venta.frm/Acciones.ActualizaPrecio empleado]
Nombre=ActualizaPrecio empleado
Boton=0
NombreDesplegar=Actualiza precios Empleado
GuardarAntes=S
RefrescarDespues=S
Multiple=S
EnMenu=S
EspacioPrevio=S
ListaAccionesMultiples=expresionEmpleado<BR>Actualizar Vista
Activo=S
Visible=S

[Venta.frm/Acciones.ActualizaPrecio empleado.Actualizar Vista]
Nombre=Actualizar Vista
Boton=0
TipoAccion=expresion
Activo=S
ConCondicion=S
Visible=S
Expresion=ProcesarSQL(<T>spPropreActualizarPrecios :nid,:tEstatus<T>,Venta:Venta.ID,Venta:Venta.Estatus)<BR>ActualizarVista
EjecucionCondicion=SI<BR>    SQL(<T>Select count(p1.Precio) from proprelistadfinal p1<BR>    join Condicion c on c.PropreGrupo=p1.Condicion<BR>    join Sucursal s on S.Sucursal = p1.Sucursal<BR>    where p1.Canal=:nCanal and p1.Articulo=:tArt and c.Condicion=:tCondicion and p1.Sucursal=:nSuc<T>,<BR>    Venta:Venta.EnviarA, VentaD:VentaD.Articulo,Venta:Venta.Condicion,Venta:Venta.Sucursal)=1<BR>ENTONCES<BR>     1=1                                               <BR>SINO<BR>    SI<BR>       SQL(<T>Select count(p1.Precio) from proprelistadfinal p1<BR>        join Condicion c on c.PropreGrupo=p1.Condicion<BR>        join Sucursal s on S.Sucursal = p1.Sucursal AND Tipo=:tTipo<BR>        where  p1.Canal=:nCanal and p1.Articulo=:tArt and c.Condicion=:tCondicion<BR>        and p1.Sucursal in (Select MIN(Sucursal) From Sucursal where Tipo=:tTipoDos)<T>,<T>INSTITUCIONES<T>,Venta:Venta.EnviarA, VentaD:VentaD.Articulo,Venta:Venta.Condicion,<T>INSTITUCIONES<T>)=1<BR>    ENTONCES<BR>        1=1<BR>    SINO<BR>        1=0<BR>        Error(<T>No existe Precio definido<T>)<BR>    FIN<BR>FIN


;Jesus Del Toro Andrade
;Manda llamar SHM.exe
;25-07-2014
[Venta.frm/Acciones.SHM]
Nombre=SHM
Boton=30
NombreDesplegar=SHM
EnBarraHerramientas=S
EnMenu=S
Visible=S
Menu=&Archivo
TipoAccion=Expresion
Expresion=SI(Venta:Venta.Mov=<T>Analisis Credito<T>,Asigna(Info.MAVIMovId,Venta:Venta.OrigenID),Asigna(Info.MAVIMovId,Venta:Venta.MovID))<BR><BR>SI Venta:Venta.Mov en (<T>Solicitud Credito<T>,<T>Analisis Credito<T>)y (SQL(<T>SELECT COUNT(ID) FROM dbo.Venta WITH(NOLOCK) WHERE ID=:tId AND Estatus=:tE<T>,Venta:Venta.ID,<T>PENDIENTE<T>)=<T>1<T>)<BR> ENTONCES<BR>     SI SQL(<T>SELECT COUNT(Numero) FROM dbo.TablaNumD WHERE TablaNum=:tTab AND CAST(Numero AS INT)=:nSuc<T>,<T>SUCURSALES RDP<T>,Sucursal)=<T>1<T><BR>         Entonces<BR>           SI (SQL(<T>Select Cadena From VentasCanalMAVI Where ID=:nID<T>,Venta:Venta.EnviarA) <> <T>VENTA VALE<T>) o (SQL(<T>Select count(*) From VentaD with(nolock) where ID = <T> + Venta:Venta.ID +<T> and Articulo like <T> + Comillas(<T>%VALR%<T>)) > 0)<BR>             Enton<CONTINUA>
Expresion002=<CONTINUA>ces<BR>                 Ejecutar(<T>PlugIns\RutaTicket.exe <T>+<T>SHM<T>+<T> <T>+Info.MAVIMovId+<T> <T>+Usuario+<T> <T>+Venta:Venta.Cliente+<T> <T>+Sucursal+<T> <T>+EstacionTrabajo)<BR>              sino<BR>                 Ejecutar(<T>PlugIns\RutaTicket.exe <T>+<T>SHM3<T>+<T> <T>+Info.MAVIMovId+<T> <T>+Usuario+<T> <T>+Venta:Venta.Cliente+<T> <T>+Sucursal+<T> <T>+EstacionTrabajo)<BR>       fin<BR>          Sino<BR>             Si<BR>                (SQL(<T>Select Cadena From VentasCanalMAVI Where ID=:nID<T>,Venta:Venta.EnviarA) <> <T>VENTA VALE<T>) o (SQL(<T>Select count(*) From VentaD with(nolock) where ID = <T> + Venta:Venta.ID +<T> and Articulo like <T> + Comillas(<T>%VALR%<T>)) > 0)<BR>                  Entonces<BR>                      Ejecutar(<T>C:\AppsMavi\SHM\SHM.exe <T>+Usuario+<<CONTINUA>
Expresion003=<CONTINUA>T> <T>+Sucursal+<T> <T>+Info.MAVIMovId+<T> <T>+Venta:Venta.Cliente)<BR>               Sino<BR>                     Ejecutar(<T>C:\AppsMavi\SHM\SHM.exe <T>+<T>CLIENTEFINAL<T>+<T> <T>+ Usuario+<T> <T>+Info.MAVIMovID+<T> <T>+Sucursal)<BR><BR>             Fin<BR>        Fin<BR>   SINO<BR>   Verdadero<BR> FIN
ActivoCondicion=SQL(<T>SELECT COUNT(Numero) FROM dbo.TablaNumD WITH(NOLOCK)WHERE TablaNum=:tB AND Numero=:tN<T>,<T>SUCURSALES SHM<T>,Sucursal)<><T>0<T>

[Venta.frm/Acciones.SHMADJUNTAR]
Nombre=SHMADJUNTAR
Boton=78
NombreDesplegar=SHM ADJUNTAR
EnBarraHerramientas=S
EnMenu=S
TipoAccion=Expresion
Visible=S
ConCondicion=S
Expresion=Asigna(Info.MovIDD,Reemplaza(<T> <T>,<T>_<T>,Venta:Venta.Mov))<BR><BR>SI Venta:Venta.Mov en (<T>Solicitud Credito<T>,<T>Analisis Credito<T>,<T>Pedido<T>)<BR>ENTONCES<BR>    SI SQL(<T>SELECT COUNT(Numero) FROM dbo.TablaNumD WHERE TablaNum=:tTab AND CAST(Numero AS INT)=:nSuc<T>,<T>SUCURSALES RDP<T>,Sucursal)=<T>1<T><BR>    Entonces<BR>        Ejecutar(<T>PlugIns\RutaTicket.exe <T>+<T>SHM2<T>+<T> <T>+Venta:Venta.MovID+<T> <T>+Usuario+<T> <T>+Info.MovIDD+<T> <T>+Sucursal+<T> <T>+EstacionTrabajo)<BR>    Sino<BR>        Ejecutar(<T>C:\AppsMavi\SHM\SHM.exe ADJUNTAR <T>+Info.MovIDD+<T> <T>+Venta:Venta.MovID+<T> <T>+Usuario)<BR>    Fin<BR>SINO                   <BR>    Verdadero<BR>FIN
ActivoCondicion=SQL(<T>SELECT COUNT(Numero) FROM dbo.TablaNumD WITH(NOLOCK)WHERE TablaNum=:tB AND Numero=:tN<T>,<T>SUCURSALES SHM<T>,Sucursal)<><T>0<T> 
EjecucionCondicion=Venta:Venta.Estatus noen (EstatusSinAfectar)

[Venta.frm/Acciones.HOJAVERDE]
Nombre=HOJAVERDE
Boton=121
NombreDesplegar=SID HV
EnBarraHerramientas=S
EnMenu=S
TipoAccion=Expresion
Visible=S
ConCondicion=S
Expresion=Asigna(Info.MovIDD,Reemplaza(<T> <T>,<T>_<T>,Venta:Venta.Mov))<BR><BR>SI Venta:Venta.Mov en (<T>Solicitud Credito<T>,<T>Analisis Credito<T>,<T>Pedido<T>)<BR>ENTONCES<BR>        SI Izquierda( Usuario, 4 ) = <T>VENT<T><BR>        ENTONCES<BR>           Ejecutar(<T>PlugIns\SHM\SHM.exe CAPTURARHOJAVERDE <T>+Venta:Venta.Cliente+<T> <T>+Venta:Venta.MovID+<T> <T>+Venta:ImporteTotal)<BR>        FIN<BR><BR>         SI Izquierda( Usuario, 5 ) = <T>CREDI<T><BR>        ENTONCES<BR>           Ejecutar(<T>PlugIns\SHM\SHM.exe MOSTRARHOJAVERDE <T>+Venta:Venta.Cliente)<BR>        FIN<BR><BR>        Fin<BR><BR>SINO<BR>    Verdadero<BR>FIN
ActivoCondicion=SQL(<T>SELECT COUNT(Numero) FROM dbo.TablaNumD WITH(NOLOCK)WHERE TablaNum=:tB AND Numero=:tN<T>,<T>SUCURSALES SHM<T>,Sucursal)<><T>0<T>
EjecucionCondicion=Venta:Venta.Estatus noen (EstatusSinAfectar)
[Venta.frm/Acciones.ValidaSituac]
Nombre=ValidaSituac
Boton=35
NombreDesplegar=&Valida RFC, Nomina, Cve Presupuestal
EnBarraHerramientas=S
EnMenu=N
TipoAccion=Expresion
Visible=S
Expresion=Si<BR>  Mavi.DM0138ValidaCond = <T>Verdadero<T><BR>Entonces<BR>  Asigna( Info.ModuloVentasNombre, <T>Ventas - <T>+Venta:Venta.Mov+<T> <T>+Venta:Venta.MovID )<BR>  Forma.ActualizarForma <BR>Asigna( Info.ModuloVentasNombre, <T>Ventas<T> )<BR> Sino<BR>  Asigna( Info.Clave, Venta:Cte.Cliente )<BR> Asigna( Info.ClaveDeCanal, Venta:Venta.EnviarA )<BR>  Asigna( Info.ID, Venta:Venta.ID )<BR>  Forma(<T>DM0138ClienteAceptado<T>)<BR>Fin
ActivoCondicion=((Venta:Venta.Mov = <T>Analisis Credito<T>) y (SQL(<T>SELECT COUNT(ID) FROM CteEnviarA WHERE Categoria =:tCat AND ID =:tId AND Cliente =:tCt<T>, <T>INSTITUCIONES<T>, Venta:Venta.EnviarA, Venta:Venta.Cliente) > 0) y (Mavi.DM0138ValidaCond = <T>Falso<T>) y (Venta:Venta.Situacion <> <T>Aceptado<T>))

[Venta.frm/Acciones.CteExpressNew]
Nombre=CteExpressNew
Boton=127
NombreEnBoton=S
Menu=&Edición
EnBarraHerramientas=S
EnMenu=S
TipoAccion=Expresion
UsaTeclaRapida=S
TeclaRapida=Alt+F9
Activo=S
ConCondicion=S
EjecucionConError=S
Visible=S
Expresion=Asigna(Info.Tipo, <T>Cliente<T>)<BR>FormaModal(<T>SeleccionCategoriaMaviNew<T>)<BR>Asigna(Info.Nombre,Nulo)<BR><BR>Asigna(Info.Nombre,SQL(<T>SELECT Nombre FROM Cte WHERE Cliente=<T>&comillas(Info.cliente)))<BR><BR>Si Info.Nombre <> nulo<BR>Entonces<BR> Asigna(Venta:Venta.Cliente,Info.cliente)<BR> Asigna(Venta:Cte.Nombre,SQL(<T>SELECT Nombre FROM Cte WHERE Cliente=<T>&comillas(Info.cliente)))<BR> Asigna(Venta:Venta.EnviarA,Info.CanalVentaMAVI)<BR>Fin<BR><BR>Asigna(Info.Nombre,Nulo)
EjecucionCondicion=CONDATOS(Venta:Venta.Mov)
EjecucionMensaje=<T>Es necesario capturar un movimiento<T>

[Venta.frm/Acciones.Verificar]
VisibleCondicion=medio(usuario,1,5)<><T>VENTP<T>
Visible=N

[Venta.frm/Acciones.CopiarPendientes]
VisibleCondicion=medio(usuario,1,5)<><T>VENTP<T>
Visible=N

[Venta.frm/Acciones.Asistente Codigo Barras]
VisibleCondicion=medio(usuario,1,5)<><T>VENTP<T>
Visible=N

[Venta.frm/Acciones.Tareas]
VisibleCondicion=medio(usuario,1,5)<><T>VENTP<T>
Visible=N

[Venta.frm/Acciones.Catalogos]
VisibleCondicion=medio(usuario,1,5)<><T>VENTP<T>
Visible=N

[Venta.frm/Acciones.MatrizAutorizacion]
Nombre=MatrizAutorizacion
Boton=104
NombreDesplegar=&Matriz de Autorizacion
EnBarraHerramientas=S
EnMenu=S
TipoAccion=Expresion
Activo=S
Expresion=Asigna(Mavi.DM0296Nombre, SQL(<T>SELECT * FROM  DBO.FN_DM0296NombreUsuario(:tNom, :tOp)<T>, Venta:Cte.Cliente, 2) )<BR>Asigna(Mavi.DM0257Usuario, SQL(<T>SELECT * FROM  DBO.FN_DM0296NombreUsuario(:tNom, :tOp)<T>, Usuario, 1) )<BR>Asigna(Mavi.DM0296Nivel, SQL(<T>SELECT * FROM  DBO.FN_DM0296NombreUsuario(:tNom, :tOp)<T>, Usuario, 3) )<BR><BR>Ejecutar(<T>PlugIns\SegundaReferencia\SegundaReferencia.exe <T>+Venta:Cte.Cliente+<T> <T>+Mavi.DM0296Nombre+<T> <T>+Usuario+<T> <T>+Mavi.DM0257Usuario + <T> <T> + Mavi.DM0296Nivel)
VisibleCondicion=Medio( Usuario, 1, 5 ) = <T>CREDI<T>
